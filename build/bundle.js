var app=function(){"use strict";function e(){}function t(e,t){for(const n in t)e[n]=t[n];return e}function n(e){return e()}function r(){return Object.create(null)}function s(e){e.forEach(n)}function o(e){return"function"==typeof e}function l(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function i(t,...n){if(null==t)return e;const r=t.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}function a(e){let t;return i(e,(e=>t=e))(),t}function c(e,t,n){e.$$.on_destroy.push(i(t,n))}function u(e,t,n,r){if(e){const s=p(e,t,n,r);return e[0](s)}}function p(e,n,r,s){return e[1]&&s?t(r.ctx.slice(),e[1](s(n))):r.ctx}function d(e,t,n,r,s,o,l){const i=function(e,t,n,r){if(e[2]&&r){const s=e[2](r(n));if(void 0===t.dirty)return s;if("object"==typeof s){const e=[],n=Math.max(t.dirty.length,s.length);for(let r=0;r<n;r+=1)e[r]=t.dirty[r]|s[r];return e}return t.dirty|s}return t.dirty}(t,r,s,o);if(i){const s=p(t,n,r,l);e.p(s,i)}}function h(e){const t={};for(const n in e)"$"!==n[0]&&(t[n]=e[n]);return t}function f(e,t){const n={};t=new Set(t);for(const r in e)t.has(r)||"$"===r[0]||(n[r]=e[r]);return n}function g(t){return t&&o(t.destroy)?t.destroy:e}function $(e,t){e.appendChild(t)}function m(e,t,n){e.insertBefore(t,n||null)}function v(e){e.parentNode.removeChild(e)}function x(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function y(e){return document.createElement(e)}function w(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function b(e){return document.createTextNode(e)}function _(){return b(" ")}function k(){return b("")}function L(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function E(e){return function(t){return t.preventDefault(),e.call(this,t)}}function I(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function z(e,t){const n=Object.getOwnPropertyDescriptors(e.__proto__);for(const r in t)null==t[r]?e.removeAttribute(r):"style"===r?e.style.cssText=t[r]:"__value"===r?e.value=e[r]=t[r]:n[r]&&n[r].set?e[r]=t[r]:I(e,r,t[r])}function A(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function C(e,t,n,r){e.style.setProperty(t,n,r?"important":"")}function S(e,t,n){e.classList[n?"add":"remove"](t)}let M;function T(e){M=e}function P(){if(!M)throw new Error("Function called outside component initialization");return M}function R(e){P().$$.on_mount.push(e)}function O(e){P().$$.on_destroy.push(e)}function D(){const e=P();return(t,n)=>{const r=e.$$.callbacks[t];if(r){const s=function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(t,n);r.slice().forEach((t=>{t.call(e,s)}))}}}function B(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e(t)))}const N=[],j=[],F=[],H=[],q=Promise.resolve();let K=!1;function G(){K||(K=!0,q.then(X))}function J(){return G(),q}function U(e){F.push(e)}let W=!1;const Y=new Set;function X(){if(!W){W=!0;do{for(let e=0;e<N.length;e+=1){const t=N[e];T(t),V(t.$$)}for(T(null),N.length=0;j.length;)j.pop()();for(let e=0;e<F.length;e+=1){const t=F[e];Y.has(t)||(Y.add(t),t())}F.length=0}while(N.length);for(;H.length;)H.pop()();K=!1,W=!1,Y.clear()}}function V(e){if(null!==e.fragment){e.update(),s(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(U)}}const Z=new Set;let Q;function ee(){Q={r:0,c:[],p:Q}}function te(){Q.r||s(Q.c),Q=Q.p}function ne(e,t){e&&e.i&&(Z.delete(e),e.i(t))}function re(e,t,n,r){if(e&&e.o){if(Z.has(e))return;Z.add(e),Q.c.push((()=>{Z.delete(e),r&&(n&&e.d(1),r())})),e.o(t)}}const se="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function oe(e,t){re(e,1,1,(()=>{t.delete(e.key)}))}function le(e,t,n,r,s,o,l,i,a,c,u,p){let d=e.length,h=o.length,f=d;const g={};for(;f--;)g[e[f].key]=f;const $=[],m=new Map,v=new Map;for(f=h;f--;){const e=p(s,o,f),i=n(e);let a=l.get(i);a?r&&a.p(e,t):(a=c(i,e),a.c()),m.set(i,$[f]=a),i in g&&v.set(i,Math.abs(f-g[i]))}const x=new Set,y=new Set;function w(e){ne(e,1),e.m(i,u),l.set(e.key,e),u=e.first,h--}for(;d&&h;){const t=$[h-1],n=e[d-1],r=t.key,s=n.key;t===n?(u=t.first,d--,h--):m.has(s)?!l.has(r)||x.has(r)?w(t):y.has(s)?d--:v.get(r)>v.get(s)?(y.add(r),w(t)):(x.add(s),d--):(a(n,l),d--)}for(;d--;){const t=e[d];m.has(t.key)||a(t,l)}for(;h;)w($[h-1]);return $}function ie(e,t){const n={},r={},s={$$scope:1};let o=e.length;for(;o--;){const l=e[o],i=t[o];if(i){for(const e in l)e in i||(r[e]=1);for(const e in i)s[e]||(n[e]=i[e],s[e]=1);e[o]=i}else for(const e in l)s[e]=1}for(const e in r)e in n||(n[e]=void 0);return n}function ae(e){return"object"==typeof e&&null!==e?e:{}}function ce(e){e&&e.c()}function ue(e,t,r){const{fragment:l,on_mount:i,on_destroy:a,after_update:c}=e.$$;l&&l.m(t,r),U((()=>{const t=i.map(n).filter(o);a?a.push(...t):s(t),e.$$.on_mount=[]})),c.forEach(U)}function pe(e,t){const n=e.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function de(t,n,o,l,i,a,c=[-1]){const u=M;T(t);const p=n.props||{},d=t.$$={fragment:null,ctx:null,props:a,update:e,not_equal:i,bound:r(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:[]),callbacks:r(),dirty:c,skip_bound:!1};let h=!1;if(d.ctx=o?o(t,p,((e,n,...r)=>{const s=r.length?r[0]:n;return d.ctx&&i(d.ctx[e],d.ctx[e]=s)&&(!d.skip_bound&&d.bound[e]&&d.bound[e](s),h&&function(e,t){-1===e.$$.dirty[0]&&(N.push(e),G(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(t,e)),n})):[],d.update(),h=!0,s(d.before_update),d.fragment=!!l&&l(d.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);d.fragment&&d.fragment.l(e),e.forEach(v)}else d.fragment&&d.fragment.c();n.intro&&ne(t.$$.fragment),ue(t,n.target,n.anchor),X()}T(u)}class he{$destroy(){pe(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const fe=[];function ge(t,n=e){let r;const s=[];function o(e){if(l(t,e)&&(t=e,r)){const e=!fe.length;for(let e=0;e<s.length;e+=1){const n=s[e];n[1](),fe.push(n,t)}if(e){for(let e=0;e<fe.length;e+=2)fe[e][0](fe[e+1]);fe.length=0}}}return{set:o,update:function(e){o(e(t))},subscribe:function(l,i=e){const a=[l,i];return s.push(a),1===s.length&&(r=n(o)||e),l(t),()=>{const e=s.indexOf(a);-1!==e&&s.splice(e,1),0===s.length&&(r(),r=null)}}}}const $e=e=>{var t,n,r=e[0]/255,s=e[1]/255,o=e[2]/255,l=Math.max(r,s,o),i=Math.min(r,s,o),a=(l+i)/2;if(l==i)t=n=0;else{var c=l-i;switch(n=a>.5?c/(2-l-i):c/(l+i),l){case r:t=(s-o)/c+(s<o?6:0);break;case s:t=(o-r)/c+2;break;case o:t=(r-s)/c+4}t/=6}return new Array(360*t,100*n,100*a)},me=[{hex:"00",rgb:[124,124,124]},{hex:"01",rgb:[0,0,252]},{hex:"02",rgb:[0,0,188]},{hex:"03",rgb:[68,40,188]},{hex:"04",rgb:[148,0,132]},{hex:"05",rgb:[168,0,32]},{hex:"06",rgb:[168,16,0]},{hex:"07",rgb:[136,20,0]},{hex:"08",rgb:[80,48,0]},{hex:"09",rgb:[0,120,0]},{hex:"0A",rgb:[0,104,0]},{hex:"0B",rgb:[0,88,0]},{hex:"0C",rgb:[0,64,88]},{hex:"0D",rgb:[0,0,0]},{hex:"0E",rgb:[0,0,0]},{hex:"0F",rgb:[0,0,0]},{hex:"10",rgb:[188,188,188]},{hex:"11",rgb:[0,120,248]},{hex:"12",rgb:[0,88,248]},{hex:"13",rgb:[104,68,252]},{hex:"14",rgb:[216,0,204]},{hex:"15",rgb:[228,0,88]},{hex:"16",rgb:[248,56,0]},{hex:"17",rgb:[228,92,16]},{hex:"18",rgb:[172,124,0]},{hex:"19",rgb:[0,184,0]},{hex:"1A",rgb:[0,168,0]},{hex:"1B",rgb:[0,168,68]},{hex:"1C",rgb:[0,136,136]},{hex:"1D",rgb:[0,0,0]},{hex:"1E",rgb:[0,0,0]},{hex:"1F",rgb:[0,0,0]},{hex:"20",rgb:[248,248,248]},{hex:"21",rgb:[60,188,252]},{hex:"22",rgb:[104,136,252]},{hex:"23",rgb:[152,120,248]},{hex:"24",rgb:[248,120,248]},{hex:"25",rgb:[248,88,152]},{hex:"26",rgb:[248,120,88]},{hex:"27",rgb:[252,160,68]},{hex:"28",rgb:[248,184,0]},{hex:"29",rgb:[184,248,24]},{hex:"2A",rgb:[88,216,84]},{hex:"2B",rgb:[88,248,152]},{hex:"2C",rgb:[0,232,216]},{hex:"2D",rgb:[120,120,120]},{hex:"2E",rgb:[0,0,0]},{hex:"2F",rgb:[0,0,0]},{hex:"30",rgb:[252,252,252]},{hex:"31",rgb:[164,228,252]},{hex:"32",rgb:[184,184,248]},{hex:"33",rgb:[216,184,248]},{hex:"34",rgb:[248,184,248]},{hex:"35",rgb:[248,164,192]},{hex:"36",rgb:[240,208,176]},{hex:"37",rgb:[252,224,168]},{hex:"38",rgb:[248,216,120]},{hex:"39",rgb:[216,248,120]},{hex:"3A",rgb:[184,248,184]},{hex:"3B",rgb:[184,248,216]},{hex:"3C",rgb:[0,252,252]},{hex:"3D",rgb:[216,216,216]},{hex:"3E",rgb:[0,0,0]},{hex:"3F",rgb:[0,0,0]}],ve=me.map(((e,t)=>({rgb:$e(e.rgb),index:t}))).sort(((e,t)=>t.rgb[0]-e.rgb[0]||e.rgb[2]-t.rgb[2])).map((e=>me[e.index]));class xe{constructor(e,t){this.hex=e,this.rgb=t,Object.freeze(this)}}const ye=ve.map((e=>new xe(e.hex,e.rgb))),we=(()=>{const e=ge([]),{subscribe:t,update:n}=e;return{subscribe:t,push(e){if(e instanceof ErrorEvent){const t=new Date,r=`${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}:${String(t.getSeconds()).padStart(2,"0")}`;e.date=r,n((t=>(t.length>20&&(t=[]),t.push(e),t)))}}}})(),be=(()=>{const{subscribe:e,set:t,update:n}=ge({name:void 0,saved:null});return{subscribe:e,name:e=>{if("string"!=typeof e)throw new Error("Invalid project name.");n((t=>({...t,name:e})))},save:e=>{console.log("saving to location:",e)}}})();window.addEventListener("contextmenu",(e=>e.preventDefault())),window.addEventListener("error",(function(e){we.push(e)})),window.addEventListener("keydown",(e=>{}));class _e extends Number{constructor(e,t){if("number"!=typeof e||"string"!=typeof t)throw new Error("Invalid Enumerable arguments");super(e),this.key=t,this.value=e,Object.freeze(this)}}class ke extends Map{constructor(...e){super(),e.forEach(((e,t)=>{if(this.has(e))throw new Error(`enum key : '${e}' already exists`);if("string"!=typeof e)throw new Error(`Invalid key. Expecting string, got : [${typeof e}](${e})`);const n=new _e(t+1,e);this.set(e,n)})),Object.freeze(this)}}const Le=new class{constructor(...e){this.__actions=this.define(...e),this.__binds=new Map}define(...e){const t=new ke(...e);return this.__actions=t,t}action(e){if(!this.__actions.has(e))throw new Error(`Action is not defined for key '${e}'`);return this.__actions.get(e)}register(e,t){if("string"!=typeof e){if(!(e instanceof _e))throw new Error(`Invalid key value '${e}'. Expecting instance of 'Enum'`);if(this.__binds.has(e))throw new Error(`Action already defined : [${e.key}]`);if("function"!=typeof t)throw new Error("Invalid callback function");this.__binds.set(e,t)}else this.register(this.action(e),t)}exist(e){return this.__binds.has(e)}call(e,...t){if("string"!=typeof e){if(!(e instanceof _e))throw new Error(`Invalid key '${e}'. Expecting 'Enum'`);if(!this.__binds.has(e))throw new Error(`Action for '${e}' does not exist`);return new Promise(((n,r)=>{try{n(this.__binds.get(e).call(null,...t))}catch(e){r(e.message)}}))}this.call(this.action(e),...t)}execute(...e){return this.call(...e)}}("noop","application_log","window_close","window_minimize","window_maximize","window_toggle_fullscreen","external_link","palette_clear","palette_create","palette_remove","palette_clone_layer","palette_clone_active_layer","palette_make_layer_active","palette_swap_layers","palette_update_layer_label","palette_focus_rename_active_layer","palette_export","palette_import","palette_active_color","spritesheet_create","spritesheet_remove","spritesheet_clone_layer","spritesheet_clone_active_layer","spritesheet_update_layer_label","spritesheet_make_layer_active","spritesheet_swap_layers","spritesheet_focus_rename_active_layer","spritesheet_zoom","spritesheet_zoom_in","spritesheet_zoom_out","spritesheet_zoom_reset","spritesheet_set_active_tool","spritesheet_import","spritesheet_export","spritesheet_import_chr","spritesheet_export_chr","spritesheet_export_png","toggle_theme","light_theme","dark_theme");var Ee="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var Ie,ze=(function(e,t){!function(){function t(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function n(e,t,n){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){i(r.response,t,n)},r.onerror=function(){console.error("could not download file")},r.send()}function r(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function s(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var o="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof Ee&&Ee.global===Ee?Ee:void 0,l=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),i=o.saveAs||("object"!=typeof window||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(e,t,l){var i=o.URL||o.webkitURL,a=document.createElement("a");t=t||e.name||"download",a.download=t,a.rel="noopener","string"==typeof e?(a.href=e,a.origin===location.origin?s(a):r(a.href)?n(e,t,l):s(a,a.target="_blank")):(a.href=i.createObjectURL(e),setTimeout((function(){i.revokeObjectURL(a.href)}),4e4),setTimeout((function(){s(a)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,o,l){if(o=o||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,l),o);else if(r(e))n(e,o,l);else{var i=document.createElement("a");i.href=e,i.target="_blank",setTimeout((function(){s(i)}))}}:function(e,t,r,s){if((s=s||open("","_blank"))&&(s.document.title=s.document.body.innerText="downloading..."),"string"==typeof e)return n(e,t,r);var i="application/octet-stream"===e.type,a=/constructor/i.test(o.HTMLElement)||o.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||i&&a||l)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=e:location=e,s=null},u.readAsDataURL(e)}else{var p=o.URL||o.webkitURL,d=p.createObjectURL(e);s?s.location=d:location.href=d,s=null,setTimeout((function(){p.revokeObjectURL(d)}),4e4)}});o.saveAs=i.saveAs=i,e.exports=i}()}(Ie={exports:{}},Ie.exports),Ie.exports);const Ae=(e,t)=>{const n=new Date;return`${`${String(n.getFullYear())}_${String(n.getMonth()).padStart(2,"0")}_${String(n.getDay()).padStart(2,"0")}`}_${e}.${t}`},Ce=(e=[],t=(e=>e),n={readAs:"text"})=>{if(!Array.isArray(e))throw new Error("Invalid 'fileDialog' accept. Expecting array of file extentions");if("function"!=typeof t)throw new Error("Invalid 'fileDialog' callback function");const r=document.createElement("input");r.type="file",r.accept=e.map((e=>e.startsWith(".")?e:"."+e)).join(","),r.addEventListener("change",(e=>{const r=e.target.files[0],s=new FileReader;switch(n.readAs){case"binary":s.readAsBinaryString(r);break;case"arraybuffer":s.readAsArrayBuffer(r);break;case"text":default:s.readAsText(r,n.encoding||"utf-8")}s.addEventListener("load",(e=>{t.call(null,e.target.result)}))})),r.click()},Se=(e,t,n={})=>{const r=new Blob([t],{type:n.type||"application/json;charset=utf-8"});ze.saveAs(r,e)},Me={startPage:"/graphics/spritesheets"};var Te={project:{save:{mimetype:"nesbit/project",extension:"nesbitproject",version:2}},palettes:{save:{mimetype:"nesbit/palette",extension:"nesbitpalette",version:2},export:{mimetype:"text/plain",extension:"",version:1}},spritesheets:{save:{mimetype:"nesbit/spritesheet",extension:"nesbitspritesheet",version:1},export:{mimetype:"text/plain",extension:"",version:1}},settings:{save:{mimetype:"nesbit/settings",extension:"nesbitsettings",version:2}}};const Pe=e=>JSON.parse(JSON.stringify(ye.find((t=>t.hex==e)))),Re=Pe("0F");let Oe=1;class De{constructor(e,t){if(this.label=e||"",this.colors=[],this.uuid=++Oe,Array.isArray(t)&&4==t.length)for(const e of t)this.addColor(e.hex);else this.colors=[...Array(4).fill("").map((e=>({...Re})))]}addColor(e){if(!(this.colors.length<4))throw new Error("Max 4 colors per 'ColorPaletteGroup'");const t=Pe(e);t&&this.colors.push({...t})}}const Be=(()=>{const e=ge({activeLayer:void 0,layers:[],selectedColor:0}),{subscribe:t,set:n,update:r}=e,s={subscribe:t,getActiveLayer:()=>a(e).activeLayer,setSelectedColor(e){if(!Number.isInteger(e))throw new Error("Invalid 'setSelectedColor' value. Expecting 'Integer'");if(!(e>=0&&e<=4))throw new Error("Invalid 'setSelectedColor' number range. Expecting number between '0-4'");r((t=>(t.selectedColor=e,t)))},create({label:e,colors:t}={}){r((n=>{e=e||"palette_"+(n.layers.length+1);const r=new De(e,t);return n.layers.push(r),n.activeLayer||s.makeActive(r),n}))},clear(){n({activeLayer:void 0,layers:[],selectedColor:0})},layerIndexFromSource:e=>a(Be).layers.indexOf(e),getActiveColorIndex:()=>a(Be).selectedColor,getActiveColor(e){const t=a(Be);return t.activeLayer.colors[e>=0&&e<=4?e:t.selectedColor]},makeActive(t){t!=a(e).activeLayer&&r((e=>{const n=e.layers.indexOf(t);return e.activeLayer=e.layers[n],e}))},remove(e){r((t=>{const n=t.layers.indexOf(e);return t.layers[n]==t.activeLayer&&(t.layers[n+1]?s.makeActive(t.layers[n+1]):t.layers[n-1]?s.makeActive(t.layers[n-1]):t.activeLayer=void 0),t.layers.splice(n,1),t}))},swapLayers(e,t){r((n=>{const r=[...n.layers];return[r[e],r[t]]=[r[t],r[e]],n.layers=[...r],n}))},clone(t){if(!t)return;const n=a(e),o=n.layers.indexOf(t);n.layers[o]==t&&r((e=>{let n=t.label+" copy";const r=new De(n);for(const e in t.colors)r.colors[e]={...Pe(t.colors[e].hex)};return e.layers.push(r),s.makeActive(r),e}))},updateHeading(e,t){r((n=>{const r=n.layers.indexOf(e);return n.layers[r].label=t,n}))},swapColors(e){r((t=>{const n=t.layers[e.layerIndex].colors,r=t.layers[e.to.layerIndex].colors;let o=n[e.colorIndex],l=r[e.to.colorIndex];return n[e.colorIndex]={...Pe(l.hex)},r[e.to.colorIndex]={...Pe(o.hex)},e.layerIndex!=e.to.layerIndex&&s.makeActive(t.layers[e.to.layerIndex]),t}))},replaceColor(e){r((t=>{const n=t.layers[e.layerIndex],r=Pe(e.hex);return n.colors[e.colorIndex]={hex:r.hex,rgb:r.rgb},s.makeActive(t.layers[e.layerIndex]),t}))},export(e){let t={version:Te.palettes.save.version,data:[...a(Be).layers]};return e&&(t=JSON.stringify(t)),t},import(e){const t=JSON.parse(e);if(t.version==Te.palettes.save.version)for(const e of t.data)s.create({...e})}};return s})();Be.import('{"version":2,"data":[{"label":"fire","colors":[{"hex":"0F","rgb":[0,0,0]},{"hex":"27","rgb":[252,160,68]},{"hex":"06","rgb":[168,16,0]},{"hex":"07","rgb":[136,20,0]}]},{"label":"purple","colors":[{"hex":"0F","rgb":[0,0,0]},{"hex":"16","rgb":[248,56,0]},{"hex":"13","rgb":[104,68,252]},{"hex":"03","rgb":[68,40,188]}]},{"label":"teal","colors":[{"hex":"0F","rgb":[0,0,0]},{"hex":"31","rgb":[164,228,252]},{"hex":"1C","rgb":[0,136,136]},{"hex":"0C","rgb":[0,64,88]}]},{"label":"blue steele","colors":[{"hex":"0F","rgb":[0,0,0]},{"hex":"12","rgb":[0,88,248]},{"hex":"01","rgb":[0,0,252]},{"hex":"02","rgb":[0,0,188]}]}]}');const Ne=(e,t)=>{const n=ge(e);let r={...n,get:e=>a(n)};return t&&(r={...r,...t.call(null,{value:e,store:n,get:r.get}||{...r})}),Object.freeze(r)},je=(e,t)=>{const n=e?e.length:0;if(n<1)return[];const r=new Array(Math.ceil(n/t));let s=0,o=0;for(;s<n;)r[o++]=e.slice(s,s+=t);return r},Fe=e=>(e=Number(e>>>0).toString(2),"00000000".substring(e.length)+e);function He(e,t){let n=Number(e);return Number(t)&&(n=2),Number(e)+Number(t)>1&&(n=3),n}const qe=e=>JSON.parse(JSON.stringify(ye.find((t=>t.hex==e)))),Ke=qe("0F");let Ge=1;class Je{constructor(e,t){if(this.label=e||"",this.colors=[],this.uuid=++Ge,Array.isArray(t)&&4==t.length)for(const e of t)this.addColor(e.hex);else this.colors=[...Array(4).fill("").map((e=>({...Ke})))]}addColor(e){if(!(this.colors.length<4))throw new Error("Max 4 colors per 'ColorPaletteGroup'");const t=qe(e);t&&this.colors.push({...t})}}const Ue=Ne(0,(({store:e,get:t})=>({setActiveColorIndex(t){if(!Number.isInteger(t))throw new Error("Invalid 'setActiveColorIndex' value. Expecting 'Integer'");if(!(t>=0&&t<=4))throw new Error("Invalid 'setActiveColorIndex' number range. Expecting number between '0-4'");e.set(t)},getActiveColorValue(e){const n=Ye.stores.activeLayer.get();if(!n)throw new Error("No 'activeLayer' selected");return Number.isInteger(e)||(e=t()),n.colors[e]}}))),We=Ne([],(({store:e,value:t,get:n,update:r})=>({clear(){Ye.stores.activeLayer.set(void 0),e.set([])},swapLayers(t,n){e.update((e=>{const r=[...e];return[r[t],r[n]]=[r[n],r[t]],e=[...r],Ye.stores.activeLayer.set(e[n]),e}))},replaceColor(t){e.update((e=>{const n=e[t.layerIndex],r=qe(t.hex);return n.colors[t.colorIndex]={hex:r.hex,rgb:r.rgb},Ye.makeLayerActive(e[t.layerIndex]),e}))},swapColors(t){e.update((e=>{Ye.update();const n=e[t.layerIndex].colors,r=e[t.to.layerIndex].colors;let s=n[t.colorIndex],o=r[t.to.colorIndex];return n[t.colorIndex]={...qe(o.hex)},r[t.to.colorIndex]={...qe(s.hex)},Ye.makeLayerActive(e[t.to.layerIndex]),e}))}}))),Ye=Ne({selectedColor:Ue,activeLayer:Ne(),layers:We},(({store:e,value:t,get:n})=>({lastChanged:Ne(),stores:t,update(){Ye.lastChanged.set(Math.random()+Date.now())},createLayer({label:e,colors:n}={},r=!1){t.layers.update((t=>{e=e||"palette_"+(t.length+1);const s=new Je(e,n);return t=r?[...t,s]:[s,...t],Ye.makeLayerActive(s),t}))},removeLayer(e){t.layers.update((n=>{const r=n.indexOf(e);return e==t.activeLayer.get()&&(n[r+1]?Ye.makeLayerActive(n[r+1]):n[r-1]?Ye.makeLayerActive(n[r-1]):t.activeLayer.set(void 0)),n.splice(r,1),n}))},cloneLayer(e){t.layers.update((t=>{let{label:n,colors:r}=e;n+=" copy";const s=new Je(n,r);return t=[s,...t],Ye.makeLayerActive(s),t}))},cloneActiveLayer(){const e=t.activeLayer.get();e?Ye.cloneLayer(e):Ye.createLayer()},makeLayerActive(e){if(!(e instanceof Je))throw new Error("Invalid 'ColorPaletteGroupInstance' while setting 'activeLayer'");t.activeLayer.set(e)},layerIndexFromSource(e){if(!(e instanceof Je))throw new Error("Invalid 'ColorPaletteGroupInstance' in 'layerIndexFromSource'");return t.layers.get().indexOf(e)},updateLayerLabel(e,n){t.layers.update((t=>(e.label=n,Ye.makeLayerActive(e),t)))},import(e){const t=Ye.stores.layers.get().length<=0,n=JSON.parse(e);if(n.version==Te.palettes.save.version)for(const e of n.data)Ye.createLayer({...e},!0);t&&Ye.stores.layers.length&&Ye.makeLayerActive(Ye.stores.layers.get()[0])},export(e){const t=Ye.stores.layers.get();let n={version:Te.palettes.save.version,data:[...t]};return e&&(n=JSON.stringify(n)),n}})));Ye.import('{"version":2,"data":[{"label":"fire","colors":[{"hex":"0F","rgb":[0,0,0]},{"hex":"27","rgb":[252,160,68]},{"hex":"06","rgb":[168,16,0]},{"hex":"07","rgb":[136,20,0]}]},{"label":"purple","colors":[{"hex":"0F","rgb":[0,0,0]},{"hex":"16","rgb":[248,56,0]},{"hex":"13","rgb":[104,68,252]},{"hex":"03","rgb":[68,40,188]}]},{"label":"teal","colors":[{"hex":"0F","rgb":[0,0,0]},{"hex":"31","rgb":[164,228,252]},{"hex":"1C","rgb":[0,136,136]},{"hex":"0C","rgb":[0,64,88]}]},{"label":"blue steele","colors":[{"hex":"0F","rgb":[0,0,0]},{"hex":"12","rgb":[0,88,248]},{"hex":"01","rgb":[0,0,252]},{"hex":"02","rgb":[0,0,188]}]}]}');class Xe{constructor({label:e,width:t,height:n,data:r}={}){this._isInitialized=!1,this.uuid=Math.random()+Date.now(),this.width=t||128,this.height=n||128,this.label=e||"",this.element=document.createElement("canvas"),this.element.width=this.width,this.element.height=this.height,this.context=this.element.getContext("2d"),this.data=r,this.data?this._isInitialized||this.drawFromSource(Ye.stores.activeLayer.get()):this.data=new Array(16).fill().map((e=>new Array(16).fill().map((e=>new Array(8).fill().map((e=>new Array(8).fill().map((e=>0))))))))}async toDataURL(e="image/png",t){return await fetch(this.element.toDataURL(e,t)).then((e=>e.blob()))}colorIndexAtPosition(e,t){const n=this.data,r=Math.floor(e/8),s=e%8,o=t%8;return n[Math.floor(t/8)][r][o][s]}setColorIndexAtPosition(e,t,n){const r=this.data,s=Math.floor(e/8),o=e%8,l=t%8;r[Math.floor(t/8)][s][l][o]=n}drawFromSource(e){e&&(this._isInitialized||(this._isInitialized=!0),this.data.map(((t,n)=>{t.map(((t,r)=>{this.context.save(),this.context.translate(8*r,8*n),t.map(((t,n)=>{this.context.save(),this.context.translate(0,n),t.map(((t,n)=>{this.context.save(),this.context.translate(n,0);let r=e.colors[t];r&&(this.context.fillStyle=`rgb(${r.rgb})`,this.context.fillRect(0,0,1,1),this.context.restore())})),this.context.restore()})),this.context.restore()}))})))}clear(){this.context.clearRect(0,0,this.element.width,this.element.height)}}const Ve=Ne([],(({store:e,value:t,get:n})=>({swapLayers(t,n){e.update((e=>{const r=[...e];return[r[t],r[n]]=[r[n],r[t]],e=[...r],Qe.stores.activeLayer.set(e[t]),e}))}}))),Ze=Ne(void 0),Qe=Ne({activeLayer:Ze,layers:Ve},(({store:e,value:t,get:n})=>({data:{width:128,height:128},stores:t,createLayer({label:e,data:t}={}){Qe.stores.layers.update((n=>{e=e||"spritesheet_"+(n.length+1);const r=new Xe({label:e,data:t}),s=[r,...n];return Qe.makeLayerActive(r),s}))},removeLayer(e){Qe.stores.layers.update((t=>{let n=[...t];const r=n.indexOf(e);return e==Qe.stores.activeLayer.get()&&(n[r+1]?Qe.makeLayerActive(n[r+1]):n[r-1]?Qe.makeLayerActive(n[r-1]):Qe.stores.activeLayer.set(void 0)),n=n.filter((t=>t!=e)),n}))},cloneLayer(e){Qe.stores.layers.update((t=>{let{width:n,height:r,label:s,data:o}=e;Array.isArray(o)&&(o=JSON.parse(JSON.stringify(o))),s+=" copy";const l=new Xe({width:n,height:r,label:s,data:o});return t=[l,...t],Qe.makeLayerActive(l),t}))},cloneActiveLayer(){const e=Qe.stores.activeLayer.get();e?Qe.cloneLayer(e):Qe.createLayer()},makeLayerActive(e){if(!(e instanceof Xe))throw new Error("Invalid 'CanvasLayerInstance' while setting 'activeLayer'");Qe.stores.activeLayer.set(e)},updateLayerLabel(e,t){Qe.stores.layers.update((n=>(e.label=t,n)))},import(e){const t=JSON.parse(e);if(t.version==Te.spritesheets.save.version)for(const e of t.data)Qe.createLayer({...e})},export(e){let t={version:Te.spritesheets.save.version,data:[...Qe.stores.layers.get()]};return e&&(t=JSON.stringify(t)),t},importCHR(e){(e=>{const t=je(new Uint8Array(e),16);let n=[];for(let e of t){let t,r,s=[];for(let n=8;n<16;n++){t=Fe(e[n-8]),r=Fe(e[n]);const o=[];for(let e=0;e<8;e++){const n=He(t[e],r[e]);o.push(n)}s.push(o)}n.push(s)}return n=je(n,16),je(n,16)})(e).forEach((e=>Qe.createLayer({data:e})))},exportCHR(){const e=Qe.stores.activeLayer.get();if(!e||!e.data)throw new Error("Unable to export CHR. No 'activeLayer'");const t=(e=>{const t=[0,85,170,255],n=new ArrayBuffer(4096),r=new Uint8Array(n);let s="";for(let n of e)for(let e of n){let n="",r="";for(let s of e)for(let e of s){const s=t[e];n+=1&s,r+=s>>1&1}s+=n+r}return s.match(/.{8}/g).map(((e,t)=>r[t]=parseInt(e,2))),r})(e.data);return{label:e.label,data:t}},exportAsImage(e,t="image/png",n=1){const r=Qe.stores.activeLayer.get();if(!(r instanceof Xe))throw new Error("Unable to export Image. No 'activeLayer'");return{label:r.label,image:r.element.toBlob((s=>{e.call(null,{blob:s,label:r.label,options:{mimetype:t,quality:n}})}),t,n),options:{type:t}}}})));Qe.createLayer();const et=new ke("pointer","pen","paintbucket","eyedropper","colorswap","transform","marquee","zoom","preview","tileswap","preview_region","tilecolor");class tt{constructor(e){this.icon="",this.offset={x:0,y:0},this.size={width:11,height:11},this.scale={x:1,y:1},Object.assign(this,e)}}class nt{constructor(e){this.visible_in_toolbar=!0,this.pixelIndicator=!1,this.singleAction=!1}get optionsPanelComponent(){}onMount(){}onDestroy(){}primary(){}secondary(){}move(){}mouseup(){}reset(){}}class rt{constructor(){this.canvas=document.createElement("canvas"),this.canvas.width=128,this.canvas.height=128,this.context=this.canvas.getContext("2d")}render(){console.log("Render not implemented")}}const st=Object.freeze({primary:1,secondary:2,move:3,mouseup:4}),ot=new class extends rt{constructor(...e){super(...e),this.width=128,this.height=128,this.size=8,this.o1=.05,this.o2=.005}render(){this.context.clearRect(0,0,this.width,this.height),this.context.globalAlpha=1;for(let e=0;e<=this.width/this.size;e++)for(let t=0;t<=this.height/this.size;t++)this.context.save(),this.context.translate(e*this.size,t*this.size),(e+t)%2==0?(this.context.globalAlpha=this.o1,this.context.fillStyle="white"):(this.context.globalAlpha=this.o2,this.context.fillStyle="black"),this.context.fillRect(0,0,this.size,this.size),this.context.restore()}},lt=new class extends rt{constructor(...e){super(...e),this.width=128,this.height=128,this.size=1,this.x,this.y}render(){this.x&&this.y&&(this.context.clearRect(0,0,this.width,this.height),this.context.globalAlpha=.4,this.context.fillStyle="white",this.context.fillRect(this.x,this.y,this.size,this.size))}},it=[ot,lt];class at{defineCanvas(e){this.canvas=e,this.context=this.canvas.getContext("2d"),this.canvas.addEventListener("mousedown",this.eventHandler.mousedown)}constructor({canvas:e,context:t,width:n,height:r}){this.activeLayer=void 0,this.activePaletteLayer=void 0,this.lastChanged=void 0,this.canvas,this.context,this.width=n,this.height=r;this.animationLoop=((e,t=null)=>{if("function"!=typeof e)throw new Error("Invalid callback function.");let n,r=!1,s=0,o=performance.now();const l=e=>cancelAnimationFrame(n),i=e=>r=!0,a=e=>r=!1,c=u=>{if(n=requestAnimationFrame(c),r)return;const p=u-o,d=performance.now();(!t||d-o>1e3/t)&&(e.call(null,{delta:p/1e3,frame:++s,cancel:l,time:u,pause:i,play:a}),o=u)};return n=requestAnimationFrame(c),{unsubscribe:l,pause:i,play:a,toggle:e=>r=!r}})(this.render.bind(this),0),this.events={},this.eventHandler={};const s=(e,t)=>{switch(t.mouseIsDown=l,e){case st.primary:o("primary",t);break;case st.secondary:o("secondary",t);break;case st.move:o("move",t);break;case st.mouseup:o("mouseup",t);break;default:console.log("hmm...")}};const o=(e,t)=>{this.events[e]&&(t.realMousePosition=function(e,t){if(!e)return{x:0,y:0};const n=e.getBoundingClientRect(),r=e.width/n.width,s=e.height/n.height;return{x:Math.floor((t.clientX-n.left)*r),y:Math.floor((t.clientY-n.top)*s)}}(this.canvas,t),this.events[e].call(null,t))};let l=!1;this.eventHandler.mousemove=e=>{s(st.move,e)},this.eventHandler.mouseup=e=>{l=!1,s(st.mouseup,e)},this.eventHandler.mousedown=e=>{let t;if(l=!0,1==e.which)t=st.primary;else{if(3!=e.which)return;t=st.secondary}s(t,e)},document.addEventListener("mousemove",this.eventHandler.mousemove),document.addEventListener("mouseup",this.eventHandler.mouseup)}on(e,t){if("string"!=typeof e&&"function"!=typeof t)throw new Error("Invalid eventlistener");if(this.events[e])throw new Error(`Event already exists : ${e}`);this.events[e]=t}render({cancel:e,delta:t,frame:n,time:r}){if(!this.canvas)return;this.context.clearRect(0,0,128,128);const s=Qe.stores.activeLayer.get(),o=Ye.stores.activeLayer.get();s&&o&&(this.lastChanged==Ye.lastChanged.get()&&this.activeLayer==s&&this.activePaletteLayer==o||(this.activeLayer=s,this.activePaletteLayer=o,s.drawFromSource(o),this.lastChanged=Ye.lastChanged.get()),this.context.drawImage(s.element,0,0),it.forEach((e=>{e.render(),this.context.drawImage(e.canvas,0,0)})))}destroy(){this.animationLoop.unsubscribe(),this.canvas&&this.canvas.removeEventListener("mousedown",this.eventHandler.mousedown),document.removeEventListener("mousemove",this.eventHandler.mousemove),document.removeEventListener("mouseup",this.eventHandler.mouseup)}}const ct={pointer:new class extends nt{constructor(){super(),this.name="pointer",this.enum=et.get("pointer"),this.weight=100,this.icon="M4 0l16 12.279-6.78 1.138 4.256 8.676-3.902 1.907-4.281-8.758-5.293 4.581z",this.cursor=new tt({})}primary({x:e,y:t,context:n}){}secondary({x:e,y:t,context:n}){}move({x:e,y:t,context:n}){}},pen:new class extends nt{constructor(){super(),this.pixelIndicator=!0,this.name="pen",this.enum=et.get("pen"),this.weight=90,this.icon="M19.769 9.923l-12.642 12.639-7.127 1.438 1.438-7.128 12.641-12.64 5.69 5.691zm1.414-1.414l2.817-2.82-5.691-5.689-2.816 2.817 5.69 5.692z",this.cursor=new tt({icon:"M19.769 9.923l-12.642 12.639-7.127 1.438 1.438-7.128 12.641-12.64 5.69 5.691zm1.414-1.414l2.817-2.82-5.691-5.689-2.816 2.817 5.69 5.692z",size:{width:46,height:46},offset:{x:0,y:11}}),this.properties={size:1,drawStack:[],lastDraw:void 0,start:void 0},this.modifiedPixels=[]}get optionsPanelComponent(){return PenOptions}paint(e){const t=Ye.stores.selectedColor.getActiveColorValue(e.colorIndex),{rgb:n,hex:r}=t;if(!t)return;const s=Qe.stores.activeLayer.get()?.context;s?(this.properties.drawStack.map((t=>{const{x:r,y:o}=t.realMousePosition;s.save(),s.translate(r,o),s.fillStyle=`rgb(${n.join(",")})`,s.fillRect(0,0,this.properties.size,this.properties.size),this.modifiedPixels.push({x:r,y:o,colorIndex:Number.isInteger(e.colorIndex)?e.colorIndex:Ye.stores.selectedColor.get()}),s.restore()})),this.properties.lastDraw=this.properties.drawStack.pop(),this.properties.drawStack=[]):console.log("Error loading context")}primary(e){e.shiftKey?this.drawLineFromPoint(e,{...e.realMousePosition}):this.properties.drawStack.push(e),this.paint.call(this,e)}secondary(e){e={...e,colorIndex:0},this.properties.drawStack.push(e),this.paint.call(this,e)}drawLineFromPoint(e,t){if(!this.properties.start)return;let{x:n,y:r}=this.properties.start;if(Math.abs(t.x-n)>Math.abs(t.y-r))for(;n!=t.x;)n<t.x&&n++,n>t.x&&n--,this.properties.drawStack.push({...e,realMousePosition:{x:n,y:r}});else for(;r!=t.y;)r<t.y&&r++,r>t.y&&r--,this.properties.drawStack.push({...e,realMousePosition:{x:n,y:r}})}move(e){if(lt.x=e.realMousePosition.x,lt.y=e.realMousePosition.y,e.shiftKey||!e.mouseIsDown)return;const t=e=>{if(this.properties.lastDraw){let{x:t,y:n}={...this.properties.lastDraw.realMousePosition};for(;t!=e.realMousePosition.x||n!=e.realMousePosition.y;)t<e.realMousePosition.x&&t++,t>e.realMousePosition.x&&t--,n<e.realMousePosition.y&&n++,n>e.realMousePosition.y&&n--,this.properties.drawStack.push({...e,realMousePosition:{x:t,y:n}})}else this.properties.drawStack.push(e)};1==e.which?(t(e),this.primary.call(this,e)):3==e.which&&(t(e),this.secondary.call(this,e))}mouseup(){const e=Qe.stores.activeLayer.get()?.data;if(!e)return;for(const t of this.modifiedPixels){let{x:n,y:r,colorIndex:s}=t;const o={x:Math.floor(n/8),y:Math.floor(r/8)},l={x:n%8,y:r%8};e[o.y]&&e[o.y][o.x]&&e[o.y][o.x][l.y]&&Number.isInteger(e[o.y][o.x][l.y][l.x])&&(e[o.y][o.x][l.y][l.x]=s)}const t=this.modifiedPixels[this.modifiedPixels.length-1];t&&(this.properties.start={...t}),this.modifiedPixels=[]}},eyedropper:new class extends nt{constructor(){super(),this.singleAction=!0,this.name="eyedropper",this.enum=et.get("eyedropper"),this.weight=70,this.icon="M12.142 13.178l1.506 1.318-6.83 7.6c-1.31 1.464-2.22.315-3.953 1.647-.232.178-.483.257-.724.257-.601 0-1.141-.49-1.141-1.151 0-.218.062-.455.196-.698.978-1.791-.129-2.629 1.148-4.052l6.787-7.555 1.505 1.317-3.727 4.139h2.691l2.542-2.822zm5.764-13.178c-2.434 0-4.871 1.707-4.797 5.831.021 1.167-.356 1.698-.884 1.698-.298 0-.597-.169-.877-.386-.407-.315-.99-.26-1.331.129-.374.426-.329 1.076.096 1.448l5.253 4.598c.423.371 1.067.328 1.438-.096.343-.392.32-.979-.049-1.345-.277-.275-.501-.581-.501-.913 0-.479.486-.876 1.572-1.002 3.69-.428 5.174-2.656 5.174-4.88 0-2.799-2.149-5.082-5.094-5.082z",this.cursor=new tt({icon:"M12.142 13.178l1.506 1.318-6.83 7.6c-1.31 1.464-2.22.315-3.953 1.647-.232.178-.483.257-.724.257-.601 0-1.141-.49-1.141-1.151 0-.218.062-.455.196-.698.978-1.791-.129-2.629 1.148-4.052l6.787-7.555 1.505 1.317-3.727 4.139h2.691l2.542-2.822zm5.764-13.178c-2.434 0-4.871 1.707-4.797 5.831.021 1.167-.356 1.698-.884 1.698-.298 0-.597-.169-.877-.386-.407-.315-.99-.26-1.331.129-.374.426-.329 1.076.096 1.448l5.253 4.598c.423.371 1.067.328 1.438-.096.343-.392.32-.979-.049-1.345-.277-.275-.501-.581-.501-.913 0-.479.486-.876 1.572-1.002 3.69-.428 5.174-2.656 5.174-4.88 0-2.799-2.149-5.082-5.094-5.082z",size:{width:46,height:46},offset:{x:0,y:10}})}primary(e){const{x:t,y:n}=e.realMousePosition,r=Qe.stores.activeLayer.get().colorIndexAtPosition(t,n);Number.isInteger(r)&&Ye.stores.selectedColor.set(r)}secondary(e){}move(e){lt.x=e.realMousePosition.x,lt.y=e.realMousePosition.y}},paintbucket:new class extends nt{constructor(){super(),this.pixelIndicator=!0,this.singleAction=!0,this.name="paintbucket",this.enum=et.get("paintbucket"),this.weight=80,this.icon="M24 19.007c0-3.167-1.409-6.771-2.835-9.301l-.006-.01-.014-.026c-.732-1.392-1.914-3.052-3.619-4.757-2.976-2.976-5.476-3.912-6.785-3.913-.413 0-.708.094-.859.245l-.654.654c-1.898-.236-3.42.105-4.294.982-.876.875-1.164 2.159-.792 3.524.242.893.807 1.891 1.752 2.836.867.867 2.062 1.684 3.615 2.327.488-.839 1.654-1.019 2.359-.315.586.586.584 1.533-.002 2.119s-1.533.589-2.121 0c-.229-.229-.366-.515-.416-.812-1.646-.657-3.066-1.534-4.144-2.612-.728-.728-1.289-1.528-1.664-2.349l-2.835 2.832c-.445.447-.685 1.064-.686 1.82.001 1.635 1.122 3.915 3.714 6.506 2.764 2.764 5.58 4.243 7.431 4.243.649 0 1.181-.195 1.548-.562l8.086-8.079c.911.875-.777 3.541-.777 4.65 0 1.104.896 1.999 2 1.998 1.104 0 1.998-.895 1.998-2zm-18.912-12.974c-.236-.978-.05-1.845.554-2.444.526-.53 1.471-.791 2.656-.761l-3.21 3.205zm9.138 2.341l-.03-.029c-1.29-1.291-3.802-4.354-3.095-5.062.715-.715 3.488 1.521 5.062 3.095.862.863 2.088 2.248 2.938 3.459-1.718-1.073-3.493-1.469-4.875-1.463zm-3.875 12.348c-.547-.082-1.5-.547-1.9-.928l7.086-7.086c.351.37 1.264.931 1.753 1.075l-6.939 6.939z",this.cursor=new tt({icon:"M24 19.007c0-3.167-1.409-6.771-2.835-9.301l-.006-.01-.014-.026c-.732-1.392-1.914-3.052-3.619-4.757-2.976-2.976-5.476-3.912-6.785-3.913-.413 0-.708.094-.859.245l-.654.654c-1.898-.236-3.42.105-4.294.982-.876.875-1.164 2.159-.792 3.524.242.893.807 1.891 1.752 2.836.867.867 2.062 1.684 3.615 2.327.488-.839 1.654-1.019 2.359-.315.586.586.584 1.533-.002 2.119s-1.533.589-2.121 0c-.229-.229-.366-.515-.416-.812-1.646-.657-3.066-1.534-4.144-2.612-.728-.728-1.289-1.528-1.664-2.349l-2.835 2.832c-.445.447-.685 1.064-.686 1.82.001 1.635 1.122 3.915 3.714 6.506 2.764 2.764 5.58 4.243 7.431 4.243.649 0 1.181-.195 1.548-.562l8.086-8.079c.911.875-.777 3.541-.777 4.65 0 1.104.896 1.999 2 1.998 1.104 0 1.998-.895 1.998-2zm-18.912-12.974c-.236-.978-.05-1.845.554-2.444.526-.53 1.471-.791 2.656-.761l-3.21 3.205zm9.138 2.341l-.03-.029c-1.29-1.291-3.802-4.354-3.095-5.062.715-.715 3.488 1.521 5.062 3.095.862.863 2.088 2.248 2.938 3.459-1.718-1.073-3.493-1.469-4.875-1.463zm-3.875 12.348c-.547-.082-1.5-.547-1.9-.928l7.086-7.086c.351.37 1.264.931 1.753 1.075l-6.939 6.939z",offset:{x:3.5,y:11},size:{width:46,height:46}}),this.properties={diagonals:!1}}fillAllPixelsOfSameColor(e,t){throw new Error("Not implemented: fills all pixels")}fill(e,t){const n=Ye.stores.selectedColor.get(),r=Qe.stores.activeLayer.get().colorIndexAtPosition(e,t),s=[{x:e,y:t}];for(;s.length>0;){const{x:e,y:t}=s.shift();if(t<0||t>127)continue;if(e<0||e>127)continue;const o=Qe.stores.activeLayer.get().colorIndexAtPosition(e,t);o!=n&&(o==r&&(Qe.stores.activeLayer.get().setColorIndexAtPosition(e,t,n),s.push({x:e,y:t+1}),s.push({x:e,y:t-1}),s.push({x:e-1,y:t}),s.push({x:e+1,y:t}),this.properties.diagonals&&(s.push({x:e+1,y:t+1}),s.push({x:e-1,y:t-1}),s.push({x:e+1,y:t-1}),s.push({x:e-1,y:t+1}))))}Qe.stores.activeLayer.get().drawFromSource(Ye.stores.activeLayer.get())}primary(e){const{x:t,y:n}=e.realMousePosition;e.ctrlKey?this.fillAllPixelsOfSameColor(t,n):this.fill(t,n)}secondary(e){}move(e){lt.x=e.realMousePosition.x,lt.y=e.realMousePosition.y}}},ut={tools:ct,activeTool:Ne(void 0,(({value:e,store:t,get:n})=>({setActive(e){if(!(e instanceof _e))throw new Error("Invalid tool");const n=ct[e.key],{cursor:r}=n;let s="default";r&&r.icon&&(s=`url("data:image/svg+xml,%3Csvg transform='' xmlns='http://www.w3.org/2000/svg' width='${r.size.width}' height='${r.size.height}' viewBox='0 0 100 100' xml:space='preserve'%3E %3Cpath fill='white' d='${r.icon}'/%3E %3C/svg%3E") ${r.offset.x} ${r.offset.y}, auto`),document.documentElement.style.setProperty("--canvas-cursor",s),t.set(n)}})))};ut.activeTool.setActive(et.get("pen"));const pt=(e,...t)=>{e&&e.call(ut.activeTool.get(),...t)},{selectedColor:dt}=Ye.stores;globalThis.electron&&(Le.register("window_close",(e=>globalThis.electron.quit())),Le.register("window_minimize",(e=>globalThis.electron.minimize())),Le.register("window_maximize",(e=>globalThis.electron.maximize())),Le.register("window_toggle_fullscreen",(e=>globalThis.electron.toggleFullscreen())),Le.register("external_link",(e=>globalThis.electron.externalLink(e))),Le.register("palette_export",(async e=>{const t=Be.export(!0),{canceled:n,filePath:r}=await globalThis.electron.openSaveDialog([Te.palettes.save.extension]);n||"string"!=typeof r||await globalThis.electron.saveAs(r,t)})),Le.register("palette_import",(async e=>{const{canceled:t,filePaths:n}=await globalThis.electron.openFileDialog([Te.palettes.save.extension]);if(!t&&Array.isArray(n))for(const e of n){const{filePath:t,data:n}=await globalThis.electron.readFileDataFromPath(e,"utf8");Be.import(n)}}))),globalThis.electron||(Le.register("window_close",(e=>e)),Le.register("window_minimize",(e=>e)),Le.register("window_maximize",(e=>Le.execute("window_toggle_fullscreen"))),Le.register("window_toggle_fullscreen",(()=>{document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()})),Le.register("palette_import",(e=>{Ce([Te.palettes.save.extension],(e=>{Ye.import(e)}))})),Le.register("palette_export",(e=>{Se(Ae("palette",Te.palettes.save.extension),Ye.export(!0))})),Le.register("spritesheet_import",(e=>{Ce([Te.spritesheets.save.extension],(e=>{Qe.import(e)}))})),Le.register("spritesheet_export",(e=>{Se(Ae("spritesheet",Te.spritesheets.save.extension),Qe.export(!0))})),Le.register("spritesheet_import_chr",(e=>{Ce(["chr"],(e=>{Qe.importCHR(e)}),{readAs:"arraybuffer"})})),Le.register("spritesheet_export_chr",(e=>{const{label:t,data:n}=Qe.exportCHR();Se(Ae(t,"chr"),n)})),Le.register("spritesheet_export_png",(e=>{Qe.exportAsImage((({blob:e,label:t,options:n})=>{Se(Ae(t,"png"),e,{mimetype:e.type})}))}))),Le.register("noop",(e=>e)),Le.register("toggle_theme",(e=>document.documentElement.dataset.theme="dark"==document.documentElement.dataset.theme?"light":"dark")),Le.register("light_theme",(e=>document.documentElement.dataset.theme="light")),Le.register("dark_theme",(e=>document.documentElement.dataset.theme="dark")),Le.register("palette_clear",(e=>Ye.stores.layers.clear())),Le.register("palette_create",(e=>Ye.createLayer())),Le.register("palette_remove",(e=>Ye.removeLayer(e))),Le.register("palette_clone_layer",(e=>Ye.cloneLayer(e))),Le.register("palette_clone_active_layer",(e=>Ye.cloneActiveLayer())),Le.register("palette_make_layer_active",(e=>Ye.makeLayerActive(e))),Le.register("palette_swap_layers",(({to:e,from:t})=>Ye.stores.layers.swapLayers(e,t))),Le.register("palette_update_layer_label",(({source:e,label:t})=>Ye.updateLayerLabel(e,t))),Le.register("palette_active_color",(e=>dt.setActiveColorIndex(e))),Le.register("spritesheet_create",(e=>Qe.createLayer())),Le.register("spritesheet_remove",(e=>Qe.removeLayer(e))),Le.register("spritesheet_clone_layer",(e=>Qe.cloneLayer(e))),Le.register("spritesheet_clone_active_layer",(e=>Qe.cloneActiveLayer())),Le.register("spritesheet_make_layer_active",(e=>Qe.makeLayerActive(e))),Le.register("spritesheet_swap_layers",(({to:e,from:t})=>Qe.swapLayers(e,t))),Le.register("spritesheet_update_layer_label",(({source:e,label:t})=>Qe.updateLayerLabel(e,t))),Le.register("spritesheet_zoom",(e=>view.zoom(e))),Le.register("spritesheet_zoom_in",(e=>view.zoom(a(spritesheetsStore).zoom+1))),Le.register("spritesheet_zoom_out",(e=>view.zoom(a(spritesheetsStore).zoom-1))),Le.register("spritesheet_zoom_reset",(e=>view.zoom())),Le.register("spritesheet_set_active_tool",(e=>ut.activeTool.setActive(e)));class ht{constructor(e,t,n,r=[]){Object.assign(this,((e,t)=>{t=(t=`${e="/"+e.replace(/^[\/]+|[\/]+$/g,"")}/${t}`.replace(/[\/]+/g,"/")).replace(/^[\/]+|[\/]+$/g,"");const n=/\*$/.test(t)?(t=t.replace(/[\*]+$/g,""),""):"/?$",r=[];let s=0,o=t.replace(/(:)?([^\\/]+)/g,((e,t,n)=>{const[o,l]=n.split("->");if(t){const t=r.filter((e=>e.identifier==l));if(t.length>0)throw new Error(`Duplicated parameter. [${t.map((e=>e.identifier))}]`);return r.push({index:s++,parameter:e,identifier:o}),l?`(${l})`:"([^/]+)"}return`${e}`}));return o=`^/${o}${n}`,{base:e,route:t,regexpRoute:o,parameters:r}})(e,t)),this.callback=n,this.middlewares=r}}class ft{constructor(...e){this.props=e}use(e){if("function"!=typeof e)throw new Error(`Invalid Middleware use argument. Expecting 'function' got : '${typeof e}'`);return this.execute=(t=>n=>t(e.bind(this,...this.props,n)))(this.execute),this}execute(e){return e.call(null)}}class gt{constructor(e){Object.assign(this,{base:"",path:"",route:"",query:{},params:{},state:{}},e)}}class $t{constructor(e){Object.assign(this,e)}}class mt extends Error{}class vt extends class{constructor(e){Object.freeze(this.__properties={initial:void 0,base:"",state:{},...e}),this.__subscribing=!1,this.__get=new Map,this.__catch=new Map,this.__use=new Set}_register(e,t,n,r){return e.map((e=>{const s=new ht(this.__properties.base,e,t,n);if(r.has(s.regexpRoute))throw new Error(`Route with same endpoint already exist. [${e}, /${r.get(s.regexpRoute).route}](${s.regexpRoute})`);r.set(s.regexpRoute,s)})),e}_props(...e){let t,n,r=[];if(1==e.length)[n]=e,t="*";else if(2==e.length)[t,n]=e;else{if(!(e.length>2))throw new Error("Invalid number prop arguments.");t=e.shift(),n=e.pop(),r=e}return t=Array.isArray(t)?t:[t],{routes:t,fn:n,middlewares:r}}_storeInList(e,t,...n){const{routes:r,fn:s,middlewares:o}=this._props(...n),l=this._register(r,s,o,t),i={[e]:(...t)=>{const{routes:n,fn:r,middlewares:s}=this._props(...t);return l.map((t=>n.map((e=>t+e)).map((t=>this[e](t,...s,r))))),i}};return i}get(...e){return this._storeInList("get",this.__get,...e)}use(...e){const{routes:t,fn:n}=this._props(e);t.map((e=>this.__use.add(new ht(this.__properties.base,e,...n))))}catch(...e){return this._storeInList("catch",this.__catch,...e)}_findRoute(e,t,n){for(let[r,s]of t){const t=e.match(new RegExp(r,"i"));if(t){t.shift();let r={};t.length>0&&(r=s.parameters.reduce(((e,n,r)=>(e[n.identifier]=t[r],e)),r));const o=new URLSearchParams(window.location.search),l={};for(const[e,t]of o.entries())l[e]?Array.isArray(l[e])?l[e].push(t):l[e]=[l[e],t]:l[e]=t;return{RouteInstance:s,Request:new gt({path:e,route:"/"+s.route,base:s.base,query:l,params:r,state:{...n}})}}}}execute(e,t={}){if("string"!=typeof e)throw new Error("Invalid 'execute' argument. Expecting 'string'");if(!this.__subscribing)return;const n=new $t({send:(...e)=>this.__router_callback.call(null,...e),error:r=>{const s=this._findRoute(e,this.__catch,t);s?s.RouteInstance.callback.call(null,s.Request,n,r):console.warn(`No route or catch fallbacks found for [${e}]`)}});let r=this._findRoute(e,this.__get,t);if(!r)return void n.error();let s=[];const o=new ft(r.Request,n);this.__use.forEach((t=>{e.match(new RegExp(t.regexpRoute,"i"))&&s.push(t.callback)})),s=[...s,...r.RouteInstance.middlewares,r.RouteInstance.callback],s.map((e=>o.use(e))),o.execute()}subscribe(e){return this.__subscribing=!0,"function"==typeof e&&(this.__router_callback=e),this.__properties.initial&&this.execute(this.__properties.initial,this.__properties.state),()=>{this.__subscribing=!1}}}{}let xt=new class{constructor(){this.__linkBase="",this.__scrollReset=!0,this.__scrollOffset=0}setLinkBase(e){if("string"!=typeof e)throw new mt("Invalid 'linkBase'. Expecting value of type 'string'");return this.__linkBase=e.endsWith("/")?e:e+"/"}set linkBase(e){return this.setLinkBase(e)}get linkBase(){return this.__linkBase}setScrollReset(e){if("boolean"!=typeof e)throw new mt("Invalid 'scrollReset'. Expecting value of type 'boolean'");return this.__scrollReset=e}set scrollReset(e){return this.setScrollReset(e)}get scrollReset(){return this.__scrollReset}setScrollOffset(e){if("number"!=typeof e)throw new mt("Invalid 'scrollOffset'. Expecting value of type 'number'");return this.__scrollOffset=e}set scrollOffset(e){return this.setScrollOffset(e)}get scrollOffset(){return this.__scrollOffset}};const yt=e=>{const t=new RegExp(`^${xt.linkBase}`,"i");return"/"+(e=`/${e}/`.replace(/[\/]+/g,"/").replace(t,"").replace(/^\/|\/$/g,""))},wt=({state:e})=>{dispatchEvent(new CustomEvent("popstate",{detail:{...e}}))},bt=(e,t={})=>{e=Lt(e),history.pushState(t,"",e),wt({url:e,state:t})},_t=(e,t={})=>{e=Lt(e),history.replaceState(t,"",e),wt({url:e,state:t})},kt=(e,t={})=>{history.pushState(t,"",Lt(e))},Lt=e=>`/${xt.linkBase}/${e}`.replace(/[\/]+/g,"/"),Et=(e,t)=>{kt(yt(e));const n=window.location.hash.slice(1);if(n){t&&t.preventDefault();const e=document.querySelector(`a[name="${n}"], #${n}`);if(e){const t=e.getBoundingClientRect().top+window.pageYOffset-xt.scrollOffset;window.scrollTo({top:t})}}};let It={location:{...window.location},firstLoad:!1},zt=new Map,At=ge(),Ct=!1,St=!1;const Mt=e=>{const t=e.target;if("A"==t.tagName){const n=t.getAttribute("href"),r=n.indexOf("#")>-1;!/^[a-zA-Z]+\:\/\/(.*)/.test(n)&&r&&(Et(n.startsWith("#")?window.location.pathname+n:n,e),It.location={...window.location})}},Tt=async e=>{let t=!1;const n=Lt(window.location.pathname+"/")==Lt(It.location.pathname+"/")&&It.location.search==window.location.search;""!=window.location.hash&&n&&It.firstLoad&&(t=!0),""==window.location.hash&&window.location.hash!=It.location.hash&&n&&(t=!0,window.scrollTo({top:0})),t||(At.set(yt(window.location.pathname)),zt.forEach((t=>t.router.execute(window.location.pathname,e.detail)))),It.location={...window.location}};const Pt=e=>({component:1&e,props:1&e,decorator:1&e,decoratorProps:1&e}),Rt=e=>({component:e[0].context,props:e[0].props,decorator:e[0].decorator,decoratorProps:e[0].decoratorProps});function Ot(e){let t;const n=e[3].default,r=u(n,e,e[4],Rt),s=r||function(e){let t,n,r,s;const o=[Bt,Dt],l=[];function i(e,t){return e[0].decorator?0:1}return t=i(e),n=l[t]=o[t](e),{c(){n.c(),r=k()},m(e,n){l[t].m(e,n),m(e,r,n),s=!0},p(e,s){let a=t;t=i(e),t===a?l[t].p(e,s):(ee(),re(l[a],1,1,(()=>{l[a]=null})),te(),n=l[t],n?n.p(e,s):(n=l[t]=o[t](e),n.c()),ne(n,1),n.m(r.parentNode,r))},i(e){s||(ne(n),s=!0)},o(e){re(n),s=!1},d(e){l[t].d(e),e&&v(r)}}}(e);return{c(){s&&s.c()},m(e,n){s&&s.m(e,n),t=!0},p(e,t){r?r.p&&17&t&&d(r,n,e,e[4],t,Pt,Rt):s&&s.p&&1&t&&s.p(e,t)},i(e){t||(ne(s,e),t=!0)},o(e){re(s,e),t=!1},d(e){s&&s.d(e)}}}function Dt(e){let n,r,s;const o=[e[0].props];var l=e[0].context;function i(e){let n={};for(let e=0;e<o.length;e+=1)n=t(n,o[e]);return{props:n}}return l&&(n=new l(i())),{c(){n&&ce(n.$$.fragment),r=k()},m(e,t){n&&ue(n,e,t),m(e,r,t),s=!0},p(e,t){const s=1&t?ie(o,[ae(e[0].props)]):{};if(l!==(l=e[0].context)){if(n){ee();const e=n;re(e.$$.fragment,1,0,(()=>{pe(e,1)})),te()}l?(n=new l(i()),ce(n.$$.fragment),ne(n.$$.fragment,1),ue(n,r.parentNode,r)):n=null}else l&&n.$set(s)},i(e){s||(n&&ne(n.$$.fragment,e),s=!0)},o(e){n&&re(n.$$.fragment,e),s=!1},d(e){e&&v(r),n&&pe(n,e)}}}function Bt(e){let n,r,s;const o=[e[0].decoratorProps?e[0].decoratorProps:{}];var l=e[0].decorator;function i(e){let n={$$slots:{default:[Nt]},$$scope:{ctx:e}};for(let e=0;e<o.length;e+=1)n=t(n,o[e]);return{props:n}}return l&&(n=new l(i(e))),{c(){n&&ce(n.$$.fragment),r=k()},m(e,t){n&&ue(n,e,t),m(e,r,t),s=!0},p(e,t){const s=1&t?ie(o,[ae(e[0].decoratorProps?e[0].decoratorProps:{})]):{};if(17&t&&(s.$$scope={dirty:t,ctx:e}),l!==(l=e[0].decorator)){if(n){ee();const e=n;re(e.$$.fragment,1,0,(()=>{pe(e,1)})),te()}l?(n=new l(i(e)),ce(n.$$.fragment),ne(n.$$.fragment,1),ue(n,r.parentNode,r)):n=null}else l&&n.$set(s)},i(e){s||(n&&ne(n.$$.fragment,e),s=!0)},o(e){n&&re(n.$$.fragment,e),s=!1},d(e){e&&v(r),n&&pe(n,e)}}}function Nt(e){let n,r,s;const o=[e[0].props];var l=e[0].context;function i(e){let n={};for(let e=0;e<o.length;e+=1)n=t(n,o[e]);return{props:n}}return l&&(n=new l(i())),{c(){n&&ce(n.$$.fragment),r=k()},m(e,t){n&&ue(n,e,t),m(e,r,t),s=!0},p(e,t){const s=1&t?ie(o,[ae(e[0].props)]):{};if(l!==(l=e[0].context)){if(n){ee();const e=n;re(e.$$.fragment,1,0,(()=>{pe(e,1)})),te()}l?(n=new l(i()),ce(n.$$.fragment),ne(n.$$.fragment,1),ue(n,r.parentNode,r)):n=null}else l&&n.$set(s)},i(e){s||(n&&ne(n.$$.fragment,e),s=!0)},o(e){n&&re(n.$$.fragment,e),s=!1},d(e){e&&v(r),n&&pe(n,e)}}}function jt(e){let t,n,r=e[0]&&Ot(e);return{c(){r&&r.c(),t=k()},m(e,s){r&&r.m(e,s),m(e,t,s),n=!0},p(e,[n]){e[0]?r?(r.p(e,n),1&n&&ne(r,1)):(r=Ot(e),r.c(),ne(r,1),r.m(t.parentNode,t)):r&&(ee(),re(r,1,1,(()=>{r=null})),te())},i(e){n||(ne(r),n=!0)},o(e){re(r),n=!1},d(e){r&&r.d(e),e&&v(t)}}}function Ft(e,t,n){let r,{$$slots:s={},$$scope:o}=t,{context:l=zt.keys().next().value}=t;if(!(l&&l instanceof vt))throw new Error("Invalid Router context. Did you initialize the component with a valid context?");const{component:i}=zt.get(l);return c(e,i,(e=>n(0,r=e))),l.subscribe((async(e,t={},n={})=>{if("function"!=typeof e)throw new mt("Unable to load component. Did you pass a valid svelte component to the 'send' response?");xt.scrollReset&&window.scrollTo({top:0}),i.set({context:n?e:class extends e{},decorator:n.component?class extends n.component{}:void 0,decoratorProps:n.props||void 0,props:t}),window.location.hash&&(await J(),setTimeout((()=>{Et(window.location.pathname+window.location.hash)}),0)),It.firstLoad||(It.firstLoad=!0)})),e.$$set=e=>{"context"in e&&n(2,l=e.context),"$$scope"in e&&n(4,o=e.$$scope)},[r,i,l,s,o]}class Ht extends he{constructor(e){super(),de(this,e,Ft,jt,l,{context:2})}}var qt=(e,t)=>{if(t={type:"navigate",state:{},title:"",...t},xt.linkBase){const t=Lt(e.getAttribute("href")||"");e.setAttribute("href",t)}const n=e=>{let n=t.to||t.href||e.currentTarget.getAttribute("href")||e.currentTarget.getAttribute("data-href");if(n)if(n=yt(n),e.preventDefault(),"navigate"==t.type)bt(n,t.state,t.title);else if("redirect"==t.type)_t(n,t.state,t.title);else if("replace"==t.type)kt(n,t.state,t.title);else{if("alter"!=t.type)return void console.warn("Invalid 'use:link' type. Expecting 'navigate'(default), 'redirect', 'replace' or 'alter'");((e,t={})=>{history.replaceState(t,"",Lt(e))})(n,t.state,t.title)}};return e.addEventListener("click",n),{update(e){t={...t,...e}},destroy(){e.removeEventListener("click",n)}}},Kt=(e,...t)=>{let n;if(e instanceof vt?n=t.shift():(n=e,e=zt.keys().next().value),!e)throw new Error("Invalid Router context. Did you initialize the decorator with a valid context? or made sure to call it after one has been created?");let r="";const s=(o,...l)=>{let i;r||(r=o);let a=e=>{i={...e}};const c=l.pop();return e.get(o,...t,...l,((e,t)=>{c(e,{send:(e,r)=>{t.send(e,r,{component:n,props:i})},error:t.error},a)})),{get:(e,...t)=>s(`${r}/${e}`,...t)}};return s};function Gt(t){let n;return{c(){n=y("div"),n.innerHTML="<h1>This page is not available</h1> \n  <p>Currently not available in this version of the application.</p>",I(n,"class","checkered svelte-19ubedp")},m(e,t){m(e,n,t)},p:e,i:e,o:e,d(e){e&&v(n)}}}class Jt extends he{constructor(e){super(),de(this,e,null,Gt,l,{})}}globalThis.electron||"localhost"===window.location.hostname||(xt.linkBase="/NESBitStudio-web");const Ut=(e=>{(async()=>{Ct||(Ct=!0,St||(St=!0,At.set(yt(window.location.pathname))),window.addEventListener("popstate",Tt),window.addEventListener("click",Mt))})();const t=new vt(e);return zt.set(t,{component:ge(),router:t}),t})({initial:window.location.pathname,base:xt.linkBase});Ut.catch(((e,t)=>{t.send(Jt)}));class Wt{constructor({keys:e,data:t,groups:n,options:r}){if(!Array.isArray(e))throw new Error("Invalid keys. Expecting array of string representation values.");this.options={...r},this.groups=n||[],this.signature=e.toString(),this.keys=e,this.data=t,this.__on,this.__off}get callbacks(){return{on:this.__on,off:this.__off}}on(e){if("function"!=typeof e)throw new Error("Invalid 'off' function");return this.__on=e,this}off(e){if("function"!=typeof e)throw new Error("Invalid 'off' function");return this.__off=e,this}}const Yt=new class{constructor(e,t){this.__options={once:!0,preventDefault:!0,...t},this.__registeredGroups=new Set,this.__enabledGroups="__all__",this.__commands=new Map,this.__target=e}get target(){return this.__target}_prepare(e){if(!Array.isArray(e))throw new Error(`Invalid '_prepare' argument. Expecting array, got : [${typeof e}]`);return[...e].map((e=>e.toLowerCase())).sort(((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase())))}enableAllGroups(){this.__enabledGroups="__all__"}enableGroups(...e){return[...this.__enabledGroups=[...e]]}_find(e){const t=Array.from(this.__commands.values());let n;return t.sort(((e,t)=>t.options.priority-e.options.priority)),Array.isArray(this.__enabledGroups)?n=t.find((t=>t.groups.some((n=>{if((!this.__enabledGroups||this.__enabledGroups.includes(n))&&t.signature==e.toString())return!0})))):"__all__"==this.__enabledGroups&&(n=t.find((t=>t.signature==e.toString()))),n}set(e,{data:t,groups:n,...r}){(n=Array.isArray(n)&&n.length>0?n:["*"]).map((e=>this.__registeredGroups.add(e)));const s=this._prepare(e),o=new Wt({keys:s,data:t,groups:n,options:{priority:r.priority||0,once:r.once||this.__options.once,preventDefault:r.preventDefault||this.__options.preventDefault}});return n.map((e=>{if(this.__commands.get(`${e},${o.signature}`))throw new Error(`Shortcut already defined : [${e},${o.signature}]`);this.__commands.set(`${e},${o.signature}`,o)})),o}execute(e,t){if("on"==t||null==t){const t={};e.map((e=>t[e.toLowerCase()]=!0));const n=new Event("keydown");n.customExecuteEvent=t,this.__target.dispatchEvent(n)}"off"!=t&&null!=t||e.map((e=>{const t=new Event("keyup");t.code=e,this.__target.dispatchEvent(t)}))}subscribe(e){let t={},n={};const r=r=>{r.customExecuteEvent?t=r.customExecuteEvent:t[r.code.toLowerCase()]=!0;const s=this._prepare(Object.entries(t).filter((([e,t])=>t)).map((([e,t])=>e.toLowerCase()))),o=this._find(s);if(o){if(o.options.preventDefault&&r.preventDefault(),o.options.once&&s.toString()==n.signature)return;n={instance:o,signature:s.toString()},"function"==typeof o.callbacks.on?o.callbacks.on.call(null,{e:r,Hotkey:o,on:!0}):"function"==typeof e&&e.call(null,{e:r,Hotkey:o,on:!0})}},s=r=>{t[r.code.toLowerCase()]=!1,n.instance&&"function"==typeof n.instance.callbacks.off?n.instance.callbacks.off.call(null,{e:r,Hotkey:n.instance,on:!1}):n.instance&&"function"==typeof e&&e.call(null,{e:r,Hotkey:n.instance,on:!1}),n={}};return this.__target.addEventListener("keydown",r),this.__target.addEventListener("keyup",s),()=>(this.__target.removeEventListener("keyup",s),this.__target.removeEventListener("keydown",r),t=>this.subscribe(this.__target,e))}}(window,{});Yt.set(["ControlLeft","KeyO"],{data:{action:Le.action("noop")}}),Yt.subscribe((({e:e,Hotkey:t,on:n})=>{e.preventDefault(),n&&t.data&&Le.exist(t.data.action)&&Le.execute(t.data.action,t.data.props)}));const Xt=({e:e,Hotkey:t,on:n})=>{e.preventDefault(),n&&t.data&&Le.exist(t.data.action)&&Le.execute(t.data.action),Yt.execute(t.keys,"off")};function Vt(e){let t,n,r;const s=e[1].default,o=u(s,e,e[0],null);return{c(){t=y("div"),n=y("ul"),o&&o.c(),I(n,"id","areanav"),I(n,"class","svelte-1vnr3x8"),I(t,"id","tabnav"),I(t,"class","svelte-1vnr3x8")},m(e,s){m(e,t,s),$(t,n),o&&o.m(n,null),r=!0},p(e,[t]){o&&o.p&&1&t&&d(o,s,e,e[0],t,null,null)},i(e){r||(ne(o,e),r=!0)},o(e){re(o,e),r=!1},d(e){e&&v(t),o&&o.d(e)}}}function Zt(e,t,n){let{$$slots:r={},$$scope:s}=t;return e.$$set=e=>{"$$scope"in e&&n(0,s=e.$$scope)},[s,r]}class Qt extends he{constructor(e){super(),de(this,e,Zt,Vt,l,{})}}function en(e,t,n){const r=e.slice();return r[2]=t[n],r}function tn(e){let t,n,r,s,o,l,i=e[2].label+"";return{c(){t=y("li"),n=y("button"),r=b(i),s=_(),I(n,"href",e[2].href),I(n,"label",e[2].label),I(n,"class","svelte-1p6gkk9"),I(t,"class","no-drag"),S(t,"active",e[2].href==e[0])},m(e,i){m(e,t,i),$(t,n),$(n,r),$(t,s),o||(l=g(qt.call(null,n)),o=!0)},p(e,n){3&n&&S(t,"active",e[2].href==e[0])},d(e){e&&v(t),o=!1,l()}}}function nn(e){let t,n=e[1],r=[];for(let t=0;t<n.length;t+=1)r[t]=tn(en(e,n,t));return{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=k()},m(e,n){for(let t=0;t<r.length;t+=1)r[t].m(e,n);m(e,t,n)},p(e,s){if(3&s){let o;for(n=e[1],o=0;o<n.length;o+=1){const l=en(e,n,o);r[o]?r[o].p(l,s):(r[o]=tn(l),r[o].c(),r[o].m(t.parentNode,t))}for(;o<r.length;o+=1)r[o].d(1);r.length=n.length}},d(e){x(r,e),e&&v(t)}}}function rn(e){let t,n;return t=new Qt({props:{$$slots:{default:[nn]},$$scope:{ctx:e}}}),{c(){ce(t.$$.fragment)},m(e,r){ue(t,e,r),n=!0},p(e,[n]){const r={};33&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){re(t.$$.fragment,e),n=!1},d(e){pe(t,e)}}}function sn(e,t,n){let r;c(e,At,(e=>n(0,r=e)));return[r,[{href:"/graphics/palettes",label:"Palettes"},{href:"/graphics/spritesheets",label:"Spritesheets"},{href:"/graphics/animations",label:"Animations"},{href:"/graphics/metatiles",label:"Metatiles"},{href:"/graphics/tilemaps",label:"Tilemaps"}]]}class on extends he{constructor(e){super(),de(this,e,sn,rn,l,{})}}function ln(e){let t,n,r,s,o,l;r=new on({});const i=e[1].default,a=u(i,e,e[0],null);return{c(){t=y("section"),n=y("div"),ce(r.$$.fragment),s=_(),o=y("div"),a&&a.c(),I(o,"class","main svelte-10f6qa1"),I(t,"id","spritesheets"),I(t,"class","svelte-10f6qa1")},m(e,i){m(e,t,i),$(t,n),ue(r,n,null),$(t,s),$(t,o),a&&a.m(o,null),l=!0},p(e,[t]){a&&a.p&&1&t&&d(a,i,e,e[0],t,null,null)},i(e){l||(ne(r.$$.fragment,e),ne(a,e),l=!0)},o(e){re(r.$$.fragment,e),re(a,e),l=!1},d(e){e&&v(t),pe(r),a&&a.d(e)}}}function an(e,t,n){let{$$slots:r={},$$scope:s}=t;return e.$$set=e=>{"$$scope"in e&&n(0,s=e.$$scope)},[s,r]}function cn(e){let t,n,r,s,o,l;r=new on({});const i=e[1].default,a=u(i,e,e[0],null);return{c(){t=y("section"),n=y("div"),ce(r.$$.fragment),s=_(),o=y("div"),a&&a.c(),I(o,"class","main svelte-aj3pvw"),I(t,"id","palettes"),I(t,"class","svelte-aj3pvw")},m(e,i){m(e,t,i),$(t,n),ue(r,n,null),$(t,s),$(t,o),a&&a.m(o,null),l=!0},p(e,[t]){a&&a.p&&1&t&&d(a,i,e,e[0],t,null,null)},i(e){l||(ne(r.$$.fragment,e),ne(a,e),l=!0)},o(e){re(r.$$.fragment,e),re(a,e),l=!1},d(e){e&&v(t),pe(r),a&&a.d(e)}}}function un(e,t,n){let{$$slots:r={},$$scope:s}=t;return e.$$set=e=>{"$$scope"in e&&n(0,s=e.$$scope)},[s,r]}function pn(e){let t,n,r,o,l,i,a;const c=e[4].default,p=u(c,e,e[3],null);return{c(){t=y("div"),n=y("div"),r=y("div"),o=y("div"),p&&p.c(),I(o,"class","content svelte-131dyyn"),I(r,"class","wrapper svelte-131dyyn"),I(n,"class","outer svelte-131dyyn"),I(t,"class","artboard svelte-131dyyn"),S(t,"active",e[0])},m(s,c){m(s,t,c),$(t,n),$(n,r),$(r,o),p&&p.m(o,null),e[5](r),e[6](n),e[8](t),l=!0,i||(a=[L(n,"mousedown",e[2]),L(n,"wheel",e[7]),L(t,"wheel",e[1])],i=!0)},p(e,[n]){p&&p.p&&8&n&&d(p,c,e,e[3],n,null,null),1&n&&S(t,"active",e[0])},i(e){l||(ne(p,e),l=!0)},o(e){re(p,e),l=!1},d(n){n&&v(t),p&&p.d(n),e[5](null),e[6](null),e[8](null),i=!1,s(a)}}}let dn,hn,fn;const gn=()=>{dn.scrollTo(hn.offsetWidth/2-dn.offsetWidth/2,hn.offsetHeight/2-dn.offsetHeight/2)};function $n(e,t,n){let{$$slots:r={},$$scope:s}=t;const o=D();let l=!1,i=!1;const a=new ResizeObserver((e=>(e=>{for(const t of e)if(t.contentRect){t.contentRect;const e={x:8e3,y:8e3};hn.style.height=e.y+"px",hn.style.width=e.x+"px",l||(l=!0,gn())}})(e)));let c,u,p,d,h={};const f=e=>{e.preventDefault(),h[e.code]=!0},g=e=>{h[e.code]=!1},$=()=>{n(0,i=!1)},m=e=>{if(!i)return;e.preventDefault();const t=1*(e.pageX-dn.offsetLeft-c);dn.scrollLeft=p-t;const n=1*(e.pageY-dn.offsetTop-u);dn.scrollTop=d-n};R((()=>{document.addEventListener("keydown",f),document.addEventListener("keyup",g),a.observe(fn),document.addEventListener("mousemove",m),document.addEventListener("mouseup",$)})),O((()=>{document.removeEventListener("keydown",f),document.removeEventListener("keyup",g),a.disconnect(),document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",$)}));return e.$$set=e=>{"$$scope"in e&&n(3,s=e.$$scope)},[i,e=>{o("artboardScrollEvent",e)},e=>{(e.ctrlKey||h.Space||2==e.which)&&(e.stopImmediatePropagation(),e.preventDefault(),n(0,i=!0),c=e.pageX-dn.offsetLeft,p=dn.scrollLeft,u=e.pageY-dn.offsetTop,d=dn.scrollTop)},s,r,function(e){j[e?"unshift":"push"]((()=>{hn=e}))},function(e){j[e?"unshift":"push"]((()=>{dn=e}))},e=>e.preventDefault(),function(e){j[e?"unshift":"push"]((()=>{fn=e}))}]}class mn extends he{constructor(e){super(),de(this,e,$n,pn,l,{})}}function vn(t){let n,r,s,o,l;return{c(){n=y("button"),r=y("div"),s=b(" "),C(r,"--color",t[0]),I(r,"class","svelte-10hh6bt"),I(n,"class","color-selector svelte-10hh6bt"),S(n,"selected",t[1])},m(e,i){m(e,n,i),$(n,r),$(r,s),o||(l=L(n,"click",t[2]),o=!0)},p(e,[t]){1&t&&C(r,"--color",e[0]),2&t&&S(n,"selected",e[1])},i:e,o:e,d(e){e&&v(n),o=!1,l()}}}function xn(e,t,n){let{color:r}=t,{selected:s}=t;return e.$$set=e=>{"color"in e&&n(0,r=e.color),"selected"in e&&n(1,s=e.selected)},[r,s,function(t){B(e,t)}]}class yn extends he{constructor(e){super(),de(this,e,xn,vn,l,{color:0,selected:1})}}function wn(e,t,n){const r=e.slice();return r[5]=t[n],r[7]=n,r}function bn(e){let t,n,r=e[0].colors,s=[];for(let t=0;t<r.length;t+=1)s[t]=_n(wn(e,r,t));const o=e=>re(s[e],1,1,(()=>{s[e]=null}));return{c(){t=y("ul");for(let e=0;e<s.length;e+=1)s[e].c()},m(e,r){m(e,t,r);for(let e=0;e<s.length;e+=1)s[e].m(t,null);n=!0},p(e,n){if(3&n){let l;for(r=e[0].colors,l=0;l<r.length;l+=1){const o=wn(e,r,l);s[l]?(s[l].p(o,n),ne(s[l],1)):(s[l]=_n(o),s[l].c(),ne(s[l],1),s[l].m(t,null))}for(ee(),l=r.length;l<s.length;l+=1)o(l);te()}},i(e){if(!n){for(let e=0;e<r.length;e+=1)ne(s[e]);n=!0}},o(e){s=s.filter(Boolean);for(let e=0;e<s.length;e+=1)re(s[e]);n=!1},d(e){e&&v(t),x(s,e)}}}function _n(e){let t,n,r,s;return n=new yn({props:{color:e[5].rgb,selected:e[1]===e[7]}}),n.$on("click",(function(...t){return e[4](e[7],...t)})),{c(){t=y("li"),ce(n.$$.fragment),r=_()},m(e,o){m(e,t,o),ue(n,t,null),$(t,r),s=!0},p(t,r){e=t;const s={};1&r&&(s.color=e[5].rgb),2&r&&(s.selected=e[1]===e[7]),n.$set(s)},i(e){s||(ne(n.$$.fragment,e),s=!0)},o(e){re(n.$$.fragment,e),s=!1},d(e){e&&v(t),pe(n)}}}function kn(e){let t,n,r=e[0]&&bn(e);return{c(){r&&r.c(),t=k()},m(e,s){r&&r.m(e,s),m(e,t,s),n=!0},p(e,[n]){e[0]?r?(r.p(e,n),1&n&&ne(r,1)):(r=bn(e),r.c(),ne(r,1),r.m(t.parentNode,t)):r&&(ee(),re(r,1,1,(()=>{r=null})),te())},i(e){n||(ne(r),n=!0)},o(e){re(r),n=!1},d(e){r&&r.d(e),e&&v(t)}}}function Ln(e,t,n){let r,s;const{activeLayer:o,selectedColor:l}=Ye.stores;c(e,o,(e=>n(0,r=e))),c(e,l,(e=>n(1,s=e)));return[r,s,o,l,(e,t)=>Le.execute("palette_active_color",e)]}class En extends he{constructor(e){super(),de(this,e,Ln,kn,l,{})}}function In(e){let t,n,r,o;const l=e[2].default,i=u(l,e,e[1],null);return{c(){t=y("button"),i&&i.c(),I(t,"class","svelte-1j1cp6x"),S(t,"selected",e[0])},m(s,l){m(s,t,l),i&&i.m(t,null),n=!0,r||(o=[L(t,"dblclick",e[3]),L(t,"click",e[4])],r=!0)},p(e,[n]){i&&i.p&&2&n&&d(i,l,e,e[1],n,null,null),1&n&&S(t,"selected",e[0])},i(e){n||(ne(i,e),n=!0)},o(e){re(i,e),n=!1},d(e){e&&v(t),i&&i.d(e),r=!1,s(o)}}}function zn(e,t,n){let{$$slots:r={},$$scope:s}=t,{selected:o}=t;return e.$$set=e=>{"selected"in e&&n(0,o=e.selected),"$$scope"in e&&n(1,s=e.$$scope)},[o,s,r,function(t){B(e,t)},function(t){B(e,t)}]}class An extends he{constructor(e){super(),de(this,e,zn,In,l,{selected:0})}}function Cn(e,t,n){const r=e.slice();return r[6]=t[n],r}function Sn(t){let n,r;return{c(){n=w("svg"),r=w("path"),I(r,"d",t[6].icon),I(n,"xmlns","http://www.w3.org/2000/svg"),I(n,"width","18"),I(n,"height","18"),I(n,"viewBox","0 0 24 24")},m(e,t){m(e,n,t),$(n,r)},p:e,d(e){e&&v(n)}}}function Mn(e){let t,n,r=e[6].visible_in_toolbar&&function(e){let t,n,r,s;return n=new An({props:{selected:e[0]===e[6],$$slots:{default:[Sn]},$$scope:{ctx:e}}}),n.$on("dblclick",e[3]),n.$on("click",(function(...t){return e[4](e[6],...t)})),{c(){t=y("li"),ce(n.$$.fragment),r=_(),I(t,"class","svelte-1pqmo8i")},m(e,o){m(e,t,o),ue(n,t,null),$(t,r),s=!0},p(t,r){e=t;const s={};1&r&&(s.selected=e[0]===e[6]),512&r&&(s.$$scope={dirty:r,ctx:e}),n.$set(s)},i(e){s||(ne(n.$$.fragment,e),s=!0)},o(e){re(n.$$.fragment,e),s=!1},d(e){e&&v(t),pe(n)}}}(e);return{c(){r&&r.c(),t=k()},m(e,s){r&&r.m(e,s),m(e,t,s),n=!0},p(e,t){e[6].visible_in_toolbar&&r.p(e,t)},i(e){n||(ne(r),n=!0)},o(e){re(r),n=!1},d(e){r&&r.d(e),e&&v(t)}}}function Tn(e){let t,n,r=e[2],s=[];for(let t=0;t<r.length;t+=1)s[t]=Mn(Cn(e,r,t));const o=e=>re(s[e],1,1,(()=>{s[e]=null}));return{c(){t=y("ul");for(let e=0;e<s.length;e+=1)s[e].c()},m(e,r){m(e,t,r);for(let e=0;e<s.length;e+=1)s[e].m(t,null);n=!0},p(e,[n]){if(5&n){let l;for(r=e[2],l=0;l<r.length;l+=1){const o=Cn(e,r,l);s[l]?(s[l].p(o,n),ne(s[l],1)):(s[l]=Mn(o),s[l].c(),ne(s[l],1),s[l].m(t,null))}for(ee(),l=r.length;l<s.length;l+=1)o(l);te()}},i(e){if(!n){for(let e=0;e<r.length;e+=1)ne(s[e]);n=!0}},o(e){s=s.filter(Boolean);for(let e=0;e<s.length;e+=1)re(s[e]);n=!1},d(e){e&&v(t),x(s,e)}}}function Pn(e,t,n){let r;const{tools:s,activeTool:o}=ut;c(e,o,(e=>n(0,r=e)));const l=Object.values(s);l.sort(((e,t)=>t.weight-e.weight));return[r,o,l,e=>Le.execute("noop"),(e,t)=>Le.execute("spritesheet_set_active_tool",e.enum)]}class Rn extends he{constructor(e){super(),de(this,e,Pn,Tn,l,{})}}function On(t){let n,r,s,o,l,i,a;return s=new Rn({}),i=new En({}),{c(){n=y("section"),r=y("section"),ce(s.$$.fragment),o=_(),l=y("section"),ce(i.$$.fragment),I(r,"class","toolbar-section svelte-t490rv"),I(l,"class","color-selector-section svelte-t490rv"),I(n,"class","toolbar svelte-t490rv")},m(e,t){m(e,n,t),$(n,r),ue(s,r,null),$(n,o),$(n,l),ue(i,l,null),a=!0},p:e,i(e){a||(ne(s.$$.fragment,e),ne(i.$$.fragment,e),a=!0)},o(e){re(s.$$.fragment,e),re(i.$$.fragment,e),a=!1},d(e){e&&v(n),pe(s),pe(i)}}}class Dn extends he{constructor(e){super(),de(this,e,null,On,l,{})}}function Bn(e){let n,r,s,o;const l=e[4].default,i=u(l,e,e[3],null),a=i||function(e){let t;return{c(){t=b("placeholder")},m(e,n){m(e,t,n)},d(e){e&&v(t)}}}();let c=[{role:"button"},e[2]],p={};for(let e=0;e<c.length;e+=1)p=t(p,c[e]);return{c(){n=y("button"),a&&a.c(),z(n,p),S(n,"danger","danger"==e[0]),S(n,"svelte-kdthmx",!0)},m(t,l){m(t,n,l),a&&a.m(n,null),r=!0,s||(o=L(n,"click",e[1]),s=!0)},p(e,[t]){i&&i.p&&8&t&&d(i,l,e,e[3],t,null,null),z(n,p=ie(c,[{role:"button"},4&t&&e[2]])),S(n,"danger","danger"==e[0]),S(n,"svelte-kdthmx",!0)},i(e){r||(ne(a,e),r=!0)},o(e){re(a,e),r=!1},d(e){e&&v(n),a&&a.d(e),s=!1,o()}}}function Nn(e,n,r){let{$$slots:s={},$$scope:o}=n;const l=D();let{variant:i}=n;return e.$$set=e=>{r(2,n=t(t({},n),h(e))),"variant"in e&&r(0,i=e.variant),"$$scope"in e&&r(3,o=e.$$scope)},n=h(n),[i,e=>{("danger"!=i||e.ctrlKey||e.altKey)&&l("click")},n,o,s]}class jn extends he{constructor(e){super(),de(this,e,Nn,Bn,l,{variant:0})}}const Fn=(e,t,n,r)=>{const s=e;if(t<s.length){const r=e.slice(0,t);e=r.slice(0,r.lastIndexOf(n))}return"function"==typeof r&&(e=r.call(null,e,s,n)),e};function Hn(e){let t,n,r,o;const l=e[9].default,i=u(l,e,e[8],null),a=i||function(e){let t;return{c(){t=b("Label")},m(e,n){m(e,t,n)},d(e){e&&v(t)}}}();return{c(){t=y("div"),a&&a.c(),I(t,"class","heading svelte-moa0u7"),I(t,"spellcheck","false"),S(t,"active",e[0])},m(s,l){m(s,t,l),a&&a.m(t,null),e[10](t),n=!0,r||(o=[L(t,"click",e[1]),L(t,"focus",e[3]),L(t,"blur",e[5]),L(t,"keydown",e[4])],r=!0)},p(e,[n]){i&&i.p&&256&n&&d(i,l,e,e[8],n,null,null),1&n&&S(t,"active",e[0])},i(e){n||(ne(a,e),n=!0)},o(e){re(a,e),n=!1},d(n){n&&v(t),a&&a.d(n),e[10](null),r=!1,s(o)}}}function qn(e,t,n){let{$$slots:r={},$$scope:s}=t,{active:o}=t,{label:l}=t,{iconIndicator:i}=t;const a=D();let c,u=null;return e.$$set=e=>{"active"in e&&n(0,o=e.active),"label"in e&&n(7,l=e.label),"iconIndicator"in e&&n(6,i=e.iconIndicator),"$$scope"in e&&n(8,s=e.$$scope)},[o,e=>{e.preventDefault();let t=!1;1==e.detail&&e.target==c?(a("makeActive"),t||(t=!0,setTimeout((e=>t=!1),60))):(n(6,i=!1),n(2,c.contentEditable=!0,c),c.focus())},c,e=>{e.target.textContent=l;const t=document.createRange(),n=window.getSelection();t.selectNodeContents(e.target),n.removeAllRanges(),n.addRange(t)},e=>{if(u||(u=e.currentTarget.textContent),e.stopPropagation(),e.stopImmediatePropagation(),27==e.which)return e.currentTarget.textContent=u,e.preventDefault(),void c.blur();if(13==e.which&&(e.preventDefault(),c.blur()),8==e.which||46==e.which||37==e.which||39==e.which)return;/^[a-z\s]$/i.test(e.key)||"Backspace"===e.key?e.currentTarget.textContent.length>20&&e.preventDefault():e.preventDefault()},e=>{u=null,n(6,i=!0);const t=e.target.textContent;e.target.textContent=Fn(t,15,"",((e,t)=>e!=t?e+"...":e)),window.getSelection().removeAllRanges(),e.target.contentEditable=!1,a("change",t)},i,l,s,r,function(e){j[e?"unshift":"push"]((()=>{c=e,n(2,c)}))}]}class Kn extends he{constructor(e){super(),de(this,e,qn,Hn,l,{active:0,label:7,iconIndicator:6,edit:1})}get edit(){return this.$$.ctx[1]}}function Gn(e){let t,n,r,s;const o=e[2].default,l=u(o,e,e[1],null);return{c(){t=y("button"),l&&l.c(),I(t,"class","svelte-1dsxcgu"),S(t,"danger","danger"==e[0])},m(o,i){m(o,t,i),l&&l.m(t,null),n=!0,r||(s=L(t,"click",e[3]),r=!0)},p(e,[n]){l&&l.p&&2&n&&d(l,o,e,e[1],n,null,null),1&n&&S(t,"danger","danger"==e[0])},i(e){n||(ne(l,e),n=!0)},o(e){re(l,e),n=!1},d(e){e&&v(t),l&&l.d(e),r=!1,s()}}}function Jn(e,t,n){let{$$slots:r={},$$scope:s}=t,{variant:o}=t;return e.$$set=e=>{"variant"in e&&n(0,o=e.variant),"$$scope"in e&&n(1,s=e.$$scope)},[o,s,r,function(t){B(e,t)}]}class Un extends he{constructor(e){super(),de(this,e,Jn,Gn,l,{variant:0})}}const Wn=(e,t)=>{if(!t||"string"!=typeof t.type)throw new Error("Invalid 'drag' actions properties. Expecting 'type' of type 'string'");if(!t.value)throw new Error("Invalid 'drag' actions value.");e.draggable=!0,e.classList.add("draggable");const n=e=>{e.stopImmediatePropagation(),e.dataTransfer.setData(t.type,JSON.stringify(t.value||"")),window.dispatchEvent(new Event("mouseup"))};return e.addEventListener("dragstart",n),{destroy(){e.removeEventListener("dragstart",n)}}},Yn=(e,t)=>{if(!t)throw new Error("Invalid 'drop' actions props.");const n=(e,n)=>{if(t[e]||"function"==typeof t[e])return t[e];if(!n)throw new Error(`Invalid 'drop' callback : [${e}]`)},r=t=>{t.preventDefault(),n("over",!0).call(null,t,e)};e.addEventListener("dragover",r);e.addEventListener("dragleave",(t=>{n("leave",!0).call(null,t,e)}));const s=r=>{n("drop").call(null,{e:r,node:e,value:t.value})};return e.addEventListener("drop",s),{destroy(){e.removeEventListener("dragover",r),e.removeEventListener("drop",s)}}};function Xn(e){let t;return{c(){t=b(e[5])},m(e,n){m(e,t,n)},p(e,n){32&n&&A(t,e[5])},d(e){e&&v(t)}}}function Vn(e){let t,n,r,s;n=new Un({props:{$$slots:{default:[Zn]},$$scope:{ctx:e}}}),n.$on("click",e[19]);let o=e[2]&&Qn(e);return{c(){t=y("div"),ce(n.$$.fragment),r=_(),o&&o.c(),I(t,"class","icon-indicator svelte-7368bw")},m(e,l){m(e,t,l),ue(n,t,null),$(t,r),o&&o.m(t,null),s=!0},p(e,r){const s={};1048576&r&&(s.$$scope={dirty:r,ctx:e}),n.$set(s),e[2]?o?(o.p(e,r),4&r&&ne(o,1)):(o=Qn(e),o.c(),ne(o,1),o.m(t,null)):o&&(ee(),re(o,1,1,(()=>{o=null})),te())},i(e){s||(ne(n.$$.fragment,e),ne(o),s=!0)},o(e){re(n.$$.fragment,e),re(o),s=!1},d(e){e&&v(t),pe(n),o&&o.d()}}}function Zn(e){let t,n;return{c(){t=w("svg"),n=w("path"),I(n,"d","M19.769 9.923l-12.642 12.639-7.127 1.438 1.438-7.128 12.641-12.64 5.69 5.691zm1.414-1.414l2.817-2.82-5.691-5.689-2.816 2.817 5.69 5.692z"),I(n,"class","svelte-7368bw"),I(t,"xmlns","http://www.w3.org/2000/svg"),I(t,"width","12"),I(t,"height","12"),I(t,"viewBox","0 0 24 24"),I(t,"class","svelte-7368bw")},m(e,r){m(e,t,r),$(t,n)},d(e){e&&v(t)}}}function Qn(e){let t,n,r,s;return t=new Un({props:{$$slots:{default:[er]},$$scope:{ctx:e}}}),t.$on("click",e[11]),r=new Un({props:{variant:"danger",$$slots:{default:[tr]},$$scope:{ctx:e}}}),r.$on("click",e[10]),{c(){ce(t.$$.fragment),n=_(),ce(r.$$.fragment)},m(e,o){ue(t,e,o),m(e,n,o),ue(r,e,o),s=!0},p(e,n){const s={};1048576&n&&(s.$$scope={dirty:n,ctx:e}),t.$set(s);const o={};1048576&n&&(o.$$scope={dirty:n,ctx:e}),r.$set(o)},i(e){s||(ne(t.$$.fragment,e),ne(r.$$.fragment,e),s=!0)},o(e){re(t.$$.fragment,e),re(r.$$.fragment,e),s=!1},d(e){pe(t,e),e&&v(n),pe(r,e)}}}function er(e){let t,n;return{c(){t=w("svg"),n=w("path"),I(n,"d","M18 6v-6h-18v18h6v6h18v-18h-6zm-12 10h-4v-14h14v4h-10v10zm16 6h-14v-14h14v14zm-3-8h-3v-3h-2v3h-3v2h3v3h2v-3h3v-2z"),I(n,"class","svelte-7368bw"),I(t,"xmlns","http://www.w3.org/2000/svg"),I(t,"width","12"),I(t,"height","12"),I(t,"viewBox","0 0 24 24"),I(t,"class","svelte-7368bw")},m(e,r){m(e,t,r),$(t,n)},d(e){e&&v(t)}}}function tr(e){let t,n;return{c(){t=w("svg"),n=w("path"),I(n,"d","M3 6v18h18v-18h-18zm5 14c0 .552-.448 1-1 1s-1-.448-1-1v-10c0-.552.448-1 1-1s1 .448 1 1v10zm5 0c0 .552-.448 1-1 1s-1-.448-1-1v-10c0-.552.448-1 1-1s1 .448 1 1v10zm5 0c0 .552-.448 1-1 1s-1-.448-1-1v-10c0-.552.448-1 1-1s1 .448 1 1v10zm4-18v2h-20v-2h5.711c.9 0 1.631-1.099 1.631-2h5.315c0 .901.73 2 1.631 2h5.712z"),I(n,"class","svelte-7368bw"),I(t,"xmlns","http://www.w3.org/2000/svg"),I(t,"width","12"),I(t,"height","12"),I(t,"viewBox","0 0 24 24"),I(t,"class","svelte-7368bw")},m(e,r){m(e,t,r),$(t,n)},d(e){e&&v(t)}}}function nr(e){let t,n,r,l,i,a,c,p,h,f,x;function w(t){e[15].call(null,t)}let b={active:e[8],label:e[0].label,$$slots:{default:[Xn]},$$scope:{ctx:e}};void 0!==e[4]&&(b.iconIndicator=e[4]),r=new Kn({props:b}),j.push((()=>function(e,t,n){const r=e.$$.props[t];void 0!==r&&(e.$$.bound[r]=n,n(e.$$.ctx[r]))}(r,"iconIndicator",w))),e[16](r),r.$on("makeActive",e[17]),r.$on("change",e[18]);let k=e[4]&&Vn(e);const L=e[14].default,E=u(L,e,e[20],null);return{c(){t=y("div"),n=y("div"),ce(r.$$.fragment),i=_(),k&&k.c(),a=_(),E&&E.c(),I(n,"class","panel-header svelte-7368bw"),I(t,"class","layer-item svelte-7368bw"),S(t,"over",e[7]),S(t,"active",e[8])},m(s,o){m(s,t,o),$(t,n),ue(r,n,null),$(n,i),k&&k.m(n,null),$(t,a),E&&E.m(t,null),h=!0,f||(x=[g(c=Wn.call(null,t,{type:"flipPalette",value:{layerIndex:e[3]}})),g(p=Yn.call(null,t,{...e[12],value:{layerIndex:e[3]}}))],f=!0)},p(e,[s]){const i={};256&s&&(i.active=e[8]),1&s&&(i.label=e[0].label),1048608&s&&(i.$$scope={dirty:s,ctx:e}),!l&&16&s&&(l=!0,i.iconIndicator=e[4],function(e){H.push(e)}((()=>l=!1))),r.$set(i),e[4]?k?(k.p(e,s),16&s&&ne(k,1)):(k=Vn(e),k.c(),ne(k,1),k.m(n,null)):k&&(ee(),re(k,1,1,(()=>{k=null})),te()),E&&E.p&&1048576&s&&d(E,L,e,e[20],s,null,null),c&&o(c.update)&&8&s&&c.update.call(null,{type:"flipPalette",value:{layerIndex:e[3]}}),p&&o(p.update)&&8&s&&p.update.call(null,{...e[12],value:{layerIndex:e[3]}}),128&s&&S(t,"over",e[7]),256&s&&S(t,"active",e[8])},i(e){h||(ne(r.$$.fragment,e),ne(k),ne(E,e),h=!0)},o(e){re(r.$$.fragment,e),re(k),re(E,e),h=!1},d(n){n&&v(t),e[16](null),pe(r),k&&k.d(),E&&E.d(n),f=!1,s(x)}}}function rr(t,n,r){let s,o,l=e,a=()=>(l(),l=i(d,(e=>r(13,o=e))),d);t.$$.on_destroy.push((()=>l()));let{$$slots:c={},$$scope:u}=n,{source:p}=n,{activeLayer:d}=n;a();let h,f,{showEditButtons:g=!0}=n,{layerIndex:$}=n,m=!0;const v=D();let x;const y={over:e=>r(7,x=!0),leave:e=>r(7,x=!1),drop:({e:e,value:t})=>{r(7,x=!1);const n=e.dataTransfer.getData("flipPalette");if(n){const e=Number(JSON.parse(n).layerIndex);v("swapLayers",{to:e,from:t.layerIndex})}}};return t.$$set=e=>{"source"in e&&r(0,p=e.source),"activeLayer"in e&&a(r(1,d=e.activeLayer)),"showEditButtons"in e&&r(2,g=e.showEditButtons),"layerIndex"in e&&r(3,$=e.layerIndex),"$$scope"in e&&r(20,u=e.$$scope)},t.$$.update=()=>{1&t.$$.dirty&&r(5,h=Fn(p.label,15,"",((e,t)=>e!=t?e+"...":e))),8193&t.$$.dirty&&r(8,s=p==o)},[p,d,g,$,m,h,f,x,s,v,e=>{e.ctrlKey||e.altKey?v("remove",p):console.warn("Dispatch tooltip to let user know he has to hold down ctr or alt key")},e=>v("clone",p),y,o,c,function(e){m=e,r(4,m)},function(e){j[e?"unshift":"push"]((()=>{f=e,r(6,f)}))},e=>v("makeActive",p),e=>v("updateLabel",{source:p,value:e.detail}),e=>f.edit(e),u]}class sr extends he{constructor(e){super(),de(this,e,rr,nr,l,{source:0,activeLayer:1,showEditButtons:2,layerIndex:3})}}function or(e){let t;const n=e[6].default,r=u(n,e,e[7],null);return{c(){r&&r.c()},m(e,n){r&&r.m(e,n),t=!0},p(e,t){r&&r.p&&128&t&&d(r,n,e,e[7],t,null,null)},i(e){t||(ne(r,e),t=!0)},o(e){re(r,e),t=!1},d(e){r&&r.d(e)}}}function lr(e){let n,r;const s=[e[5]];let o={$$slots:{default:[or]},$$scope:{ctx:e}};for(let e=0;e<s.length;e+=1)o=t(o,s[e]);return n=new sr({props:o}),n.$on("swapLayers",e[4]),n.$on("remove",e[0]),n.$on("updateLabel",e[1]),n.$on("makeActive",e[2]),n.$on("clone",e[3]),{c(){ce(n.$$.fragment)},m(e,t){ue(n,e,t),r=!0},p(e,[t]){const r=32&t?ie(s,[ae(e[5])]):{};128&t&&(r.$$scope={dirty:t,ctx:e}),n.$set(r)},i(e){r||(ne(n.$$.fragment,e),r=!0)},o(e){re(n.$$.fragment,e),r=!1},d(e){pe(n,e)}}}function ir(e,n,r){const s=[];let o=f(n,s),{$$slots:l={},$$scope:i}=n;return e.$$set=e=>{n=t(t({},n),h(e)),r(5,o=f(n,s)),"$$scope"in e&&r(7,i=e.$$scope)},[e=>Le.execute("spritesheet_remove",e.detail),e=>Le.execute("spritesheet_update_layer_label",{source:e.detail.source,label:e.detail.value}),e=>Le.execute("spritesheet_make_layer_active",e.detail),e=>Le.execute("spritesheet_clone_layer",e.detail),e=>Le.execute("spritesheet_swap_layers",e.detail),o,l,i]}class ar extends he{constructor(e){super(),de(this,e,ir,lr,l,{})}}function cr(t){let n;return{c(){n=y("div"),I(n,"class","canvas-wrapper svelte-84zv5e")},m(e,r){m(e,n,r),t[2](n)},p:e,i:e,o:e,d(e){e&&v(n),t[2](null)}}}function ur(e,t,n){let r,{source:s}=t;return R((()=>{r.appendChild(s.element)})),e.$$set=e=>{"source"in e&&n(1,s=e.source)},[r,s,function(e){j[e?"unshift":"push"]((()=>{r=e,n(0,r)}))}]}class pr extends he{constructor(e){super(),de(this,e,ur,cr,l,{source:1})}}function dr(e,t,n){const r=e.slice();return r[4]=t[n],r[6]=n,r}function hr(t){let n;return{c(){n=y("div"),n.textContent="No spritesheets",I(n,"class","center svelte-1pdum4b")},m(e,t){m(e,n,t)},p:e,i:e,o:e,d(e){e&&v(n)}}}function fr(e){let t,n,r=[],s=new Map,o=e[0];const l=e=>e[4].uuid;for(let t=0;t<o.length;t+=1){let n=dr(e,o,t),i=l(n);s.set(i,r[t]=$r(i,n))}return{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=k()},m(e,s){for(let t=0;t<r.length;t+=1)r[t].m(e,s);m(e,t,s),n=!0},p(e,n){3&n&&(o=e[0],ee(),r=le(r,n,l,1,e,o,s,t.parentNode,oe,$r,t,dr),te())},i(e){if(!n){for(let e=0;e<o.length;e+=1)ne(r[e]);n=!0}},o(e){for(let e=0;e<r.length;e+=1)re(r[e]);n=!1},d(e){for(let t=0;t<r.length;t+=1)r[t].d(e);e&&v(t)}}}function gr(e){let t,n,r;return t=new pr({props:{source:e[4]}}),{c(){ce(t.$$.fragment),n=_()},m(e,s){ue(t,e,s),m(e,n,s),r=!0},p(e,n){const r={};1&n&&(r.source=e[4]),t.$set(r)},i(e){r||(ne(t.$$.fragment,e),r=!0)},o(e){re(t.$$.fragment,e),r=!1},d(e){pe(t,e),e&&v(n)}}}function $r(e,t){let n,r,s;return r=new ar({props:{source:t[4],activeLayer:t[1],layerIndex:t[6],$$slots:{default:[gr]},$$scope:{ctx:t}}}),{key:e,first:null,c(){n=k(),ce(r.$$.fragment),this.first=n},m(e,t){m(e,n,t),ue(r,e,t),s=!0},p(e,n){t=e;const s={};1&n&&(s.source=t[4]),1&n&&(s.layerIndex=t[6]),129&n&&(s.$$scope={dirty:n,ctx:t}),r.$set(s)},i(e){s||(ne(r.$$.fragment,e),s=!0)},o(e){re(r.$$.fragment,e),s=!1},d(e){e&&v(n),pe(r,e)}}}function mr(e){let t;return{c(){t=b("Create spritesheet")},m(e,n){m(e,t,n)},d(e){e&&v(t)}}}function vr(e){let t,n,r,s,o,l,i,a;const c=[fr,hr],u=[];function p(e,t){return e[0].length?0:1}return r=p(e),s=u[r]=c[r](e),i=new jn({props:{$$slots:{default:[mr]},$$scope:{ctx:e}}}),i.$on("click",e[3]),{c(){t=y("div"),n=y("div"),s.c(),o=_(),l=y("div"),ce(i.$$.fragment),I(n,"class","layers svelte-1pdum4b"),I(l,"class","center svelte-1pdum4b"),I(t,"class","palette-layer svelte-1pdum4b")},m(e,s){m(e,t,s),$(t,n),u[r].m(n,null),$(t,o),$(t,l),ue(i,l,null),a=!0},p(e,[t]){let o=r;r=p(e),r===o?u[r].p(e,t):(ee(),re(u[o],1,1,(()=>{u[o]=null})),te(),s=u[r],s?s.p(e,t):(s=u[r]=c[r](e),s.c()),ne(s,1),s.m(n,null));const l={};128&t&&(l.$$scope={dirty:t,ctx:e}),i.$set(l)},i(e){a||(ne(s),ne(i.$$.fragment,e),a=!0)},o(e){re(s),re(i.$$.fragment,e),a=!1},d(e){e&&v(t),u[r].d(),pe(i)}}}function xr(e,t,n){let r;const{activeLayer:s,layers:o}=Qe.stores;c(e,o,(e=>n(0,r=e)));return[r,s,o,e=>Le.execute("spritesheet_create")]}class yr extends he{constructor(e){super(),de(this,e,xr,vr,l,{})}}function wr(e){let t;const n=e[6].default,r=u(n,e,e[7],null);return{c(){r&&r.c()},m(e,n){r&&r.m(e,n),t=!0},p(e,t){r&&r.p&&128&t&&d(r,n,e,e[7],t,null,null)},i(e){t||(ne(r,e),t=!0)},o(e){re(r,e),t=!1},d(e){r&&r.d(e)}}}function br(e){let n,r;const s=[e[5]];let o={$$slots:{default:[wr]},$$scope:{ctx:e}};for(let e=0;e<s.length;e+=1)o=t(o,s[e]);return n=new sr({props:o}),n.$on("swapLayers",e[4]),n.$on("remove",e[0]),n.$on("updateLabel",e[1]),n.$on("makeActive",e[2]),n.$on("clone",e[3]),{c(){ce(n.$$.fragment)},m(e,t){ue(n,e,t),r=!0},p(e,[t]){const r=32&t?ie(s,[ae(e[5])]):{};128&t&&(r.$$scope={dirty:t,ctx:e}),n.$set(r)},i(e){r||(ne(n.$$.fragment,e),r=!0)},o(e){re(n.$$.fragment,e),r=!1},d(e){pe(n,e)}}}function _r(e,n,r){const s=[];let o=f(n,s),{$$slots:l={},$$scope:i}=n;return e.$$set=e=>{n=t(t({},n),h(e)),r(5,o=f(n,s)),"$$scope"in e&&r(7,i=e.$$scope)},[e=>Le.execute("palette_remove",e.detail),e=>Le.execute("palette_update_layer_label",{source:e.detail.source,label:e.detail.value}),e=>Le.execute("palette_make_layer_active",e.detail),e=>Le.execute("palette_clone_layer",e.detail),e=>Le.execute("palette_swap_layers",e.detail),o,l,i]}class kr extends he{constructor(e){super(),de(this,e,_r,br,l,{})}}function Lr(e){let t,n,r,l,i,a;const c=e[10].default,p=u(c,e,e[9],null),h=p||function(e){let t,n;return{c(){t=b("0x"),n=b(e[1])},m(e,r){m(e,t,r),m(e,n,r)},p(e,t){2&t&&A(n,e[1])},d(e){e&&v(t),e&&v(n)}}}(e);return{c(){t=y("div"),n=y("span"),h&&h.c(),C(n,"pointer-events","none"),I(n,"class","svelte-1j057y7"),I(t,"class","color svelte-1j057y7"),I(t,"data-hex",e[1]),C(t,"--rgb","rgb("+e[0].join(",")+")"),S(t,"active",e[5]&&e[4]==e[6]&&e[3]==Ye.layerIndexFromSource(e[5]))},m(s,o){m(s,t,o),$(t,n),h&&h.m(n,null),l=!0,i||(a=[L(t,"click",e[11]),g(r=Wn.call(null,t,{type:e[2],value:{rgb:e[0],hex:e[1],type:e[2],layerIndex:e[3],colorIndex:e[4]}}))],i=!0)},p(e,[n]){p?p.p&&512&n&&d(p,c,e,e[9],n,null,null):h&&h.p&&2&n&&h.p(e,n),(!l||2&n)&&I(t,"data-hex",e[1]),(!l||1&n)&&C(t,"--rgb","rgb("+e[0].join(",")+")"),r&&o(r.update)&&31&n&&r.update.call(null,{type:e[2],value:{rgb:e[0],hex:e[1],type:e[2],layerIndex:e[3],colorIndex:e[4]}}),120&n&&S(t,"active",e[5]&&e[4]==e[6]&&e[3]==Ye.layerIndexFromSource(e[5]))},i(e){l||(ne(h,e),l=!0)},o(e){re(h,e),l=!1},d(e){e&&v(t),h&&h.d(e),i=!1,s(a)}}}function Er(e,t,n){let r,s,{$$slots:o={},$$scope:l}=t,{rgb:i}=t,{hex:a}=t,{type:u}=t,{layerIndex:p}=t,{colorIndex:d}=t;const{selectedColor:h,activeLayer:f}=Ye.stores;return c(e,h,(e=>n(6,s=e))),c(e,f,(e=>n(5,r=e))),e.$$set=e=>{"rgb"in e&&n(0,i=e.rgb),"hex"in e&&n(1,a=e.hex),"type"in e&&n(2,u=e.type),"layerIndex"in e&&n(3,p=e.layerIndex),"colorIndex"in e&&n(4,d=e.colorIndex),"$$scope"in e&&n(9,l=e.$$scope)},[i,a,u,p,d,r,s,h,f,l,o,function(t){B(e,t)}]}class Ir extends he{constructor(e){super(),de(this,e,Er,Lr,l,{rgb:0,hex:1,type:2,layerIndex:3,colorIndex:4})}}function zr(e,t,n){const r=e.slice();return r[7]=t[n],r[9]=n,r}function Ar(e,t,n){const r=e.slice();return r[10]=t[n],r[12]=n,r}function Cr(t){let n;return{c(){n=y("div"),n.textContent="No palettes",I(n,"class","center svelte-njkqod")},m(e,t){m(e,n,t)},p:e,i:e,o:e,d(e){e&&v(n)}}}function Sr(e){let t,n,r=e[1],s=[];for(let t=0;t<r.length;t+=1)s[t]=Rr(zr(e,r,t));const o=e=>re(s[e],1,1,(()=>{s[e]=null}));return{c(){for(let e=0;e<s.length;e+=1)s[e].c();t=k()},m(e,r){for(let t=0;t<s.length;t+=1)s[t].m(e,r);m(e,t,r),n=!0},p(e,n){if(23&n){let l;for(r=e[1],l=0;l<r.length;l+=1){const o=zr(e,r,l);s[l]?(s[l].p(o,n),ne(s[l],1)):(s[l]=Rr(o),s[l].c(),ne(s[l],1),s[l].m(t.parentNode,t))}for(ee(),l=r.length;l<s.length;l+=1)o(l);te()}},i(e){if(!n){for(let e=0;e<r.length;e+=1)ne(s[e]);n=!0}},o(e){s=s.filter(Boolean);for(let e=0;e<s.length;e+=1)re(s[e]);n=!1},d(e){x(s,e),e&&v(t)}}}function Mr(e){let t,n,r=e[10].hex+"";return{c(){t=b("0x"),n=b(r)},m(e,r){m(e,t,r),m(e,n,r)},p(e,t){2&t&&r!==(r=e[10].hex+"")&&A(n,r)},d(e){e&&v(t),e&&v(n)}}}function Tr(e,t){let n,r,s,l,i,a,c;return r=new Ir({props:{hex:t[10].hex,rgb:t[10].rgb,layerIndex:t[9],colorIndex:t[12],type:"swap",$$slots:{default:[Mr]},$$scope:{ctx:t}}}),{key:e,first:null,c(){n=y("li"),ce(r.$$.fragment),s=_(),I(n,"class","svelte-njkqod"),this.first=n},m(e,o){m(e,n,o),ue(r,n,null),$(n,s),i=!0,a||(c=g(l=Yn.call(null,n,{...t[4],value:{layerIndex:t[9],colorIndex:t[12]}})),a=!0)},p(e,n){t=e;const s={};2&n&&(s.hex=t[10].hex),2&n&&(s.rgb=t[10].rgb),2&n&&(s.colorIndex=t[12]),8194&n&&(s.$$scope={dirty:n,ctx:t}),r.$set(s),l&&o(l.update)&&2&n&&l.update.call(null,{...t[4],value:{layerIndex:t[9],colorIndex:t[12]}})},i(e){i||(ne(r.$$.fragment,e),i=!0)},o(e){re(r.$$.fragment,e),i=!1},d(e){e&&v(n),pe(r),a=!1,c()}}}function Pr(e){let t,n,r,s=[],o=new Map,l=e[7].colors;const i=e=>e[12];for(let t=0;t<l.length;t+=1){let n=Ar(e,l,t),r=i(n);o.set(r,s[t]=Tr(r,n))}return{c(){t=y("ul");for(let e=0;e<s.length;e+=1)s[e].c();n=_(),I(t,"class","svelte-njkqod")},m(e,o){m(e,t,o);for(let e=0;e<s.length;e+=1)s[e].m(t,null);m(e,n,o),r=!0},p(e,n){18&n&&(l=e[7].colors,ee(),s=le(s,n,i,1,e,l,o,t,oe,Tr,null,Ar),te())},i(e){if(!r){for(let e=0;e<l.length;e+=1)ne(s[e]);r=!0}},o(e){for(let e=0;e<s.length;e+=1)re(s[e]);r=!1},d(e){e&&v(t);for(let e=0;e<s.length;e+=1)s[e].d();e&&v(n)}}}function Rr(e){let t,n;return t=new kr({props:{source:e[7],showEditButtons:e[0],activeLayer:e[2],layerIndex:e[9],$$slots:{default:[Pr]},$$scope:{ctx:e}}}),{c(){ce(t.$$.fragment)},m(e,r){ue(t,e,r),n=!0},p(e,n){const r={};2&n&&(r.source=e[7]),1&n&&(r.showEditButtons=e[0]),8194&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){re(t.$$.fragment,e),n=!1},d(e){pe(t,e)}}}function Or(e){let t,n;return t=new jn({props:{$$slots:{default:[Dr]},$$scope:{ctx:e}}}),t.$on("click",e[5]),{c(){ce(t.$$.fragment)},m(e,r){ue(t,e,r),n=!0},p(e,n){const r={};8192&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){re(t.$$.fragment,e),n=!1},d(e){pe(t,e)}}}function Dr(e){let t;return{c(){t=b("Create palette")},m(e,n){m(e,t,n)},d(e){e&&v(t)}}}function Br(e){let t,n,r,s,o,l,i;const a=[Sr,Cr],c=[];function u(e,t){return e[1]&&e[1].length?0:1}r=u(e),s=c[r]=a[r](e);let p=e[0]&&Or(e);return{c(){t=y("div"),n=y("div"),s.c(),o=_(),l=y("div"),p&&p.c(),I(n,"class","layers svelte-njkqod"),I(l,"class","center svelte-njkqod"),I(t,"class","palette-layer svelte-njkqod")},m(e,s){m(e,t,s),$(t,n),c[r].m(n,null),$(t,o),$(t,l),p&&p.m(l,null),i=!0},p(e,[t]){let o=r;r=u(e),r===o?c[r].p(e,t):(ee(),re(c[o],1,1,(()=>{c[o]=null})),te(),s=c[r],s?s.p(e,t):(s=c[r]=a[r](e),s.c()),ne(s,1),s.m(n,null)),e[0]?p?(p.p(e,t),1&t&&ne(p,1)):(p=Or(e),p.c(),ne(p,1),p.m(l,null)):p&&(ee(),re(p,1,1,(()=>{p=null})),te())},i(e){i||(ne(s),ne(p),i=!0)},o(e){re(s),re(p),i=!1},d(e){e&&v(t),c[r].d(),p&&p.d()}}}function Nr(e,t,n){let r,{showEditButtons:s=!0}=t;const{activeLayer:o,layers:l}=Ye.stores;c(e,l,(e=>n(1,r=e)));const i={over:e=>!0,leave:e=>!1,drop:({e:e,value:t})=>{const n=e.dataTransfer.getData("swap");n&&l.swapColors({...JSON.parse(n),to:{...t}});const r=e.dataTransfer.getData("replace");r&&l.replaceColor({...JSON.parse(r),...t})}};return e.$$set=e=>{"showEditButtons"in e&&n(0,s=e.showEditButtons)},[s,r,o,l,i,e=>Le.execute("palette_create")]}class jr extends he{constructor(e){super(),de(this,e,Nr,Br,l,{showEditButtons:0})}}var Fr=(e,t)=>{const n=n=>{e.contains(n.target)||(n.preventDefault(),t.call(null))};return window.addEventListener("click",n),{destroy(){window.removeEventListener("click",n)}}};function Hr(e){let t,n,r,s;const o=e[1].default,l=u(o,e,e[0],null);return{c(){t=y("button"),l&&l.c(),I(t,"class","svelte-8gzkl6")},m(o,i){m(o,t,i),l&&l.m(t,null),n=!0,r||(s=L(t,"click",e[2]),r=!0)},p(e,[t]){l&&l.p&&1&t&&d(l,o,e,e[0],t,null,null)},i(e){n||(ne(l,e),n=!0)},o(e){re(l,e),n=!1},d(e){e&&v(t),l&&l.d(e),r=!1,s()}}}function qr(e,t,n){let{$$slots:r={},$$scope:s}=t;return e.$$set=e=>{"$$scope"in e&&n(0,s=e.$$scope)},[s,r,function(t){B(e,t)}]}class Kr extends he{constructor(e){super(),de(this,e,qr,Hr,l,{})}}const Gr=e=>({}),Jr=e=>({}),Ur=e=>({}),Wr=e=>({});function Yr(e){let t;const n=e[1].icon,r=u(n,e,e[4],Wr);return{c(){r&&r.c()},m(e,n){r&&r.m(e,n),t=!0},p(e,t){r&&r.p&&16&t&&d(r,n,e,e[4],t,Ur,Wr)},i(e){t||(ne(r,e),t=!0)},o(e){re(r,e),t=!1},d(e){r&&r.d(e)}}}function Xr(e){let t,n,r,s,l,i,a,c,p;const h=e[1].default,f=u(h,e,e[4],null);r=new Kr({props:{$$slots:{default:[Yr]},$$scope:{ctx:e}}}),r.$on("click",e[2]);const x=e[1].list,w=u(x,e,e[4],Jr);return{c(){t=y("div"),f&&f.c(),n=_(),ce(r.$$.fragment),s=_(),l=y("div"),w&&w.c(),I(l,"class","dropdown svelte-1rwcx4c"),I(t,"class","select-button svelte-1rwcx4c"),S(t,"active",e[0])},m(o,u){m(o,t,u),f&&f.m(t,null),$(t,n),ue(r,t,null),$(t,s),$(t,l),w&&w.m(l,null),a=!0,c||(p=g(i=Fr.call(null,t,e[3])),c=!0)},p(e,[n]){f&&f.p&&16&n&&d(f,h,e,e[4],n,null,null);const s={};16&n&&(s.$$scope={dirty:n,ctx:e}),r.$set(s),w&&w.p&&16&n&&d(w,x,e,e[4],n,Gr,Jr),i&&o(i.update)&&1&n&&i.update.call(null,e[3]),1&n&&S(t,"active",e[0])},i(e){a||(ne(f,e),ne(r.$$.fragment,e),ne(w,e),a=!0)},o(e){re(f,e),re(r.$$.fragment,e),re(w,e),a=!1},d(e){e&&v(t),f&&f.d(e),pe(r),w&&w.d(e),c=!1,p()}}}function Vr(e,t,n){let{$$slots:r={},$$scope:s}=t,o=!1;return e.$$set=e=>{"$$scope"in e&&n(4,s=e.$$scope)},[o,r,e=>n(0,o=!o),e=>n(0,o=!1),s]}class Zr extends he{constructor(e){super(),de(this,e,Vr,Xr,l,{})}}function Qr(e){let t,n,r,s,o,l,i,a;const c=e[2].default,p=u(c,e,e[1],null);return{c(){t=y("div"),n=y("div"),p&&p.c(),r=_(),s=y("div"),o=y("button"),o.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="13" height="13" viewBox="0 0 24 24" class="svelte-1ux55nb"><path d="M10.573 3.021h7.427v-3.021l6 5.39-6 5.61v-3h-7.427c-3.071 0-5.561 2.356-5.561 5.427 0 3.071 2.489 5.573 5.561 5.573h7.427v5h-7.427c-5.84 0-10.573-4.734-10.573-10.573s4.733-10.406 10.573-10.406z"></path></svg>',I(n,"class","group svelte-1ux55nb"),I(o,"class","svelte-1ux55nb"),I(s,"class","group svelte-1ux55nb"),I(t,"id","buttons"),I(t,"class","svelte-1ux55nb")},m(c,u){m(c,t,u),$(t,n),p&&p.m(n,null),$(t,r),$(t,s),$(s,o),l=!0,i||(a=L(o,"click",e[3]),i=!0)},p(e,[t]){p&&p.p&&2&t&&d(p,c,e,e[1],t,null,null)},i(e){l||(ne(p,e),l=!0)},o(e){re(p,e),l=!1},d(e){e&&v(t),p&&p.d(e),i=!1,a()}}}function es(e,t,n){let{$$slots:r={},$$scope:s}=t;const o=D();return e.$$set=e=>{"$$scope"in e&&n(1,s=e.$$scope)},[o,s,r,e=>o("centerArtboard")]}class ts extends he{constructor(e){super(),de(this,e,es,Qr,l,{})}}const ns=e=>({}),rs=e=>({slot:"list"}),ss=e=>({}),os=e=>({slot:"icon"});function ls(e){let t;const n=e[0].default,r=u(n,e,e[8],os),s=r||function(e){let t,n;return{c(){t=w("svg"),n=w("path"),I(n,"d","M24 13.616v-3.232c-1.651-.587-2.694-.752-3.219-2.019v-.001c-.527-1.271.1-2.134.847-3.707l-2.285-2.285c-1.561.742-2.433 1.375-3.707.847h-.001c-1.269-.526-1.435-1.576-2.019-3.219h-3.232c-.582 1.635-.749 2.692-2.019 3.219h-.001c-1.271.528-2.132-.098-3.707-.847l-2.285 2.285c.745 1.568 1.375 2.434.847 3.707-.527 1.271-1.584 1.438-3.219 2.02v3.232c1.632.58 2.692.749 3.219 2.019.53 1.282-.114 2.166-.847 3.707l2.285 2.286c1.562-.743 2.434-1.375 3.707-.847h.001c1.27.526 1.436 1.579 2.019 3.219h3.232c.582-1.636.75-2.69 2.027-3.222h.001c1.262-.524 2.12.101 3.698.851l2.285-2.286c-.744-1.563-1.375-2.433-.848-3.706.527-1.271 1.588-1.44 3.221-2.021zm-12 2.384c-2.209 0-4-1.791-4-4s1.791-4 4-4 4 1.791 4 4-1.791 4-4 4z"),I(t,"xmlns","http://www.w3.org/2000/svg"),I(t,"width","13"),I(t,"height","13"),I(t,"viewBox","0 0 24 24")},m(e,r){m(e,t,r),$(t,n)},d(e){e&&v(t)}}}();return{c(){s&&s.c()},m(e,n){s&&s.m(e,n),t=!0},p(e,t){r&&r.p&&256&t&&d(r,n,e,e[8],t,ss,os)},i(e){t||(ne(s,e),t=!0)},o(e){re(s,e),t=!1},d(e){s&&s.d(e)}}}function is(e){let t;return{c(){t=b("Import spritesheet")},m(e,n){m(e,t,n)},d(e){e&&v(t)}}}function as(e){let t;return{c(){t=b("Import CHR")},m(e,n){m(e,t,n)},d(e){e&&v(t)}}}function cs(e){let t;return{c(){t=b("Export spritesheet")},m(e,n){m(e,t,n)},d(e){e&&v(t)}}}function us(e){let t;return{c(){t=b("Export CHR")},m(e,n){m(e,t,n)},d(e){e&&v(t)}}}function ps(e){let t;return{c(){t=b("Export PNG")},m(e,n){m(e,t,n)},d(e){e&&v(t)}}}function ds(e){let t;return{c(){t=b("Clear all")},m(e,n){m(e,t,n)},d(e){e&&v(t)}}}function hs(e){let t;const n=e[0].default,r=u(n,e,e[8],rs),s=r||function(e){let t,n,r,s,o,l,i,a,c,u,p,d,h,f,g;return n=new jn({props:{$$slots:{default:[is]},$$scope:{ctx:e}}}),n.$on("click",e[1]),s=new jn({props:{$$slots:{default:[as]},$$scope:{ctx:e}}}),s.$on("click",e[2]),i=new jn({props:{$$slots:{default:[cs]},$$scope:{ctx:e}}}),i.$on("click",e[3]),c=new jn({props:{$$slots:{default:[us]},$$scope:{ctx:e}}}),c.$on("click",e[4]),p=new jn({props:{$$slots:{default:[ps]},$$scope:{ctx:e}}}),p.$on("click",e[5]),f=new jn({props:{variant:"danger",$$slots:{default:[ds]},$$scope:{ctx:e}}}),f.$on("click",e[6]),{c(){t=y("div"),ce(n.$$.fragment),r=_(),ce(s.$$.fragment),o=_(),l=y("div"),ce(i.$$.fragment),a=_(),ce(c.$$.fragment),u=_(),ce(p.$$.fragment),d=_(),h=y("div"),ce(f.$$.fragment)},m(e,v){m(e,t,v),ue(n,t,null),$(t,r),ue(s,t,null),m(e,o,v),m(e,l,v),ue(i,l,null),$(l,a),ue(c,l,null),$(l,u),ue(p,l,null),m(e,d,v),m(e,h,v),ue(f,h,null),g=!0},p(e,t){const r={};256&t&&(r.$$scope={dirty:t,ctx:e}),n.$set(r);const o={};256&t&&(o.$$scope={dirty:t,ctx:e}),s.$set(o);const l={};256&t&&(l.$$scope={dirty:t,ctx:e}),i.$set(l);const a={};256&t&&(a.$$scope={dirty:t,ctx:e}),c.$set(a);const u={};256&t&&(u.$$scope={dirty:t,ctx:e}),p.$set(u);const d={};256&t&&(d.$$scope={dirty:t,ctx:e}),f.$set(d)},i(e){g||(ne(n.$$.fragment,e),ne(s.$$.fragment,e),ne(i.$$.fragment,e),ne(c.$$.fragment,e),ne(p.$$.fragment,e),ne(f.$$.fragment,e),g=!0)},o(e){re(n.$$.fragment,e),re(s.$$.fragment,e),re(i.$$.fragment,e),re(c.$$.fragment,e),re(p.$$.fragment,e),re(f.$$.fragment,e),g=!1},d(e){e&&v(t),pe(n),pe(s),e&&v(o),e&&v(l),pe(i),pe(c),pe(p),e&&v(d),e&&v(h),pe(f)}}}(e);return{c(){s&&s.c()},m(e,n){s&&s.m(e,n),t=!0},p(e,t){r&&r.p&&256&t&&d(r,n,e,e[8],t,ns,rs)},i(e){t||(ne(s,e),t=!0)},o(e){re(s,e),t=!1},d(e){s&&s.d(e)}}}function fs(t){let n;return{c(){n=_()},m(e,t){m(e,n,t)},p:e,i:e,o:e,d(e){e&&v(n)}}}function gs(e){let t,n;return t=new Zr({props:{$$slots:{default:[fs],list:[hs],icon:[ls]},$$scope:{ctx:e}}}),{c(){ce(t.$$.fragment)},m(e,r){ue(t,e,r),n=!0},p(e,n){const r={};256&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){re(t.$$.fragment,e),n=!1},d(e){pe(t,e)}}}function $s(e){let t,n;return t=new ts({props:{$$slots:{default:[gs]},$$scope:{ctx:e}}}),t.$on("centerArtboard",e[7]),{c(){ce(t.$$.fragment)},m(e,r){ue(t,e,r),n=!0},p(e,[n]){const r={};256&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){re(t.$$.fragment,e),n=!1},d(e){pe(t,e)}}}function ms(e,t,n){let{$$slots:r={},$$scope:s}=t;return e.$$set=e=>{"$$scope"in e&&n(8,s=e.$$scope)},[r,e=>Le.execute("spritesheet_import"),e=>Le.execute("spritesheet_import_chr"),e=>Le.execute("spritesheet_export"),e=>Le.execute("spritesheet_export_chr"),e=>Le.execute("spritesheet_export_png"),e=>Le.execute("spritesheet_clear"),function(t){B(e,t)},s]}class vs extends he{constructor(e){super(),de(this,e,ms,$s,l,{})}}function xs(t){let n;return{c(){n=b("Please select a spritesheet and palette")},m(e,t){m(e,n,t)},p:e,i:e,o:e,d(e){e&&v(n)}}}function ys(e){let t,n,r;const s=e[9].default,o=u(s,e,e[8],null);return{c(){t=y("div"),n=y("canvas"),o&&o.c(),I(n,"width",128),I(n,"height",128),I(n,"class","svelte-1sxiybl"),C(t,"--zoom",e[0]),I(t,"class","svelte-1sxiybl")},m(s,l){m(s,t,l),$(t,n),o&&o.m(n,null),e[10](n),r=!0},p(e,n){o&&o.p&&256&n&&d(o,s,e,e[8],n,null,null),(!r||1&n)&&C(t,"--zoom",e[0])},i(e){r||(ne(o,e),r=!0)},o(e){re(o,e),r=!1},d(n){n&&v(t),o&&o.d(n),e[10](null)}}}function ws(e){let t,n,r,s;const o=[ys,xs],l=[];function i(e,t){return e[2]&&e[3].length&&e[4]?0:1}return t=i(e),n=l[t]=o[t](e),{c(){n.c(),r=k()},m(e,n){l[t].m(e,n),m(e,r,n),s=!0},p(e,[s]){let a=t;t=i(e),t===a?l[t].p(e,s):(ee(),re(l[a],1,1,(()=>{l[a]=null})),te(),n=l[t],n?n.p(e,s):(n=l[t]=o[t](e),n.c()),ne(n,1),n.m(r.parentNode,r))},i(e){s||(ne(n),s=!0)},o(e){re(n),s=!1},d(e){l[t].d(e),e&&v(r)}}}function bs(e,t,n){let r,s,o,{$$slots:l={},$$scope:i}=t,{zoom:a}=t;const{activeLayer:u,layers:p,width:d,height:h}=Qe.stores;c(e,u,(e=>n(2,r=e))),c(e,p,(e=>n(3,s=e)));const f=Ye.stores.activeLayer;let g;c(e,f,(e=>n(4,o=e)));let $=new at({width:d,height:h});return $.on("primary",(e=>((...e)=>pt(ut.activeTool.get()?.primary,...e))(e))),$.on("secondary",(e=>((...e)=>pt(ut.activeTool.get()?.secondary,...e))(e))),$.on("move",(e=>((...e)=>pt(ut.activeTool.get()?.move,...e))(e))),$.on("mouseup",(e=>((...e)=>pt(ut.activeTool.get()?.mouseup,...e))(e))),R((()=>()=>{$&&$.destroy()})),e.$$set=e=>{"zoom"in e&&n(0,a=e.zoom),"$$scope"in e&&n(8,i=e.$$scope)},e.$$.update=()=>{2&e.$$.dirty&&g&&$.defineCanvas(g)},[a,g,r,s,o,u,p,f,i,l,function(e){j[e?"unshift":"push"]((()=>{g=e,n(1,g)}))}]}class _s extends he{constructor(e){super(),de(this,e,bs,ws,l,{zoom:0})}}function ks(e){let t,n;return t=new _s({props:{zoom:e[0]}}),{c(){ce(t.$$.fragment)},m(e,r){ue(t,e,r),n=!0},p(e,[n]){const r={};1&n&&(r.zoom=e[0]),t.$set(r)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){re(t.$$.fragment,e),n=!1},d(e){pe(t,e)}}}function Ls(e,t,n){let{zoom:r}=t;return e.$$set=e=>{"zoom"in e&&n(0,r=e.zoom)},[r]}class Es extends he{constructor(e){super(),de(this,e,Ls,ks,l,{zoom:0})}}function Is(e){let t,n;return t=new Es({props:{zoom:e[0]}}),{c(){ce(t.$$.fragment)},m(e,r){ue(t,e,r),n=!0},p(e,n){const r={};1&n&&(r.zoom=e[0]),t.$set(r)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){re(t.$$.fragment,e),n=!1},d(e){pe(t,e)}}}function zs(e){let t,n,r,s,o,l,i,a,c,u,p,d,h,f,g,x,w;return o=new vs({}),o.$on("centerArtboard",gn),i=new mn({props:{$$slots:{default:[Is]},$$scope:{ctx:e}}}),i.$on("artboardScrollEvent",e[1]),u=new Dn({}),h=new yr({}),x=new jr({props:{showEditButtons:!1}}),{c(){t=y("section"),n=y("div"),r=_(),s=y("div"),ce(o.$$.fragment),l=_(),ce(i.$$.fragment),a=_(),c=y("section"),ce(u.$$.fragment),p=_(),d=y("section"),ce(h.$$.fragment),f=_(),g=y("section"),ce(x.$$.fragment),I(s,"class","inner-artboard svelte-18f6yhk"),I(t,"class","main-artboard svelte-18f6yhk"),I(c,"class","toolbar-layer svelte-18f6yhk"),I(d,"class","spritesheets-layer svelte-18f6yhk"),I(g,"class","palettes-layer svelte-18f6yhk")},m(e,v){m(e,t,v),$(t,n),$(t,r),$(t,s),ue(o,s,null),$(s,l),ue(i,s,null),m(e,a,v),m(e,c,v),ue(u,c,null),m(e,p,v),m(e,d,v),ue(h,d,null),m(e,f,v),m(e,g,v),ue(x,g,null),w=!0},p(e,[t]){const n={};5&t&&(n.$$scope={dirty:t,ctx:e}),i.$set(n)},i(e){w||(ne(o.$$.fragment,e),ne(i.$$.fragment,e),ne(u.$$.fragment,e),ne(h.$$.fragment,e),ne(x.$$.fragment,e),w=!0)},o(e){re(o.$$.fragment,e),re(i.$$.fragment,e),re(u.$$.fragment,e),re(h.$$.fragment,e),re(x.$$.fragment,e),w=!1},d(e){e&&v(t),pe(o),pe(i),e&&v(a),e&&v(c),pe(u),e&&v(p),e&&v(d),pe(h),e&&v(f),e&&v(g),pe(x)}}}function As(e,t,n){let r=4;return[r,e=>{n(0,r=Math.max(1,r+(r-e.detail.deltaY>0?1:-1)))}]}class Cs extends he{constructor(e){super(),de(this,e,As,zs,l,{})}}function Ss(e){let t,n;return{c(){t=y("div"),n=b(e[0]),I(t,"class","label svelte-j9cd0w")},m(e,r){m(e,t,r),$(t,n)},p(e,t){1&t&&A(n,e[0])},d(e){e&&v(t)}}}function Ms(e){let t,n,r,s=e[0]&&Ss(e);const o=e[2].default,l=u(o,e,e[1],null);return{c(){t=y("div"),s&&s.c(),n=_(),l&&l.c(),I(t,"class","labeled svelte-j9cd0w")},m(e,o){m(e,t,o),s&&s.m(t,null),$(t,n),l&&l.m(t,null),r=!0},p(e,[r]){e[0]?s?s.p(e,r):(s=Ss(e),s.c(),s.m(t,n)):s&&(s.d(1),s=null),l&&l.p&&2&r&&d(l,o,e,e[1],r,null,null)},i(e){r||(ne(l,e),r=!0)},o(e){re(l,e),r=!1},d(e){e&&v(t),s&&s.d(),l&&l.d(e)}}}function Ts(e,t,n){let{$$slots:r={},$$scope:s}=t,{label:o}=t;return e.$$set=e=>{"label"in e&&n(0,o=e.label),"$$scope"in e&&n(1,s=e.$$scope)},[o,s,r]}class Ps extends he{constructor(e){super(),de(this,e,Ts,Ms,l,{label:0})}}const Rs=e=>({}),Os=e=>({slot:"list"}),Ds=e=>({}),Bs=e=>({slot:"icon"});function Ns(e){let t;const n=e[0].default,r=u(n,e,e[5],Bs),s=r||function(e){let t,n;return{c(){t=w("svg"),n=w("path"),I(n,"d","M24 13.616v-3.232c-1.651-.587-2.694-.752-3.219-2.019v-.001c-.527-1.271.1-2.134.847-3.707l-2.285-2.285c-1.561.742-2.433 1.375-3.707.847h-.001c-1.269-.526-1.435-1.576-2.019-3.219h-3.232c-.582 1.635-.749 2.692-2.019 3.219h-.001c-1.271.528-2.132-.098-3.707-.847l-2.285 2.285c.745 1.568 1.375 2.434.847 3.707-.527 1.271-1.584 1.438-3.219 2.02v3.232c1.632.58 2.692.749 3.219 2.019.53 1.282-.114 2.166-.847 3.707l2.285 2.286c1.562-.743 2.434-1.375 3.707-.847h.001c1.27.526 1.436 1.579 2.019 3.219h3.232c.582-1.636.75-2.69 2.027-3.222h.001c1.262-.524 2.12.101 3.698.851l2.285-2.286c-.744-1.563-1.375-2.433-.848-3.706.527-1.271 1.588-1.44 3.221-2.021zm-12 2.384c-2.209 0-4-1.791-4-4s1.791-4 4-4 4 1.791 4 4-1.791 4-4 4z"),I(t,"xmlns","http://www.w3.org/2000/svg"),I(t,"width","13"),I(t,"height","13"),I(t,"viewBox","0 0 24 24")},m(e,r){m(e,t,r),$(t,n)},d(e){e&&v(t)}}}();return{c(){s&&s.c()},m(e,n){s&&s.m(e,n),t=!0},p(e,t){r&&r.p&&32&t&&d(r,n,e,e[5],t,Ds,Bs)},i(e){t||(ne(s,e),t=!0)},o(e){re(s,e),t=!1},d(e){s&&s.d(e)}}}function js(e){let t;return{c(){t=b("Import palette")},m(e,n){m(e,t,n)},d(e){e&&v(t)}}}function Fs(e){let t;return{c(){t=b("Export palette")},m(e,n){m(e,t,n)},d(e){e&&v(t)}}}function Hs(e){let t;return{c(){t=b("Clear all")},m(e,n){m(e,t,n)},d(e){e&&v(t)}}}function qs(e){let t;const n=e[0].default,r=u(n,e,e[5],Os),s=r||function(e){let t,n,r,s,o,l,i,a;return n=new jn({props:{$$slots:{default:[js]},$$scope:{ctx:e}}}),n.$on("click",e[1]),s=new jn({props:{$$slots:{default:[Fs]},$$scope:{ctx:e}}}),s.$on("click",e[2]),i=new jn({props:{variant:"danger",$$slots:{default:[Hs]},$$scope:{ctx:e}}}),i.$on("click",e[3]),{c(){t=y("div"),ce(n.$$.fragment),r=_(),ce(s.$$.fragment),o=_(),l=y("div"),ce(i.$$.fragment)},m(e,c){m(e,t,c),ue(n,t,null),$(t,r),ue(s,t,null),m(e,o,c),m(e,l,c),ue(i,l,null),a=!0},p(e,t){const r={};32&t&&(r.$$scope={dirty:t,ctx:e}),n.$set(r);const o={};32&t&&(o.$$scope={dirty:t,ctx:e}),s.$set(o);const l={};32&t&&(l.$$scope={dirty:t,ctx:e}),i.$set(l)},i(e){a||(ne(n.$$.fragment,e),ne(s.$$.fragment,e),ne(i.$$.fragment,e),a=!0)},o(e){re(n.$$.fragment,e),re(s.$$.fragment,e),re(i.$$.fragment,e),a=!1},d(e){e&&v(t),pe(n),pe(s),e&&v(o),e&&v(l),pe(i)}}}(e);return{c(){s&&s.c()},m(e,n){s&&s.m(e,n),t=!0},p(e,t){r&&r.p&&32&t&&d(r,n,e,e[5],t,Rs,Os)},i(e){t||(ne(s,e),t=!0)},o(e){re(s,e),t=!1},d(e){s&&s.d(e)}}}function Ks(t){let n;return{c(){n=_()},m(e,t){m(e,n,t)},p:e,i:e,o:e,d(e){e&&v(n)}}}function Gs(e){let t,n;return t=new Zr({props:{$$slots:{default:[Ks],list:[qs],icon:[Ns]},$$scope:{ctx:e}}}),{c(){ce(t.$$.fragment)},m(e,r){ue(t,e,r),n=!0},p(e,n){const r={};32&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){re(t.$$.fragment,e),n=!1},d(e){pe(t,e)}}}function Js(e){let t,n;return t=new ts({props:{$$slots:{default:[Gs]},$$scope:{ctx:e}}}),t.$on("centerArtboard",e[4]),{c(){ce(t.$$.fragment)},m(e,r){ue(t,e,r),n=!0},p(e,[n]){const r={};32&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){re(t.$$.fragment,e),n=!1},d(e){pe(t,e)}}}function Us(e,t,n){let{$$slots:r={},$$scope:s}=t;return e.$$set=e=>{"$$scope"in e&&n(5,s=e.$$scope)},[r,e=>Le.execute("palette_import"),e=>Le.execute("palette_export"),e=>Le.execute("palette_clear"),function(t){B(e,t)},s]}class Ws extends he{constructor(e){super(),de(this,e,Us,Js,l,{})}}function Ys(e,t,n){const r=e.slice();return r[1]=t[n],r}function Xs(t){let n,r,s;return r=new Ir({props:{rgb:t[1].rgb,hex:t[1].hex,type:"replace"}}),r.$on("click",t[0]),{c(){n=y("li"),ce(r.$$.fragment)},m(e,t){m(e,n,t),ue(r,n,null),s=!0},p:e,i(e){s||(ne(r.$$.fragment,e),s=!0)},o(e){re(r.$$.fragment,e),s=!1},d(e){e&&v(n),pe(r)}}}function Vs(e){let t,n,r=ye,s=[];for(let t=0;t<r.length;t+=1)s[t]=Xs(Ys(e,r,t));const o=e=>re(s[e],1,1,(()=>{s[e]=null}));return{c(){t=y("ul");for(let e=0;e<s.length;e+=1)s[e].c()},m(e,r){m(e,t,r);for(let e=0;e<s.length;e+=1)s[e].m(t,null);n=!0},p(e,[n]){if(1&n){let l;for(r=ye,l=0;l<r.length;l+=1){const o=Ys(e,r,l);s[l]?(s[l].p(o,n),ne(s[l],1)):(s[l]=Xs(o),s[l].c(),ne(s[l],1),s[l].m(t,null))}for(ee(),l=r.length;l<s.length;l+=1)o(l);te()}},i(e){if(!n){for(let e=0;e<r.length;e+=1)ne(s[e]);n=!0}},o(e){s=s.filter(Boolean);for(let e=0;e<s.length;e+=1)re(s[e]);n=!1},d(e){e&&v(t),x(s,e)}}}function Zs(e){return[e=>{console.log(e)}]}class Qs extends he{constructor(e){super(),de(this,e,Zs,Vs,l,{})}}function eo(e,t,n){const r=e.slice();return r[5]=t[n],r[7]=n,r}function to(t){let n;return{c(){n=b("No layer selected")},m(e,t){m(e,n,t)},p:e,i:e,o:e,d(e){e&&v(n)}}}function no(t){let n,r,s=t[0],o=oo(t);return{c(){o.c(),n=k()},m(e,t){o.m(e,t),m(e,n,t),r=!0},p(t,r){1&r&&l(s,s=t[0])?(ee(),re(o,1,1,e),te(),o=oo(t),o.c(),ne(o),o.m(n.parentNode,n)):o.p(t,r)},i(e){r||(ne(o),r=!0)},o(e){re(o),r=!1},d(e){e&&v(n),o.d(e)}}}function ro(e){let t,n,r,s,l,i,a;return n=new Ir({props:{hex:e[5].hex,rgb:e[5].rgb,layerIndex:Ye.layerIndexFromSource(e[0]),colorIndex:e[7],type:"swap"}}),{c(){t=y("li"),ce(n.$$.fragment),r=_(),I(t,"class","svelte-dgveli")},m(o,c){m(o,t,c),ue(n,t,null),$(t,r),l=!0,i||(a=g(s=Yn.call(null,t,{...e[2],value:{layerIndex:Ye.layerIndexFromSource(e[0]),colorIndex:e[7]}})),i=!0)},p(t,r){e=t;const l={};1&r&&(l.hex=e[5].hex),1&r&&(l.rgb=e[5].rgb),1&r&&(l.layerIndex=Ye.layerIndexFromSource(e[0])),n.$set(l),s&&o(s.update)&&1&r&&s.update.call(null,{...e[2],value:{layerIndex:Ye.layerIndexFromSource(e[0]),colorIndex:e[7]}})},i(e){l||(ne(n.$$.fragment,e),l=!0)},o(e){re(n.$$.fragment,e),l=!1},d(e){e&&v(t),pe(n),i=!1,a()}}}function so(e){let t,n,r=e[0].colors,s=[];for(let t=0;t<r.length;t+=1)s[t]=ro(eo(e,r,t));const o=e=>re(s[e],1,1,(()=>{s[e]=null}));return{c(){t=y("ul");for(let e=0;e<s.length;e+=1)s[e].c();I(t,"class","active-color-group svelte-dgveli")},m(e,r){m(e,t,r);for(let e=0;e<s.length;e+=1)s[e].m(t,null);n=!0},p(e,n){if(5&n){let l;for(r=e[0].colors,l=0;l<r.length;l+=1){const o=eo(e,r,l);s[l]?(s[l].p(o,n),ne(s[l],1)):(s[l]=ro(o),s[l].c(),ne(s[l],1),s[l].m(t,null))}for(ee(),l=r.length;l<s.length;l+=1)o(l);te()}},i(e){if(!n){for(let e=0;e<r.length;e+=1)ne(s[e]);n=!0}},o(e){s=s.filter(Boolean);for(let e=0;e<s.length;e+=1)re(s[e]);n=!1},d(e){e&&v(t),x(s,e)}}}function oo(e){let t,n;return t=new Ps({props:{label:e[0].label,$$slots:{default:[so]},$$scope:{ctx:e}}}),{c(){ce(t.$$.fragment)},m(e,r){ue(t,e,r),n=!0},p(e,n){const r={};1&n&&(r.label=e[0].label),257&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(ne(t.$$.fragment,e),n=!0)},o(e){re(t.$$.fragment,e),n=!1},d(e){pe(t,e)}}}function lo(e){let t,n,r,s;const o=[no,to],l=[];function i(e,t){return e[0]?0:1}return t=i(e),n=l[t]=o[t](e),{c(){n.c(),r=k()},m(e,n){l[t].m(e,n),m(e,r,n),s=!0},p(e,s){let a=t;t=i(e),t===a?l[t].p(e,s):(ee(),re(l[a],1,1,(()=>{l[a]=null})),te(),n=l[t],n?n.p(e,s):(n=l[t]=o[t](e),n.c()),ne(n,1),n.m(r.parentNode,r))},i(e){s||(ne(n),s=!0)},o(e){re(n),s=!1},d(e){l[t].d(e),e&&v(r)}}}function io(e){let t,n,r,s,o,l,i,a,c,u,p,d,h,f;return o=new Ws({}),o.$on("centerArtboard",gn),i=new mn({props:{$$slots:{default:[lo]},$$scope:{ctx:e}}}),u=new Qs({}),h=new jr({props:{showEditButtons:!0}}),{c(){t=y("section"),n=y("div"),r=_(),s=y("div"),ce(o.$$.fragment),l=_(),ce(i.$$.fragment),a=_(),c=y("section"),ce(u.$$.fragment),p=_(),d=y("section"),ce(h.$$.fragment),I(s,"class","inner-artboard svelte-dgveli"),I(t,"class","main-artboard svelte-dgveli"),I(c,"class","swatchlist svelte-dgveli"),I(d,"class","palettes-layers svelte-dgveli")},m(e,g){m(e,t,g),$(t,n),$(t,r),$(t,s),ue(o,s,null),$(s,l),ue(i,s,null),m(e,a,g),m(e,c,g),ue(u,c,null),m(e,p,g),m(e,d,g),ue(h,d,null),f=!0},p(e,[t]){const n={};257&t&&(n.$$scope={dirty:t,ctx:e}),i.$set(n)},i(e){f||(ne(o.$$.fragment,e),ne(i.$$.fragment,e),ne(u.$$.fragment,e),ne(h.$$.fragment,e),f=!0)},o(e){re(o.$$.fragment,e),re(i.$$.fragment,e),re(u.$$.fragment,e),re(h.$$.fragment,e),f=!1},d(e){e&&v(t),pe(o),pe(i),e&&v(a),e&&v(c),pe(u),e&&v(p),e&&v(d),pe(h)}}}function ao(e,t,n){let r;const{activeLayer:s,layers:o}=Ye.stores;c(e,s,(e=>n(0,r=e)));return[r,s,{over:e=>!0,leave:e=>!1,drop:({e:e,value:t})=>{const n=e.dataTransfer.getData("swap");n&&o.swapColors({...JSON.parse(n),to:{...t}});const r=e.dataTransfer.getData("replace");r&&o.replaceColor({...JSON.parse(r),...t})}}]}class co extends he{constructor(e){super(),de(this,e,ao,io,l,{})}}const uo=Kt(class extends he{constructor(e){super(),de(this,e,an,ln,l,{})}});uo("/graphics",(e=>bt("/graphics/spritesheets"))),uo("/graphics/spritesheets",((e,t)=>{try{Yt.enableGroups("*","spritesheets"),t.send(Cs)}catch(e){t.error()}}));Kt(class extends he{constructor(e){super(),de(this,e,un,cn,l,{})}})("/graphics/palettes",((e,t)=>{try{Yt.enableGroups("*","palettes"),t.send(co)}catch(e){t.error()}})),Ut.get("/",((e,t)=>{console.log("home")})),Yt.set(["f11"],{data:{action:Le.action("window_toggle_fullscreen")}}),Yt.set(["altleft","enter"],{data:{action:Le.action("window_toggle_fullscreen")}});const po=["palettes"];Yt.set(["insert"],{data:{action:Le.action("palette_create")},groups:po}),Yt.set(["ControlLeft","KeyD"],{data:{action:Le.action("palette_clone_active_layer")},groups:po}),Yt.set(["f2"],{data:{action:Le.action("palette_focus_rename_active_layer")},groups:po});Yt.set(["ControlLeft","KeyI"],{data:{action:Le.action("palette_import")},groups:po}).on((e=>Xt(e)));Yt.set(["ControlLeft","KeyE"],{data:{action:Le.action("palette_export")},groups:po}).on((e=>Xt(e)));const ho=["spritesheets"];Yt.set(["insert"],{data:{action:Le.action("spritesheet_create")},groups:ho}),Yt.set(["ControlLeft","KeyD"],{data:{action:Le.action("spritesheet_clone_active_layer")},groups:ho}),Yt.set(["f2"],{data:{action:Le.action("spritesheet_focus_rename_active_layer")},groups:ho});Yt.set(["ControlLeft","KeyI"],{data:{action:Le.action("spritesheet_import")},groups:ho}).on((e=>Xt(e)));function fo(e){let n,r,s,o;const l=e[3].default,i=u(l,e,e[2],null);let a=[e[1]],c={};for(let e=0;e<a.length;e+=1)c=t(c,a[e]);return{c(){n=y("button"),i&&i.c(),z(n,c)},m(t,l){m(t,n,l),i&&i.m(n,null),r=!0,s||(o=L(n,"click",E(e[5])),s=!0)},p(e,t){i&&i.p&&4&t&&d(i,l,e,e[2],t,null,null),z(n,c=ie(a,[2&t&&e[1]]))},i(e){r||(ne(i,e),r=!0)},o(e){re(i,e),r=!1},d(e){e&&v(n),i&&i.d(e),s=!1,o()}}}function go(e){let n,r,s,o;const l=e[3].default,i=u(l,e,e[2],null);let a=[e[1]],c={};for(let e=0;e<a.length;e+=1)c=t(c,a[e]);return{c(){n=y("button"),i&&i.c(),z(n,c)},m(t,l){m(t,n,l),i&&i.m(n,null),r=!0,s||(o=L(n,"click",e[4]),s=!0)},p(e,t){i&&i.p&&4&t&&d(i,l,e,e[2],t,null,null),z(n,c=ie(a,[2&t&&e[1]]))},i(e){r||(ne(i,e),r=!0)},o(e){re(i,e),r=!1},d(e){e&&v(n),i&&i.d(e),s=!1,o()}}}function $o(e){let t,n,r,s;const o=[go,fo],l=[];return t=globalThis.electron?1:0,n=l[t]=o[t](e),{c(){n.c(),r=k()},m(e,n){l[t].m(e,n),m(e,r,n),s=!0},p(e,[t]){n.p(e,t)},i(e){s||(ne(n),s=!0)},o(e){re(n),s=!1},d(e){l[t].d(e),e&&v(r)}}}function mo(e,n,r){let{$$slots:s={},$$scope:o}=n;const{href:l}=n;return e.$$set=e=>{r(1,n=t(t({},n),h(e))),"$$scope"in e&&r(2,o=e.$$scope)},n=h(n),[l,n,o,s,e=>window.open(l),e=>Le.execute("external_link",l)]}Yt.set(["ControlLeft","KeyE"],{data:{action:Le.action("spritesheet_export")},groups:ho}).on((e=>Xt(e))),Yt.set(["Digit1"],{data:{action:Le.action("palette_active_color"),props:0},groups:ho}),Yt.set(["Digit2"],{data:{action:Le.action("palette_active_color"),props:1},groups:ho}),Yt.set(["Digit3"],{data:{action:Le.action("palette_active_color"),props:2},groups:ho}),Yt.set(["Digit4"],{data:{action:Le.action("palette_active_color"),props:3},groups:ho}),Yt.set(["NumpadAdd"],{data:{action:Le.action("spritesheet_zoom_in")},groups:ho}),Yt.set(["NumpadSubtract"],{data:{action:Le.action("spritesheet_zoom_out")},groups:ho}),Yt.set(["Numpad0"],{data:{action:Le.action("spritesheet_zoom_reset")},groups:ho}),Yt.set(["KeyV"],{data:{action:Le.action("spritesheet_set_active_tool"),props:et.get("pointer")},groups:ho}),Yt.set(["KeyB"],{data:{action:Le.action("spritesheet_set_active_tool"),props:et.get("pen")},groups:ho}),Yt.set(["KeyG"],{data:{action:Le.action("spritesheet_set_active_tool"),props:et.get("paintbucket")},groups:ho}),Yt.set(["KeyM"],{data:{action:Le.action("spritesheet_set_active_tool"),props:et.get("marquee")},groups:ho}),Yt.set(["KeyC"],{data:{action:Le.action("spritesheet_set_active_tool"),props:et.get("preview")},groups:ho}),Yt.set(["KeyE"],{data:{action:Le.action("spritesheet_set_active_tool"),props:et.get("eyedropper")},groups:ho});class vo extends he{constructor(e){super(),de(this,e,mo,$o,l,{})}}function xo(e){let t;return{c(){t=b("Visit github page")},m(e,n){m(e,t,n)},d(e){e&&v(t)}}}function yo(e){let t;return{c(){t=b("Join discord community")},m(e,n){m(e,t,n)},d(e){e&&v(t)}}}function wo(t){let n,r,o,l,i,a,c,u,p,d,h,f,g,x,w,b,k,z,A,C,M,T,P,R,O,D,B,N,j,F,H,q,K,G,J,U,W,Y,X,V,Z,Q,ee=globalThis.electron&&function(t){let n,r,s,o;return{c(){n=y("li"),r=y("button"),r.innerHTML="<span>quit</span>",I(r,"href","/"),I(n,"class","svelte-wz8iyp")},m(e,l){m(e,n,l),$(n,r),s||(o=L(r,"click",t[4]),s=!0)},p:e,d(e){e&&v(n),s=!1,o()}}}(t);return U=new vo({props:{href:"https://github.com/hjalmar/nesbit-studio",$$slots:{default:[xo]},$$scope:{ctx:t}}}),X=new vo({props:{href:"https://discord.gg/WM8ZEnwbSd",$$slots:{default:[yo]},$$scope:{ctx:t}}}),{c(){n=y("nav"),r=y("ul"),o=y("li"),l=y("span"),l.textContent="file",i=_(),a=y("ul"),c=y("li"),u=y("button"),u.innerHTML="<span>new project</span>",p=_(),d=y("li"),h=y("button"),h.innerHTML="<span>open</span>",f=_(),g=y("li"),x=y("button"),x.innerHTML="<span>save</span>",w=_(),b=y("li"),k=y("button"),k.innerHTML="<span>save as</span>",z=_(),ee&&ee.c(),A=_(),C=y("li"),C.innerHTML="<span>edit</span>",M=_(),T=y("li"),T.innerHTML="<span>build</span>",P=_(),R=y("li"),O=y("span"),O.textContent="window",D=_(),B=y("ul"),N=y("li"),j=y("button"),j.innerHTML="<span>toggle fullscreen</span>",F=_(),H=y("li"),q=y("span"),q.textContent="help",K=_(),G=y("ul"),J=y("li"),ce(U.$$.fragment),W=_(),Y=y("li"),ce(X.$$.fragment),I(u,"href","/"),I(c,"class","svelte-wz8iyp"),I(h,"href","/"),I(d,"class","svelte-wz8iyp"),I(x,"href","/"),I(g,"class","svelte-wz8iyp"),I(k,"href","/"),I(b,"class","svelte-wz8iyp"),I(a,"class","svelte-wz8iyp"),I(o,"class","svelte-wz8iyp"),S(o,"show",!1),I(C,"class","svelte-wz8iyp"),I(T,"class","svelte-wz8iyp"),I(j,"href","/"),I(N,"class","svelte-wz8iyp"),I(B,"class","svelte-wz8iyp"),I(R,"class","svelte-wz8iyp"),I(J,"class","svelte-wz8iyp"),I(Y,"class","svelte-wz8iyp"),I(G,"class","svelte-wz8iyp"),I(H,"class","svelte-wz8iyp"),I(r,"id","filemenu"),I(r,"class","svelte-wz8iyp"),I(n,"id","main-nav"),I(n,"class","no-drag")},m(e,s){m(e,n,s),$(n,r),$(r,o),$(o,l),$(o,i),$(o,a),$(a,c),$(c,u),$(a,p),$(a,d),$(d,h),$(a,f),$(a,g),$(g,x),$(a,w),$(a,b),$(b,k),$(a,z),ee&&ee.m(a,null),$(r,A),$(r,C),$(r,M),$(r,T),$(r,P),$(r,R),$(R,O),$(R,D),$(R,B),$(B,N),$(N,j),$(r,F),$(r,H),$(H,q),$(H,K),$(H,G),$(G,J),ue(U,J,null),$(G,W),$(G,Y),ue(X,Y,null),V=!0,Z||(Q=[L(u,"click",E(t[0])),L(h,"click",E(t[1])),L(x,"click",E(t[2])),L(k,"click",E(t[3])),L(j,"click",E(t[5]))],Z=!0)},p(e,[t]){globalThis.electron&&ee.p(e,t);const n={};2048&t&&(n.$$scope={dirty:t,ctx:e}),U.$set(n);const r={};2048&t&&(r.$$scope={dirty:t,ctx:e}),X.$set(r)},i(e){V||(ne(U.$$.fragment,e),ne(X.$$.fragment,e),V=!0)},o(e){re(U.$$.fragment,e),re(X.$$.fragment,e),V=!1},d(e){e&&v(n),ee&&ee.d(),pe(U),pe(X),Z=!1,s(Q)}}}function bo(e){let t=!1,n=[];const r=e=>{n.forEach((e=>e.classList.remove("show"))),t=!1};window.addEventListener("click",r);const s=e=>{e.stopPropagation(),t=!t,e.currentTarget.classList.toggle("show")},o=e=>{n.forEach((e=>e.classList.remove("show"))),t&&e.currentTarget.classList.add("show")};R((()=>{n=document.querySelectorAll("nav > ul > li"),n.forEach((e=>e.addEventListener("click",s))),n.forEach((e=>e.addEventListener("mouseover",o)))})),O((()=>{window.removeEventListener("click",r),n.forEach((e=>e.removeEventListener("click",s))),n.forEach((e=>e.removeEventListener("mouseover",o)))}));return[e=>Le.execute("create_blank_project"),e=>Le.execute("open_project"),e=>Le.execute("save_project"),e=>Le.execute("save_dialog_project"),e=>Le.execute("window_close"),e=>Le.execute("window_toggle_fullscreen")]}class _o extends he{constructor(e){super(),de(this,e,bo,wo,l,{})}}function ko(e){let t,n,r,s;const o=e[6].default,l=u(o,e,e[5],null);return{c(){t=y("button"),l&&l.c(),I(t,"class","no-drag svelte-1j6abr5"),S(t,"active",e[1])},m(o,i){m(o,t,i),l&&l.m(t,null),e[7](t),n=!0,r||(s=L(t,"click",e[2]),r=!0)},p(e,[n]){l&&l.p&&32&n&&d(l,o,e,e[5],n,null,null),2&n&&S(t,"active",e[1])},i(e){n||(ne(l,e),n=!0)},o(e){re(l,e),n=!1},d(n){n&&v(t),l&&l.d(n),e[7](null),r=!1,s()}}}function Lo(e,t,n){let r,s;c(e,At,(e=>n(4,s=e)));let o,{$$slots:l={},$$scope:i}=t,{area:a=null}=t;return e.$$set=e=>{"area"in e&&n(3,a=e.area),"$$scope"in e&&n(5,i=e.$$scope)},e.$$.update=()=>{24&e.$$.dirty&&n(1,r=s.startsWith(`/${a}`))},[o,r,e=>{a&&bt("/"+a)},a,s,i,l,function(e){j[e?"unshift":"push"]((()=>{o=e,n(0,o)}))}]}class Eo extends he{constructor(e){super(),de(this,e,Lo,ko,l,{area:3})}}function Io(e){let t,n;return{c(){t=w("svg"),n=w("path"),I(n,"d","M6 2l1.171.203c-.355 2.245.791 2.519 2.699 2.874 1.468.273 3.13.622 3.13 3.284v.639h-1.183v-.639c0-1.556-.48-1.809-2.164-2.122-2.583-.48-4.096-1.391-3.653-4.239zm18 14c0 3.312-2.607 6-5.825 6-1.511 0-2.886-.595-3.921-1.565-1.311-1.229-3.278-1.132-4.55.038-1.03.948-2.389 1.527-3.879 1.527-3.217 0-5.825-2.688-5.825-6s2.608-6 5.825-6l12.563.007c3.118.116 5.612 2.755 5.612 5.993zm-15-1h-2v-2h-2v2h-2v2h2v2h2v-2h2v-2zm4 1h-2v1h2v-1zm4-2c0 .552.447 1 1 1s1-.448 1-1-.447-1-1-1-1 .448-1 1zm0 2c0-.552-.447-1-1-1s-1 .448-1 1 .447 1 1 1 1-.448 1-1zm2 2c0-.552-.447-1-1-1s-1 .448-1 1 .447 1 1 1 1-.448 1-1zm2-2c0-.552-.447-1-1-1s-1 .448-1 1 .447 1 1 1 1-.448 1-1z"),I(t,"xmlns","http://www.w3.org/2000/svg"),I(t,"width","24"),I(t,"height","24"),I(t,"viewBox","0 0 24 24"),I(t,"class","svelte-1bhpuaq")},m(e,r){m(e,t,r),$(t,n)},d(e){e&&v(t)}}}function zo(e){let t,n;return{c(){t=w("svg"),n=w("path"),I(n,"d","M0 21.398c5.504.456 3.533-5.392 8.626-5.445l2.206 1.841c.549 6.645-7.579 8.127-10.832 3.604zm16.878-8.538c1.713-2.687 7.016-11.698 7.016-11.698.423-.747-.515-1.528-1.17-.976 0 0-7.887 6.857-10.213 9.03-1.838 1.719-1.846 2.504-2.441 5.336l2.016 1.681c2.67-1.098 3.439-1.248 4.792-3.373z"),I(t,"xmlns","http://www.w3.org/2000/svg"),I(t,"width","24"),I(t,"height","24"),I(t,"viewBox","0 0 24 24"),I(t,"class","svelte-1bhpuaq")},m(e,r){m(e,t,r),$(t,n)},d(e){e&&v(t)}}}function Ao(e){let t,n;return{c(){t=w("svg"),n=w("path"),I(n,"d","M13 0h-2v15.676c-3.379-.667-7 1.915-7 4.731 0 2.367 1.881 3.593 3.919 3.593 2.423 0 5.077-1.728 5.081-5.24v-12.76c3.009 2.223 5.623 3.243 5.059 7 1.431-1.727 1.941-2.817 1.941-4.051 0-4.446-7-5.915-7-8.949z"),I(t,"xmlns","http://www.w3.org/2000/svg"),I(t,"width","24"),I(t,"height","24"),I(t,"viewBox","0 0 24 24"),I(t,"class","svelte-1bhpuaq")},m(e,r){m(e,t,r),$(t,n)},d(e){e&&v(t)}}}function Co(e){let t,n;return{c(){t=w("svg"),n=w("path"),I(n,"d","M23 10.826v2.349c-1.562 0-3 1.312-3 2.857 0 2.181 1.281 5.968-6 5.968v-2.002c4.917 0 3.966-1.6 3.966-3.967 0-2.094 1.211-3.5 2.278-4.031-1.067-.531-2.278-1.438-2.278-3.312 0-2.372.94-4.692-3.966-4.686v-2.002c7.285 0 6 4.506 6 6.688 0 1.544 1.438 2.138 3 2.138zm-19-2.138c0-2.182-1.285-6.688 6-6.688v2.002c-4.906-.007-3.966 2.313-3.966 4.686 0 1.875-1.211 2.781-2.278 3.312 1.067.531 2.278 1.938 2.278 4.031 0 2.367-.951 3.967 3.966 3.967v2.002c-7.281 0-6-3.787-6-5.969 0-1.545-1.438-2.857-3-2.857v-2.349c1.562.001 3-.593 3-2.137z"),I(t,"xmlns","http://www.w3.org/2000/svg"),I(t,"width","24"),I(t,"height","24"),I(t,"viewBox","0 0 24 24"),I(t,"class","svelte-1bhpuaq")},m(e,r){m(e,t,r),$(t,n)},d(e){e&&v(t)}}}function So(e){let t,n;return{c(){t=w("svg"),n=w("path"),I(n,"d","M24 19h-1v-2.2c-1.853 4.237-6.083 7.2-11 7.2-6.623 0-12-5.377-12-12h1c0 6.071 4.929 11 11 11 4.66 0 8.647-2.904 10.249-7h-2.249v-1h4v4zm-11.036 0h-1.886c-.34-.957-.437-1.571-1.177-1.878h-.001c-.743-.308-1.251.061-2.162.494l-1.333-1.333c.427-.899.804-1.415.494-2.163-.308-.74-.926-.839-1.878-1.177v-1.886c.954-.339 1.57-.437 1.878-1.178.308-.743-.06-1.248-.494-2.162l1.333-1.333c.918.436 1.421.801 2.162.494l.001-.001c.74-.307.838-.924 1.177-1.877h1.886c.34.958.437 1.57 1.177 1.877l.001.001c.743.308 1.252-.062 2.162-.494l1.333 1.333c-.435.917-.801 1.421-.494 2.161v.001c.307.739.915.835 1.878 1.178v1.886c-.953.338-1.571.437-1.878 1.178-.308.743.06 1.249.494 2.162l-1.333 1.333c-.92-.438-1.42-.802-2.157-.496-.746.31-.844.926-1.183 1.88zm-.943-4.667c-1.289 0-2.333-1.044-2.333-2.333 0-1.289 1.044-2.334 2.333-2.334 1.289 0 2.333 1.045 2.333 2.334 0 1.289-1.044 2.333-2.333 2.333zm-8.021-5.333h-4v-4h1v2.2c1.853-4.237 6.083-7.2 11-7.2 6.623 0 12 5.377 12 12h-1c0-6.071-4.929-11-11-11-4.66 0-8.647 2.904-10.249 7h2.249v1z"),I(t,"width","24"),I(t,"height","24"),I(t,"viewBox","0 0 24 24"),I(t,"xmlns","http://www.w3.org/2000/svg"),I(t,"fill-rule","evenodd"),I(t,"clip-rule","evenodd"),I(t,"class","svelte-1bhpuaq")},m(e,r){m(e,t,r),$(t,n)},d(e){e&&v(t)}}}function Mo(e){let t,n,r,s,o,l,i,a,c,u,p,d,h,f;r=new Eo({props:{area:"game",$$slots:{default:[Io]},$$scope:{ctx:e}}}),l=new Eo({props:{area:"graphics",$$slots:{default:[zo]},$$scope:{ctx:e}}}),c=new Eo({props:{area:"audio",$$slots:{default:[Ao]},$$scope:{ctx:e}}}),d=new Eo({props:{area:"code",$$slots:{default:[Co]},$$scope:{ctx:e}}});let g=globalThis.electron&&function(e){let t,n,r,s,o;return n=new Eo({props:{$$slots:{default:[So]},$$scope:{ctx:e}}}),{c(){t=y("li"),ce(n.$$.fragment),I(t,"class","last svelte-1bhpuaq")},m(l,i){m(l,t,i),ue(n,t,null),r=!0,s||(o=L(t,"click",e[0]),s=!0)},p(e,t){const r={};2&t&&(r.$$scope={dirty:t,ctx:e}),n.$set(r)},i(e){r||(ne(n.$$.fragment,e),r=!0)},o(e){re(n.$$.fragment,e),r=!1},d(e){e&&v(t),pe(n),s=!1,o()}}}(e);return{c(){t=y("ul"),n=y("li"),ce(r.$$.fragment),s=_(),o=y("li"),ce(l.$$.fragment),i=_(),a=y("li"),ce(c.$$.fragment),u=_(),p=y("li"),ce(d.$$.fragment),h=_(),g&&g.c(),I(n,"class","svelte-1bhpuaq"),I(o,"class","svelte-1bhpuaq"),I(a,"class","svelte-1bhpuaq"),I(p,"class","svelte-1bhpuaq"),I(t,"class","area svelte-1bhpuaq")},m(e,v){m(e,t,v),$(t,n),ue(r,n,null),$(t,s),$(t,o),ue(l,o,null),$(t,i),$(t,a),ue(c,a,null),$(t,u),$(t,p),ue(d,p,null),$(t,h),g&&g.m(t,null),f=!0},p(e,[t]){const n={};2&t&&(n.$$scope={dirty:t,ctx:e}),r.$set(n);const s={};2&t&&(s.$$scope={dirty:t,ctx:e}),l.$set(s);const o={};2&t&&(o.$$scope={dirty:t,ctx:e}),c.$set(o);const i={};2&t&&(i.$$scope={dirty:t,ctx:e}),d.$set(i),globalThis.electron&&g.p(e,t)},i(e){f||(ne(r.$$.fragment,e),ne(l.$$.fragment,e),ne(c.$$.fragment,e),ne(d.$$.fragment,e),ne(g),f=!0)},o(e){re(r.$$.fragment,e),re(l.$$.fragment,e),re(c.$$.fragment,e),re(d.$$.fragment,e),re(g),f=!1},d(e){e&&v(t),pe(r),pe(l),pe(c),pe(d),g&&g.d()}}}function To(e){return[e=>Le.execute("buildandrun_project")]}class Po extends he{constructor(e){super(),de(this,e,To,Mo,l,{})}}function Ro(t){let n,r,o,l,i,a,c;return{c(){n=y("button"),r=_(),o=y("button"),l=_(),i=y("button"),I(n,"class","minimize svelte-188xc0"),I(o,"class","maximize svelte-188xc0"),I(i,"class","close svelte-188xc0")},m(e,s){m(e,n,s),m(e,r,s),m(e,o,s),m(e,l,s),m(e,i,s),a||(c=[L(n,"click",t[1]),L(o,"click",t[2]),L(i,"click",t[3])],a=!0)},p:e,i:e,o:e,d(e){e&&v(n),e&&v(r),e&&v(o),e&&v(l),e&&v(i),a=!1,s(c)}}}function Oo(e){const t=e=>Le.execute(`window_${e}`);return[t,e=>t("minimize"),e=>t("maximize"),e=>t("close")]}class Do extends he{constructor(e){super(),de(this,e,Oo,Ro,l,{})}}function Bo(e){let t,n,r,s,o,l,i,a,c,u,p,d,h,f,g,x,w,k,L,E=e[0].name+"",z=e[0].saved?"":"*";return h=new _o({}),g=new Po({}),k=new Do({}),{c(){t=y("header"),n=y("div"),r=_(),s=y("div"),o=y("div"),l=b("["),i=y("span"),a=b(E),c=b("]"),u=b(z),p=_(),d=y("div"),ce(h.$$.fragment),f=_(),ce(g.$$.fragment),x=_(),w=y("div"),ce(k.$$.fragment),I(n,"class","drag app-region svelte-hnfzn8"),I(i,"class","no-paint svelte-hnfzn8"),I(o,"class","titlebar svelte-hnfzn8"),I(d,"id","top-navigation"),I(d,"class","svelte-hnfzn8"),I(w,"id","window-buttons"),I(w,"class","svelte-hnfzn8"),I(s,"class","inner svelte-hnfzn8"),I(t,"id","masthead"),I(t,"class","svelte-hnfzn8")},m(e,v){m(e,t,v),$(t,n),$(t,r),$(t,s),$(s,o),$(o,l),$(o,i),$(i,a),$(o,c),$(o,u),$(s,p),$(s,d),ue(h,d,null),$(d,f),ue(g,d,null),$(s,x),$(s,w),ue(k,w,null),L=!0},p(e,[t]){(!L||1&t)&&E!==(E=e[0].name+"")&&A(a,E),(!L||1&t)&&z!==(z=e[0].saved?"":"*")&&A(u,z)},i(e){L||(ne(h.$$.fragment,e),ne(g.$$.fragment,e),ne(k.$$.fragment,e),L=!0)},o(e){re(h.$$.fragment,e),re(g.$$.fragment,e),re(k.$$.fragment,e),L=!1},d(e){e&&v(t),pe(h),pe(g),pe(k)}}}function No(e,t,n){let r;return c(e,be,(e=>n(0,r=e))),[r]}class jo extends he{constructor(e){super(),de(this,e,No,Bo,l,{})}}function Fo(e,t,n){const r=e.slice();return r[4]=t[n].error,r[5]=t[n].date,r}function Ho(e){let t,n,r,s,o,l,i,a,c=e[5]+"",u=e[4].message+"";return{c(){t=y("li"),n=b("["),r=b(c),s=b("] ( "),o=b(u),l=b(" )\r\n        "),i=y("div"),i.textContent="some extra hidden details",a=_(),I(i,"class","details svelte-8fmup"),I(t,"class","svelte-8fmup")},m(e,c){m(e,t,c),$(t,n),$(t,r),$(t,s),$(t,o),$(t,l),$(t,i),$(t,a)},p(e,t){2&t&&c!==(c=e[5]+"")&&A(r,c),2&t&&u!==(u=e[4].message+"")&&A(o,u)},d(e){e&&v(t)}}}function qo(e){let t,n=e[4]&&Ho(e);return{c(){n&&n.c(),t=k()},m(e,r){n&&n.m(e,r),m(e,t,r)},p(e,r){e[4]?n?n.p(e,r):(n=Ho(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&v(t)}}}function Ko(t){let n,r=t[1],s=[];for(let e=0;e<r.length;e+=1)s[e]=qo(Fo(t,r,e));return{c(){n=y("ul");for(let e=0;e<s.length;e+=1)s[e].c();I(n,"class","svelte-8fmup")},m(e,r){m(e,n,r);for(let e=0;e<s.length;e+=1)s[e].m(n,null);t[2](n)},p(e,[t]){if(2&t){let o;for(r=e[1],o=0;o<r.length;o+=1){const l=Fo(e,r,o);s[o]?s[o].p(l,t):(s[o]=qo(l),s[o].c(),s[o].m(n,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=r.length}},i:e,o:e,d(e){e&&v(n),x(s,e),t[2](null)}}}function Go(e,t,n){let r,s=[];const o=we.subscribe((async e=>{n(1,s=[...e]),await J(),r&&r.scrollTo({top:1e9,left:0,behavior:"smooth"})}));return O((()=>{o()})),[r,s,function(e){j[e?"unshift":"push"]((()=>{r=e,n(0,r)}))}]}class Jo extends he{constructor(e){super(),de(this,e,Go,Ko,l,{})}}function Uo(t){let n,r,s;return r=new Jo({}),{c(){n=y("footer"),ce(r.$$.fragment),I(n,"class","footer svelte-zj1pup")},m(e,t){m(e,n,t),ue(r,n,null),s=!0},p:e,i(e){s||(ne(r.$$.fragment,e),s=!0)},o(e){re(r.$$.fragment,e),s=!1},d(e){e&&v(n),pe(r)}}}class Wo extends he{constructor(e){super(),de(this,e,null,Uo,l,{})}}function Yo(t){let n,r,s,o,l,i,a,c;return r=new jo({}),l=new Ht({}),a=new Wo({}),{c(){n=y("div"),ce(r.$$.fragment),s=_(),o=y("main"),ce(l.$$.fragment),i=_(),ce(a.$$.fragment),I(o,"class","svelte-1qff33r"),I(n,"id","app")},m(e,t){m(e,n,t),ue(r,n,null),$(n,s),$(n,o),ue(l,o,null),$(n,i),ue(a,n,null),c=!0},p:e,i(e){c||(ne(r.$$.fragment,e),ne(l.$$.fragment,e),ne(a.$$.fragment,e),c=!0)},o(e){re(r.$$.fragment,e),re(l.$$.fragment,e),re(a.$$.fragment,e),c=!1},d(e){e&&v(n),pe(r),pe(l),pe(a)}}}class Xo extends he{constructor(e){super(),de(this,e,null,Yo,l,{})}}const{document:Vo}=se;function Zo(e){let n,r,s,o,l;Vo.title=n="["+e[0].name+(e[0].save?"":"*")+"]";const i=[e[1]];let a={};for(let e=0;e<i.length;e+=1)a=t(a,i[e]);return o=new Xo({props:a}),{c(){r=y("meta"),s=_(),ce(o.$$.fragment),I(r,"http-equiv","Content-Security-Policy"),I(r,"content","script-src 'self'")},m(e,t){$(Vo.head,r),m(e,s,t),ue(o,e,t),l=!0},p(e,[t]){(!l||1&t)&&n!==(n="["+e[0].name+(e[0].save?"":"*")+"]")&&(Vo.title=n);const r=2&t?ie(i,[ae(e[1])]):{};o.$set(r)},i(e){l||(ne(o.$$.fragment,e),l=!0)},o(e){re(o.$$.fragment,e),l=!1},d(e){v(r),e&&v(s),pe(o,e)}}}function Qo(e,n,r){let s,o;return c(e,At,(e=>r(2,s=e))),c(e,be,(e=>r(0,o=e))),globalThis.electron&&(document.body.classList.add("electron"),_t("/")),R((async()=>{await J(),Me.startPage!==s&&_t(Me.startPage)})),e.$$set=e=>{r(1,n=t(t({},n),h(e)))},n=h(n),[o,n]}function el(t){let n;return{c(){n=y("section"),n.innerHTML='<article class="svelte-weu28o"><h3>This online version of NESBit Studio relies on ad-monetization to be able to continue to operate</h3> \n    <p>We know, we know. Intrusive ads sucks! We do our best to keep it out of your way and experience using this tool.</p></article>',I(n,"class","checkered svelte-weu28o")},m(e,t){m(e,n,t)},p:e,i:e,o:e,d(e){e&&v(n)}}}return new(window.not_adblocked?class extends he{constructor(e){super(),de(this,e,Qo,Zo,l,{})}}:class extends he{constructor(e){super(),de(this,e,null,el,l,{})}})({target:document.querySelector("body")})}();
//# sourceMappingURL=bundle.js.map

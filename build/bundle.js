var app=function(){"use strict";function e(){}const t=e=>e;function s(e,t){for(const s in t)e[s]=t[s];return e}function o(e){return e()}function n(){return Object.create(null)}function r(e){e.forEach(o)}function i(e){return"function"==typeof e}function a(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function l(t,...s){if(null==t)return e;const o=t.subscribe(...s);return o.unsubscribe?()=>o.unsubscribe():o}function c(e,t,s){e.$$.on_destroy.push(l(t,s))}function u(e,t,s,o){if(e){const n=p(e,t,s,o);return e[0](n)}}function p(e,t,o,n){return e[1]&&n?s(o.ctx.slice(),e[1](n(t))):o.ctx}function h(e,t,s,o,n,r,i){const a=function(e,t,s,o){if(e[2]&&o){const n=e[2](o(s));if(void 0===t.dirty)return n;if("object"==typeof n){const e=[],s=Math.max(t.dirty.length,n.length);for(let o=0;o<s;o+=1)e[o]=t.dirty[o]|n[o];return e}return t.dirty|n}return t.dirty}(t,o,n,r);if(a){const n=p(t,s,o,i);e.p(n,a)}}function d(e){const t={};for(const s in e)"$"!==s[0]&&(t[s]=e[s]);return t}function f(e,t){const s={};t=new Set(t);for(const o in e)t.has(o)||"$"===o[0]||(s[o]=e[o]);return s}function m(e,t,s=t){return e.set(s),t}function g(t){return t&&i(t.destroy)?t.destroy:e}const $="undefined"!=typeof window;let v=$?()=>window.performance.now():()=>Date.now(),y=$?e=>requestAnimationFrame(e):e;const x=new Set;function w(e){x.forEach((t=>{t.c(e)||(x.delete(t),t.f())})),0!==x.size&&y(w)}function b(e){let t;return 0===x.size&&y(w),{promise:new Promise((s=>{x.add(t={c:e,f:s})})),abort(){x.delete(t)}}}function _(e,t){e.appendChild(t)}function L(e,t,s){e.insertBefore(t,s||null)}function k(e){e.parentNode.removeChild(e)}function z(e,t){for(let s=0;s<e.length;s+=1)e[s]&&e[s].d(t)}function E(e){return document.createElement(e)}function I(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function S(e){return document.createTextNode(e)}function M(){return S(" ")}function A(){return S("")}function C(e,t,s,o){return e.addEventListener(t,s,o),()=>e.removeEventListener(t,s,o)}function P(e){return function(t){return t.preventDefault(),e.call(this,t)}}function T(e,t,s){null==s?e.removeAttribute(t):e.getAttribute(t)!==s&&e.setAttribute(t,s)}function j(e,t){const s=Object.getOwnPropertyDescriptors(e.__proto__);for(const o in t)null==t[o]?e.removeAttribute(o):"style"===o?e.style.cssText=t[o]:"__value"===o?e.value=e[o]=t[o]:s[o]&&s[o].set?e[o]=t[o]:T(e,o,t[o])}function N(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function D(e,t,s,o){e.style.setProperty(t,s,o?"important":"")}function R(e,t){for(let s=0;s<e.options.length;s+=1){const o=e.options[s];if(o.__value===t)return void(o.selected=!0)}}function O(e,t,s){e.classList[s?"add":"remove"](t)}function B(e,t){const s=document.createEvent("CustomEvent");return s.initCustomEvent(e,!1,!1,t),s}const H=new Set;let q,F=0;function K(e,t,s,o,n,r,i,a=0){const l=16.666/o;let c="{\n";for(let e=0;e<=1;e+=l){const o=t+(s-t)*r(e);c+=100*e+`%{${i(o,1-o)}}\n`}const u=c+`100% {${i(s,1-s)}}\n}`,p=`__svelte_${function(e){let t=5381,s=e.length;for(;s--;)t=(t<<5)-t^e.charCodeAt(s);return t>>>0}(u)}_${a}`,h=e.ownerDocument;H.add(h);const d=h.__svelte_stylesheet||(h.__svelte_stylesheet=h.head.appendChild(E("style")).sheet),f=h.__svelte_rules||(h.__svelte_rules={});f[p]||(f[p]=!0,d.insertRule(`@keyframes ${p} ${u}`,d.cssRules.length));const m=e.style.animation||"";return e.style.animation=`${m?`${m}, `:""}${p} ${o}ms linear ${n}ms 1 both`,F+=1,p}function G(e,t){const s=(e.style.animation||"").split(", "),o=s.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),n=s.length-o.length;n&&(e.style.animation=o.join(", "),F-=n,F||y((()=>{F||(H.forEach((e=>{const t=e.__svelte_stylesheet;let s=t.cssRules.length;for(;s--;)t.deleteRule(s);e.__svelte_rules={}})),H.clear())})))}function J(e,t){const s=e.getBoundingClientRect();if(t.left!==s.left||t.top!==s.top){const o=getComputedStyle(e),n="none"===o.transform?"":o.transform;e.style.transform=`${n} translate(${t.left-s.left}px, ${t.top-s.top}px)`}}function U(e){q=e}function V(){if(!q)throw new Error("Function called outside component initialization");return q}function Y(e){V().$$.on_mount.push(e)}function W(e){V().$$.on_destroy.push(e)}function Z(){const e=V();return(t,s)=>{const o=e.$$.callbacks[t];if(o){const n=B(t,s);o.slice().forEach((t=>{t.call(e,n)}))}}}function X(e,t){const s=e.$$.callbacks[t.type];s&&s.slice().forEach((e=>e(t)))}const Q=[],ee=[],te=[],se=[],oe=Promise.resolve();let ne=!1;function re(){ne||(ne=!0,oe.then(pe))}function ie(){return re(),oe}function ae(e){te.push(e)}function le(e){se.push(e)}let ce=!1;const ue=new Set;function pe(){if(!ce){ce=!0;do{for(let e=0;e<Q.length;e+=1){const t=Q[e];U(t),he(t.$$)}for(U(null),Q.length=0;ee.length;)ee.pop()();for(let e=0;e<te.length;e+=1){const t=te[e];ue.has(t)||(ue.add(t),t())}te.length=0}while(Q.length);for(;se.length;)se.pop()();ne=!1,ce=!1,ue.clear()}}function he(e){if(null!==e.fragment){e.update(),r(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(ae)}}let de;function fe(){return de||(de=Promise.resolve(),de.then((()=>{de=null}))),de}function me(e,t,s){e.dispatchEvent(B(`${t?"intro":"outro"}${s}`))}const ge=new Set;let $e;function ve(){$e={r:0,c:[],p:$e}}function ye(){$e.r||r($e.c),$e=$e.p}function xe(e,t){e&&e.i&&(ge.delete(e),e.i(t))}function we(e,t,s,o){if(e&&e.o){if(ge.has(e))return;ge.add(e),$e.c.push((()=>{ge.delete(e),o&&(s&&e.d(1),o())})),e.o(t)}}const be={duration:0};const _e="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function Le(e,t){we(e,1,1,(()=>{t.delete(e.key)}))}function ke(e,t){e.f(),Le(e,t)}function ze(e,t,s,o,n,r,i,a,l,c,u,p){let h=e.length,d=r.length,f=h;const m={};for(;f--;)m[e[f].key]=f;const g=[],$=new Map,v=new Map;for(f=d;f--;){const e=p(n,r,f),a=s(e);let l=i.get(a);l?o&&l.p(e,t):(l=c(a,e),l.c()),$.set(a,g[f]=l),a in m&&v.set(a,Math.abs(f-m[a]))}const y=new Set,x=new Set;function w(e){xe(e,1),e.m(a,u),i.set(e.key,e),u=e.first,d--}for(;h&&d;){const t=g[d-1],s=e[h-1],o=t.key,n=s.key;t===s?(u=t.first,h--,d--):$.has(n)?!i.has(o)||y.has(o)?w(t):x.has(n)?h--:v.get(o)>v.get(n)?(x.add(o),w(t)):(y.add(n),h--):(l(s,i),h--)}for(;h--;){const t=e[h];$.has(t.key)||l(t,i)}for(;d;)w(g[d-1]);return g}function Ee(e,t){const s={},o={},n={$$scope:1};let r=e.length;for(;r--;){const i=e[r],a=t[r];if(a){for(const e in i)e in a||(o[e]=1);for(const e in a)n[e]||(s[e]=a[e],n[e]=1);e[r]=a}else for(const e in i)n[e]=1}for(const e in o)e in s||(s[e]=void 0);return s}function Ie(e){return"object"==typeof e&&null!==e?e:{}}function Se(e,t,s){const o=e.$$.props[t];void 0!==o&&(e.$$.bound[o]=s,s(e.$$.ctx[o]))}function Me(e){e&&e.c()}function Ae(e,t,s){const{fragment:n,on_mount:a,on_destroy:l,after_update:c}=e.$$;n&&n.m(t,s),ae((()=>{const t=a.map(o).filter(i);l?l.push(...t):r(t),e.$$.on_mount=[]})),c.forEach(ae)}function Ce(e,t){const s=e.$$;null!==s.fragment&&(r(s.on_destroy),s.fragment&&s.fragment.d(t),s.on_destroy=s.fragment=null,s.ctx=[])}function Pe(t,s,o,i,a,l,c=[-1]){const u=q;U(t);const p=s.props||{},h=t.$$={fragment:null,ctx:null,props:l,update:e,not_equal:a,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:[]),callbacks:n(),dirty:c,skip_bound:!1};let d=!1;if(h.ctx=o?o(t,p,((e,s,...o)=>{const n=o.length?o[0]:s;return h.ctx&&a(h.ctx[e],h.ctx[e]=n)&&(!h.skip_bound&&h.bound[e]&&h.bound[e](n),d&&function(e,t){-1===e.$$.dirty[0]&&(Q.push(e),re(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(t,e)),s})):[],h.update(),d=!0,r(h.before_update),h.fragment=!!i&&i(h.ctx),s.target){if(s.hydrate){const e=function(e){return Array.from(e.childNodes)}(s.target);h.fragment&&h.fragment.l(e),e.forEach(k)}else h.fragment&&h.fragment.c();s.intro&&xe(t.$$.fragment),Ae(t,s.target,s.anchor),pe()}U(u)}class Te{$destroy(){Ce(this,1),this.$destroy=e}$on(e,t){const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(t),()=>{const e=s.indexOf(t);-1!==e&&s.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const je=[];function Ne(t,s=e){let o;const n=[];function r(e){if(a(t,e)&&(t=e,o)){const e=!je.length;for(let e=0;e<n.length;e+=1){const s=n[e];s[1](),je.push(s,t)}if(e){for(let e=0;e<je.length;e+=2)je[e][0](je[e+1]);je.length=0}}}return{set:r,update:function(e){r(e(t))},subscribe:function(i,a=e){const l=[i,a];return n.push(l),1===n.length&&(o=s(r)||e),i(t),()=>{const e=n.indexOf(l);-1!==e&&n.splice(e,1),0===n.length&&(o(),o=null)}}}}function De(t,s,o){const n=!Array.isArray(t),a=n?[t]:t,c=s.length<2;return{subscribe:Ne(o,(t=>{let o=!1;const u=[];let p=0,h=e;const d=()=>{if(p)return;h();const o=s(n?u[0]:u,t);c?t(o):h=i(o)?o:e},f=a.map(((e,t)=>l(e,(e=>{u[t]=e,p&=~(1<<t),o&&d()}),(()=>{p|=1<<t}))));return o=!0,d(),function(){r(f),h()}})).subscribe}}const Re=e=>{var t,s,o=e[0]/255,n=e[1]/255,r=e[2]/255,i=Math.max(o,n,r),a=Math.min(o,n,r),l=(i+a)/2;if(i==a)t=s=0;else{var c=i-a;switch(s=l>.5?c/(2-i-a):c/(i+a),i){case o:t=(n-r)/c+(n<r?6:0);break;case n:t=(r-o)/c+2;break;case r:t=(o-n)/c+4}t/=6}return new Array(360*t,100*s,100*l)},Oe=[{hex:"00",rgb:[124,124,124]},{hex:"01",rgb:[0,0,252]},{hex:"02",rgb:[0,0,188]},{hex:"03",rgb:[68,40,188]},{hex:"04",rgb:[148,0,132]},{hex:"05",rgb:[168,0,32]},{hex:"06",rgb:[168,16,0]},{hex:"07",rgb:[136,20,0]},{hex:"08",rgb:[80,48,0]},{hex:"09",rgb:[0,120,0]},{hex:"0A",rgb:[0,104,0]},{hex:"0B",rgb:[0,88,0]},{hex:"0C",rgb:[0,64,88]},{hex:"0D",rgb:[0,0,0]},{hex:"0E",rgb:[0,0,0]},{hex:"0F",rgb:[0,0,0]},{hex:"10",rgb:[188,188,188]},{hex:"11",rgb:[0,120,248]},{hex:"12",rgb:[0,88,248]},{hex:"13",rgb:[104,68,252]},{hex:"14",rgb:[216,0,204]},{hex:"15",rgb:[228,0,88]},{hex:"16",rgb:[248,56,0]},{hex:"17",rgb:[228,92,16]},{hex:"18",rgb:[172,124,0]},{hex:"19",rgb:[0,184,0]},{hex:"1A",rgb:[0,168,0]},{hex:"1B",rgb:[0,168,68]},{hex:"1C",rgb:[0,136,136]},{hex:"1D",rgb:[0,0,0]},{hex:"1E",rgb:[0,0,0]},{hex:"1F",rgb:[0,0,0]},{hex:"20",rgb:[248,248,248]},{hex:"21",rgb:[60,188,252]},{hex:"22",rgb:[104,136,252]},{hex:"23",rgb:[152,120,248]},{hex:"24",rgb:[248,120,248]},{hex:"25",rgb:[248,88,152]},{hex:"26",rgb:[248,120,88]},{hex:"27",rgb:[252,160,68]},{hex:"28",rgb:[248,184,0]},{hex:"29",rgb:[184,248,24]},{hex:"2A",rgb:[88,216,84]},{hex:"2B",rgb:[88,248,152]},{hex:"2C",rgb:[0,232,216]},{hex:"2D",rgb:[120,120,120]},{hex:"2E",rgb:[0,0,0]},{hex:"2F",rgb:[0,0,0]},{hex:"30",rgb:[252,252,252]},{hex:"31",rgb:[164,228,252]},{hex:"32",rgb:[184,184,248]},{hex:"33",rgb:[216,184,248]},{hex:"34",rgb:[248,184,248]},{hex:"35",rgb:[248,164,192]},{hex:"36",rgb:[240,208,176]},{hex:"37",rgb:[252,224,168]},{hex:"38",rgb:[248,216,120]},{hex:"39",rgb:[216,248,120]},{hex:"3A",rgb:[184,248,184]},{hex:"3B",rgb:[184,248,216]},{hex:"3C",rgb:[0,252,252]},{hex:"3D",rgb:[216,216,216]},{hex:"3E",rgb:[0,0,0]},{hex:"3F",rgb:[0,0,0]}],Be=Oe.map(((e,t)=>({rgb:Re(e.rgb),index:t}))).sort(((e,t)=>t.rgb[0]-e.rgb[0]||e.rgb[2]-t.rgb[2])).map((e=>Oe[e.index]));class He{constructor(e,t){this.hex=e,this.rgb=t,Object.freeze(this)}}const qe=Be.map((e=>new He(e.hex,e.rgb))),Fe=(()=>{const e=Ne([]),{subscribe:t,update:s}=e;return{subscribe:t,push(e){if(e instanceof ErrorEvent){const t=new Date,o=`${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}:${String(t.getSeconds()).padStart(2,"0")}`;e.date=o,s((t=>(t.length>20&&(t=[]),t.push(e),t)))}}}})(),Ke=(e=4)=>`${Date.now().toString(36)}-${new Array(e-1).fill(0).map((e=>Math.random().toString(36).substr(2,8))).join("-")}`,Ge=(e,t=6)=>{if("number"!=typeof e)throw new Error(`Invalid argument, expecting number got : [${typeof e}]`);if("number"!=typeof t)throw new Error(`Invalid padding argument, expecting number got : [${typeof t}]`);const s=(e>>>0).toString(16);return t?s.padStart(t,0):s},Je=(e,t,s,o,n,r=!0)=>{const i=(e-t)/(s-t)*(n-o)+o;return r?((e,t,s)=>Math.max(Math.min(e,s),t))(i,o,n):i};function Ue(e){const t=e-1;return t*t*t+1}function Ve(e,{delay:t=0,duration:s=400,easing:o=Ue,x:n=0,y:r=0,opacity:i=0}){const a=getComputedStyle(e),l=+a.opacity,c="none"===a.transform?"":a.transform,u=l*(1-i);return{delay:t,duration:s,easing:o,css:(e,t)=>`\n\t\t\ttransform: ${c} translate(${(1-e)*n}px, ${(1-e)*r}px);\n\t\t\topacity: ${l-u*t}`}}function Ye(e,t,s){const o=getComputedStyle(e),n="none"===o.transform?"":o.transform,r=t.from.width/e.clientWidth,a=t.from.height/e.clientHeight,l=(t.from.left-t.to.left)/r,c=(t.from.top-t.to.top)/a,u=Math.sqrt(l*l+c*c),{delay:p=0,duration:h=(e=>120*Math.sqrt(e)),easing:d=Ue}=s;return{delay:p,duration:i(h)?h(u):h,easing:d,css:(e,t)=>`transform: ${n} translate(${t*l}px, ${t*c}px);`}}function We(e,t,s){const o=e.slice();return o[2]=t[s],o}function Ze(e){let t,s,o=[],n=new Map,r=e[0];const i=e=>e[2].uuid;for(let t=0;t<r.length;t+=1){let s=We(e,r,t),a=i(s);n.set(a,o[t]=Xe(a,s))}return{c(){t=E("div");for(let e=0;e<o.length;e+=1)o[e].c();T(t,"class","toast-notifications svelte-jnrt3b")},m(e,n){L(e,t,n);for(let e=0;e<o.length;e+=1)o[e].m(t,null);s=!0},p(e,s){if(1&s){r=e[0],ve();for(let e=0;e<o.length;e+=1)o[e].r();o=ze(o,s,i,1,e,r,n,t,ke,Xe,null,We);for(let e=0;e<o.length;e+=1)o[e].a();ye()}},i(e){if(!s){for(let e=0;e<r.length;e+=1)xe(o[e]);s=!0}},o(e){for(let e=0;e<o.length;e+=1)we(o[e]);s=!1},d(e){e&&k(t);for(let e=0;e<o.length;e+=1)o[e].d()}}}function Xe(s,o){let n,a,l,c,u,p,h,d,f,m,g,$,y,x=o[2].message+"",w=e;function z(...e){return o[1](o[2],...e)}return{key:s,first:null,c(){n=E("div"),a=E("button"),a.innerHTML='<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" class="svelte-jnrt3b"><path d="M12 11.293l10.293-10.293.707.707-10.293 10.293 10.293 10.293-.707.707-10.293-10.293-10.293 10.293-.707-.707 10.293-10.293-10.293-10.293.707-.707 10.293 10.293z"></path></svg>',l=M(),c=E("p"),u=S(x),p=M(),T(a,"class","svelte-jnrt3b"),T(c,"class","svelte-jnrt3b"),T(n,"class","notification svelte-jnrt3b"),T(n,"data-variant",h=o[2].variant),this.first=n},m(e,t){L(e,n,t),_(n,a),_(n,l),_(n,c),_(c,u),_(n,p),g=!0,$||(y=C(a,"click",z),$=!0)},p(e,t){o=e,(!g||1&t)&&x!==(x=o[2].message+"")&&N(u,x),(!g||1&t&&h!==(h=o[2].variant))&&T(n,"data-variant",h)},r(){m=n.getBoundingClientRect()},f(){!function(e){const t=getComputedStyle(e);if("absolute"!==t.position&&"fixed"!==t.position){const{width:s,height:o}=t,n=e.getBoundingClientRect();e.style.position="absolute",e.style.width=s,e.style.height=o,J(e,n)}}(n),w(),J(n,m)},a(){w(),w=function(s,o,n,r){if(!o)return e;const i=s.getBoundingClientRect();if(o.left===i.left&&o.right===i.right&&o.top===i.top&&o.bottom===i.bottom)return e;const{delay:a=0,duration:l=300,easing:c=t,start:u=v()+a,end:p=u+l,tick:h=e,css:d}=n(s,{from:o,to:i},r);let f,m=!0,g=!1;function $(){d&&G(s,f),m=!1}return b((e=>{if(!g&&e>=u&&(g=!0),g&&e>=p&&(h(1,0),$()),!m)return!1;if(g){const t=0+1*c((e-u)/l);h(t,1-t)}return!0})),d&&(f=K(s,0,1,l,a,c,d)),a||(g=!0),h(0,1),$}(n,m,Ye,{})},i(s){g||(ae((()=>{f&&f.end(1),d||(d=function(s,o,n){let r,a,l=o(s,n),c=!1,u=0;function p(){r&&G(s,r)}function h(){const{delay:o=0,duration:n=300,easing:i=t,tick:h=e,css:d}=l||be;d&&(r=K(s,0,1,n,o,i,d,u++)),h(0,1);const f=v()+o,m=f+n;a&&a.abort(),c=!0,ae((()=>me(s,!0,"start"))),a=b((e=>{if(c){if(e>=m)return h(1,0),me(s,!0,"end"),p(),c=!1;if(e>=f){const t=i((e-f)/n);h(t,1-t)}}return c}))}let d=!1;return{start(){d||(G(s),i(l)?(l=l(),fe().then(h)):h())},invalidate(){d=!1},end(){c&&(p(),c=!1)}}}(n,Ve,{x:500,duration:300})),d.start()})),g=!0)},o(s){d&&d.invalidate(),f=function(s,o,n){let a,l=o(s,n),c=!0;const u=$e;function p(){const{delay:o=0,duration:n=300,easing:i=t,tick:p=e,css:h}=l||be;h&&(a=K(s,1,0,n,o,i,h));const d=v()+o,f=d+n;ae((()=>me(s,!1,"start"))),b((e=>{if(c){if(e>=f)return p(0,1),me(s,!1,"end"),--u.r||r(u.c),!1;if(e>=d){const t=i((e-d)/n);p(1-t,t)}}return c}))}return u.r+=1,i(l)?fe().then((()=>{l=l(),p()})):p(),{end(e){e&&l.tick&&l.tick(1,0),c&&(a&&G(s,a),c=!1)}}}(n,Ve,{x:0,duration:300}),g=!1},d(e){e&&k(n),e&&f&&f.end(),$=!1,y()}}}function Qe(e){let t,s,o=e[0].length&&Ze(e);return{c(){o&&o.c(),t=A()},m(e,n){o&&o.m(e,n),L(e,t,n),s=!0},p(e,[s]){e[0].length?o?(o.p(e,s),1&s&&xe(o,1)):(o=Ze(e),o.c(),xe(o,1),o.m(t.parentNode,t)):o&&(ve(),we(o,1,1,(()=>{o=null})),ye())},i(e){s||(xe(o),s=!0)},o(e){we(o),s=!1},d(e){o&&o.d(e),e&&k(t)}}}const et=Ne([]),tt=e=>{et.update((t=>t.filter((t=>t!==e))))},st=e=>et.update((t=>{let s={uuid:Ke(),message:"Invalid toast properties.",variant:"danger"};return e.message&&(s={...s,...e}),t.push(s),setTimeout((()=>{tt(s)}),5e3),t}));function ot(e,t,s){let o;c(e,et,(e=>s(0,o=e)));return[o,(e,t)=>tt(e)]}class nt extends Te{constructor(e){super(),Pe(this,e,ot,Qe,a,{})}}function rt(e){let t,s,o,n,i,a,l;const c=e[6].default,p=u(c,e,e[5],null);return{c(){t=E("div"),s=E("div"),o=E("div"),n=E("div"),p&&p.c(),T(n,"class","content svelte-131dyyn"),T(o,"class","wrapper svelte-131dyyn"),T(s,"class","outer svelte-131dyyn"),T(t,"class","artboard svelte-131dyyn"),O(t,"active",e[0])},m(r,c){L(r,t,c),_(t,s),_(s,o),_(o,n),p&&p.m(n,null),e[7](o),e[8](s),e[10](t),i=!0,a||(l=[C(s,"mousedown",e[2],!0),C(s,"wheel",e[9]),C(t,"wheel",e[1])],a=!0)},p(e,[s]){p&&p.p&&32&s&&h(p,c,e,e[5],s,null,null),1&s&&O(t,"active",e[0])},i(e){i||(xe(p,e),i=!0)},o(e){we(p,e),i=!1},d(s){s&&k(t),p&&p.d(s),e[7](null),e[8](null),e[10](null),a=!1,r(l)}}}let it,at,lt;window.addEventListener("contextmenu",(e=>e.preventDefault())),window.addEventListener("error",(function(e){Fe.push(e),st({message:e.message,variant:"danger"})})),window.addEventListener("keydown",(e=>{}));const ct=()=>{const e={x:at.offsetWidth/2-it.offsetWidth/2,y:at.offsetHeight/2-it.offsetHeight/2};return it.scrollTo(e.x,e.y),e};function ut(e,t,s){let{$$slots:o={},$$scope:n}=t;const r=Z();let i=!1,a=!1,{x:l=0}=t,{y:c=0}=t;const u=new ResizeObserver((e=>(e=>{for(const t of e)if(t.contentRect){t.contentRect;const e={x:8e3,y:8e3};if(at.style.height=e.y+"px",at.style.width=e.x+"px",!i){i=!0;const{x:e,y:t}=ct();it.scrollTo(l||e,c||t)}}})(e)));let p,h,d,f,m={};const g=e=>{e.preventDefault(),m[e.code]=!0},$=e=>{m[e.code]=!1},v=()=>{s(0,a=!1),r("artboardOffsetEvent",{x:l,y:c})},y=e=>{if(!m.Space&&2!=e.which)return;e.stopPropagation(),e.stopImmediatePropagation();const t=1*(e.pageX-it.offsetLeft-p),o=1*(e.pageY-it.offsetTop-h),n={x:it.scrollLeft,y:it.scrollTop};s(3,l=n.x),s(4,c=n.y),a&&(e.preventDefault(),it.scrollLeft=d-t,it.scrollTop=f-o)};Y((()=>{document.addEventListener("keydown",g),document.addEventListener("keyup",$),u.observe(lt),document.addEventListener("mousemove",y,!0),document.addEventListener("mouseup",v)})),W((()=>{document.removeEventListener("keydown",g),document.removeEventListener("keyup",$),u.disconnect(),document.removeEventListener("mousemove",y,!0),document.removeEventListener("mouseup",v)}));return e.$$set=e=>{"x"in e&&s(3,l=e.x),"y"in e&&s(4,c=e.y),"$$scope"in e&&s(5,n=e.$$scope)},[a,e=>r("artboardScrollEvent",e),e=>{(m.Space||2==e.which)&&(e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault(),s(0,a=!0),p=e.pageX-it.offsetLeft,d=it.scrollLeft,h=e.pageY-it.offsetTop,f=it.scrollTop)},l,c,n,o,function(e){ee[e?"unshift":"push"]((()=>{at=e}))},function(e){ee[e?"unshift":"push"]((()=>{it=e}))},e=>e.preventDefault(),function(e){ee[e?"unshift":"push"]((()=>{lt=e}))}]}class pt extends Te{constructor(e){super(),Pe(this,e,ut,rt,a,{x:3,y:4})}}class ht extends Number{constructor(e,t){if("number"!=typeof e||"string"!=typeof t)throw new Error("Invalid Enumerable arguments");super(e),this.key=t,this.value=e,Object.freeze(this)}}class dt extends Map{constructor(...e){super(),e.forEach(((e,t)=>{if(this.has(e))throw new Error(`enum key : '${e}' already exists`);if("string"!=typeof e)throw new Error(`Invalid key. Expecting string, got : [${typeof e}](${e})`);const s=new ht(t+1,e);this.set(e,s)})),Object.freeze(this)}}const ft=new class{constructor(...e){this.__actions=this.define(...e),this.__binds=new Map}define(...e){const t=new dt(...e);return this.__actions=t,t}action(e){if(!this.__actions.has(e))throw new Error(`Action is not defined for key '${e}'`);return this.__actions.get(e)}register(e,t){if("string"!=typeof e){if(!(e instanceof ht))throw new Error(`Invalid key value '${e}'. Expecting instance of 'Enum'`);if(this.__binds.has(e))throw new Error(`Action already defined : [${e.key}]`);if("function"!=typeof t)throw new Error("Invalid callback function");this.__binds.set(e,t)}else this.register(this.action(e),t)}exist(e){return this.__binds.has(e)}call(e,...t){if("string"!=typeof e){if(!(e instanceof ht))throw new Error(`Invalid key '${e}'. Expecting 'Enum'`);if(!this.__binds.has(e))throw new Error(`Action for '${e.key}'(${e}) does not exist`);return new Promise(((s,o)=>{try{s(this.__binds.get(e).call(null,...t))}catch(e){o(e.message)}}))}this.call(this.action(e),...t)}execute(...e){return this.call(...e)}}("noop","application_log","window_close","window_minimize","window_maximize","window_toggle_fullscreen","external_link","project_create","project_open","project_save","project_save_as","project_build","project_run","project_build_run","graphics_center_artboard","palette_clear","palette_create","palette_remove","palette_clone_layer","palette_clone_active_layer","palette_make_layer_active","palette_swap_layers","palette_update_layer_label","palette_focus_rename_active_layer","palette_export","palette_import","palette_active_color","spritesheet_clear","spritesheet_create","spritesheet_remove","spritesheet_clone_layer","spritesheet_clone_active_layer","spritesheet_update_layer_label","spritesheet_make_layer_active","spritesheet_swap_layers","spritesheet_focus_rename_active_layer","spritesheet_zoom_in","spritesheet_zoom_out","spritesheet_zoom_reset","spritesheet_set_active_tool","spritesheet_tool_dblclick","spritesheet_import","spritesheet_export","spritesheet_import_chr","spritesheet_export_chr","spritesheet_export_png","spritesheet_undo","spritesheet_redo","spritesheet_set_selected_tile","tilemap_clear","tilemap_create","tilemap_remove","tilemap_clone_layer","tilemap_clone_active_layer","tilemap_update_layer_label","tilemap_make_layer_active","tilemap_swap_layers","tilemap_focus_rename_active_layer","tilemap_zoom","tilemap_zoom_in","tilemap_zoom_out","tilemap_zoom_reset","tilemap_import","tilemap_export","tilemap_export_nametable","tilemap_export_png","tool_action","toggle_theme","light_theme","dark_theme");class mt{constructor({keys:e,data:t,groups:s,options:o}){if(!Array.isArray(e))throw new Error("Invalid keys. Expecting array of string representation values.");this.options={...o},this.groups=s||[],this.signature=e.toString(),this.keys=e,this.data=t,this.__on,this.__off}get callbacks(){return{on:this.__on,off:this.__off}}on(e){if("function"!=typeof e)throw new Error("Invalid 'off' function");return this.__on=e,this}off(e){if("function"!=typeof e)throw new Error("Invalid 'off' function");return this.__off=e,this}}const gt=new class{constructor(e,t){this.__options={once:!0,preventDefault:!0,...t},this.__registeredGroups=new Set,this.__enabledGroups="__all__",this.__commands=new Map,this.__target=e}get target(){return this.__target}_prepare(e){if(!Array.isArray(e))throw new Error(`Invalid '_prepare' argument. Expecting array, got : [${typeof e}]`);return[...e].map((e=>e.toLowerCase())).sort(((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase())))}enableAllGroups(){this.__enabledGroups="__all__"}enableGroups(...e){return[...this.__enabledGroups=[...e]]}_find(e){const t=Array.from(this.__commands.values());let s;return t.sort(((e,t)=>t.options.priority-e.options.priority)),Array.isArray(this.__enabledGroups)?s=t.find((t=>t.groups.some((s=>{if((!this.__enabledGroups||this.__enabledGroups.includes(s))&&t.signature==e.toString())return!0})))):"__all__"==this.__enabledGroups&&(s=t.find((t=>t.signature==e.toString()))),s}set(e,{data:t,groups:s,...o}){(s=Array.isArray(s)&&s.length>0?s:["*"]).map((e=>this.__registeredGroups.add(e)));const n=this._prepare(e),r=new mt({keys:n,data:t,groups:s,options:{priority:o.priority||0,once:o.once||this.__options.once,preventDefault:o.preventDefault||this.__options.preventDefault}});return s.map((e=>{if(this.__commands.get(`${e},${r.signature}`))throw new Error(`Shortcut already defined : [${e},${r.signature}]`);this.__commands.set(`${e},${r.signature}`,r)})),r}execute(e,t){if("on"==t||null==t){const t={};e.map((e=>t[e.toLowerCase()]=!0));const s=new Event("keydown");s.customExecuteEvent=t,this.__target.dispatchEvent(s)}"off"!=t&&null!=t||e.map((e=>{const t=new Event("keyup");t.code=e,this.__target.dispatchEvent(t)}))}subscribe(e){let t={},s={};const o=o=>{o.customExecuteEvent?t=o.customExecuteEvent:t[o.code.toLowerCase()]=!0;const n=this._prepare(Object.entries(t).filter((([e,t])=>t)).map((([e,t])=>e.toLowerCase()))),r=this._find(n);if(r){if(r.options.preventDefault&&o.preventDefault(),r.options.once&&n.toString()==s.signature)return;s={instance:r,signature:n.toString()},"function"==typeof r.callbacks.on?r.callbacks.on.call(null,{e:o,Hotkey:r,on:!0}):"function"==typeof e&&e.call(null,{e:o,Hotkey:r,on:!0})}},n=o=>{t[o.code.toLowerCase()]=!1,s.instance&&"function"==typeof s.instance.callbacks.off?s.instance.callbacks.off.call(null,{e:o,Hotkey:s.instance,on:!1}):s.instance&&"function"==typeof e&&e.call(null,{e:o,Hotkey:s.instance,on:!1}),s={}};return this.__target.addEventListener("keydown",o),this.__target.addEventListener("keyup",n),()=>(this.__target.removeEventListener("keyup",n),this.__target.removeEventListener("keydown",o),t=>this.subscribe(this.__target,e))}}(window,{});gt.subscribe((({e:e,Hotkey:t,on:s})=>{e.preventDefault(),s&&t.data&&ft.exist(t.data.action)&&ft.execute(t.data.action,t.data.props)}));const $t=({e:e,Hotkey:t,on:s})=>{e.preventDefault(),s&&t.data&&ft.exist(t.data.action)&&ft.execute(t.data.action),gt.execute(t.keys,"off")},vt=(e,t)=>{const s=Ne(e);let o={...s,get:e=>function(e){let t;return l(e,(e=>t=e))(),t}(s)};return t&&(o={...o,...t.call(null,{value:e,store:s,get:o.get}||{...o})}),Object.freeze(o)},{window:yt}=_e,xt=e=>({focus:4&e}),wt=e=>({focus:e[11]});function bt(e){let t,s,o,n;const i=e[10].default,a=u(i,e,e[9],wt);return{c(){t=E("div"),a&&a.c(),T(t,"class","draggable svelte-1262lmj"),D(t,"left",e[1]+"px"),D(t,"top",e[0]+"px")},m(r,i){L(r,t,i),a&&a.m(t,null),e[12](t),s=!0,o||(n=[C(yt,"mouseup",e[4]),C(yt,"mousemove",e[5],!0),C(t,"mousedown",e[3])],o=!0)},p(e,[o]){a&&a.p&&516&o&&h(a,i,e,e[9],o,xt,wt),(!s||2&o)&&D(t,"left",e[1]+"px"),(!s||1&o)&&D(t,"top",e[0]+"px")},i(e){s||(xe(a,e),s=!0)},o(e){we(a,e),s=!1},d(s){s&&k(t),a&&a.d(s),e[12](null),o=!1,r(n)}}}let _t=9999,Lt=[];const kt=e=>{e.zindex=_t++,e.style.setProperty("--zindex",_t)};function zt(e,t,s){let o,{$$slots:n={},$$scope:r}=t,{clamp:i}=t,{top:a=0}=t,{left:l=0}=t,{minLeft:c=0}=t,{minTop:u=0}=t;a=Math.max(a,u),l=Math.max(l,c);let p=!1;Y((()=>{var e;return kt(e=o),Lt.push(e),()=>{(e=>{Lt=Lt.filter((t=>t!==e))})(o)}}));return e.$$set=e=>{"clamp"in e&&s(6,i=e.clamp),"top"in e&&s(0,a=e.top),"left"in e&&s(1,l=e.left),"minLeft"in e&&s(7,c=e.minLeft),"minTop"in e&&s(8,u=e.minTop),"$$scope"in e&&s(9,r=e.$$scope)},[a,l,o,e=>{kt(o),p=!0},e=>p=!1,e=>{if(p&&(s(1,l+=e.movementX),s(0,a+=e.movementY),i)){const e=window.innerWidth,t=window.innerHeight;s(1,l=Math.min(Math.max(l,c),e-o.clientWidth-2)),s(0,a=Math.min(Math.max(a,u),t-o.clientHeight-2))}},i,c,u,r,n,e=>kt(o),function(e){ee[e?"unshift":"push"]((()=>{o=e,s(2,o)}))}]}class Et extends Te{constructor(e){super(),Pe(this,e,zt,bt,a,{clamp:6,top:0,left:1,minLeft:7,minTop:8})}}function It(e){let t,s;const o=e[1].default,n=u(o,e,e[0],null);return{c(){t=E("div"),n&&n.c(),T(t,"class","panel-header svelte-18pvy6o")},m(e,o){L(e,t,o),n&&n.m(t,null),s=!0},p(e,[t]){n&&n.p&&1&t&&h(n,o,e,e[0],t,null,null)},i(e){s||(xe(n,e),s=!0)},o(e){we(n,e),s=!1},d(e){e&&k(t),n&&n.d(e)}}}function St(e,t,s){let{$$slots:o={},$$scope:n}=t;return e.$$set=e=>{"$$scope"in e&&s(0,n=e.$$scope)},[n,o]}class Mt extends Te{constructor(e){super(),Pe(this,e,St,It,a,{})}}function At(e){let t,s,o,n;const r=e[2].default,i=u(r,e,e[1],null);return{c(){t=E("button"),i&&i.c(),T(t,"class","svelte-1dsxcgu"),O(t,"danger","danger"==e[0])},m(r,a){L(r,t,a),i&&i.m(t,null),s=!0,o||(n=C(t,"click",e[3]),o=!0)},p(e,[s]){i&&i.p&&2&s&&h(i,r,e,e[1],s,null,null),1&s&&O(t,"danger","danger"==e[0])},i(e){s||(xe(i,e),s=!0)},o(e){we(i,e),s=!1},d(e){e&&k(t),i&&i.d(e),o=!1,n()}}}function Ct(e,t,s){let{$$slots:o={},$$scope:n}=t,{variant:r}=t;return e.$$set=e=>{"variant"in e&&s(0,r=e.variant),"$$scope"in e&&s(1,n=e.$$scope)},[r,n,o,function(t){X(e,t)}]}class Pt extends Te{constructor(e){super(),Pe(this,e,Ct,At,a,{variant:0})}}function Tt(e,t,s){const o=e.slice();return o[3]=t[s],o}function jt(e){let t,s;return{c(){t=I("svg"),s=I("path"),T(s,"d","M24 20.188l-8.315-8.209 8.2-8.282-3.697-3.697-8.212 8.318-8.31-8.203-3.666 3.666 8.321 8.24-8.206 8.313 3.666 3.666 8.237-8.318 8.285 8.203z"),T(t,"xmlns","http://www.w3.org/2000/svg"),T(t,"width","10"),T(t,"height","10"),T(t,"viewBox","0 0 24 24")},m(e,o){L(e,t,o),_(t,s)},d(e){e&&k(t)}}}function Nt(e){let t,s,o,n,r,i,a=e[3].props.label+"";return r=new Pt({props:{$$slots:{default:[jt]},$$scope:{ctx:e}}}),r.$on("click",(function(...t){return e[1](e[3],...t)})),{c(){t=E("span"),s=S(a),o=M(),n=E("div"),Me(r.$$.fragment),T(t,"class","label svelte-1686zzt"),T(n,"class","actions")},m(e,a){L(e,t,a),_(t,s),L(e,o,a),L(e,n,a),Ae(r,n,null),i=!0},p(t,o){e=t,(!i||1&o)&&a!==(a=e[3].props.label+"")&&N(s,a);const n={};128&o&&(n.$$scope={dirty:o,ctx:e}),r.$set(n)},i(e){i||(xe(r.$$.fragment,e),i=!0)},o(e){we(r.$$.fragment,e),i=!1},d(e){e&&k(t),e&&k(o),e&&k(n),Ce(r)}}}function Dt(t){let s;return{c(){s=S("No component")},m(e,t){L(e,s,t)},p:e,i:e,o:e,d(e){e&&k(s)}}}function Rt(e){let t,o,n;const r=[e[3].props];var i=e[3].component;function a(e){let t={};for(let e=0;e<r.length;e+=1)t=s(t,r[e]);return{props:t}}return i&&(t=new i(a())),{c(){t&&Me(t.$$.fragment),o=A()},m(e,s){t&&Ae(t,e,s),L(e,o,s),n=!0},p(e,s){const n=1&s?Ee(r,[Ie(e[3].props)]):{};if(i!==(i=e[3].component)){if(t){ve();const e=t;we(e.$$.fragment,1,0,(()=>{Ce(e,1)})),ye()}i?(t=new i(a()),Me(t.$$.fragment),xe(t.$$.fragment,1),Ae(t,o.parentNode,o)):t=null}else i&&t.$set(n)},i(e){n||(t&&xe(t.$$.fragment,e),n=!0)},o(e){t&&we(t.$$.fragment,e),n=!1},d(e){e&&k(o),t&&Ce(t,e)}}}function Ot(e){let t,s,o,n,r,i,a,l,c,u,p;o=new Mt({props:{$$slots:{default:[Nt]},$$scope:{ctx:e}}});const h=[Rt,Dt],d=[];function f(e,t){return e[3].component?0:1}function m(...t){return e[2](e[3],e[6],...t)}return i=f(e),a=d[i]=h[i](e),{c(){t=E("div"),s=E("div"),Me(o.$$.fragment),n=M(),r=E("div"),a.c(),l=M(),T(s,"class","controls svelte-1686zzt"),T(r,"class","content-window svelte-1686zzt"),T(t,"class","window svelte-1686zzt"),D(t,"--scale",e[3].props.zoom),D(t,"--width",e[3].props.width),D(t,"--height",e[3].props.height)},m(e,a){L(e,t,a),_(t,s),Ae(o,s,null),_(t,n),_(t,r),d[i].m(r,null),L(e,l,a),c=!0,u||(p=C(t,"mousewheel",P(m)),u=!0)},p(s,n){e=s;const l={};129&n&&(l.$$scope={dirty:n,ctx:e}),o.$set(l);let u=i;i=f(e),i===u?d[i].p(e,n):(ve(),we(d[u],1,1,(()=>{d[u]=null})),ye(),a=d[i],a?a.p(e,n):(a=d[i]=h[i](e),a.c()),xe(a,1),a.m(r,null)),(!c||1&n)&&D(t,"--scale",e[3].props.zoom),(!c||1&n)&&D(t,"--width",e[3].props.width),(!c||1&n)&&D(t,"--height",e[3].props.height)},i(e){c||(xe(o.$$.fragment,e),xe(a),c=!0)},o(e){we(o.$$.fragment,e),we(a),c=!1},d(e){e&&k(t),Ce(o),d[i].d(),e&&k(l),u=!1,p()}}}function Bt(e,t){let s,o,n;return o=new Et({props:{minTop:"40",clamp:!0,$$slots:{default:[Ot,({focus:e})=>({6:e}),({focus:e})=>e?64:0]},$$scope:{ctx:t}}}),{key:e,first:null,c(){s=A(),Me(o.$$.fragment),this.first=s},m(e,t){L(e,s,t),Ae(o,e,t),n=!0},p(e,s){t=e;const n={};129&s&&(n.$$scope={dirty:s,ctx:t}),o.$set(n)},i(e){n||(xe(o.$$.fragment,e),n=!0)},o(e){we(o.$$.fragment,e),n=!1},d(e){e&&k(s),Ce(o,e)}}}function Ht(e){let t,s,o=[],n=new Map,r=e[0];const i=e=>e[3];for(let t=0;t<r.length;t+=1){let s=Tt(e,r,t),a=i(s);n.set(a,o[t]=Bt(a,s))}return{c(){for(let e=0;e<o.length;e+=1)o[e].c();t=A()},m(e,n){for(let t=0;t<o.length;t+=1)o[t].m(e,n);L(e,t,n),s=!0},p(e,[s]){1&s&&(r=e[0],ve(),o=ze(o,s,i,1,e,r,n,t.parentNode,Le,Bt,t,Tt),ye())},i(e){if(!s){for(let e=0;e<r.length;e+=1)xe(o[e]);s=!0}},o(e){for(let e=0;e<o.length;e+=1)we(o[e]);s=!1},d(e){for(let t=0;t<o.length;t+=1)o[t].d(e);e&&k(t)}}}const qt=Ne([]);function Ft(e,t,s){let o;c(e,qt,(e=>s(0,o=e)));return[o,(e,t)=>{return s=e,void qt.update((e=>e.filter((e=>e!==s))));var s},(e,t,s)=>((e,t,s)=>{s&&s(),qt.update((s=>{const o=s.indexOf(t),n=s[o];return n.props.zoom=Math.min(Math.max(n.props.zoom+(e.deltaY>0?-1:1),2),5),s}))})(s,e,t)]}class Kt extends Te{constructor(e){super(),Pe(this,e,Ft,Ht,a,{})}}const Gt={startPage:"/graphics/spritesheets",isDev:"localhost"==location.hostname||globalThis.electron},Jt=Gt.isDev?"/":"/NESBitStudio-web";var Ut={project:{save:{mimetype:"nesbit/project",extension:"nesbitproject",version:3}},palettes:{save:{mimetype:"nesbit/palette",extension:"nesbitpalette",version:2},export:{mimetype:"text/plain",extension:"",version:1}},spritesheets:{save:{mimetype:"nesbit/spritesheet",extension:"nesbitspritesheet",version:3},export:{mimetype:"text/plain",extension:"",version:2}},tilemaps:{save:{mimetype:"nesbit/tilemap",extension:"nesbittilemap",version:1},export:{mimetype:"text/plain",extension:"s",version:1}},settings:{save:{mimetype:"nesbit/settings",extension:"nesbitsettings",version:2}}};const Vt=e=>{const t=qe.find((t=>t.hex==e));if(t)return t},Yt=Vt("0F");let Wt=1;class Zt{constructor(e,t){if(this.label=e||"",this.colors=[],this.uuid=++Wt,Array.isArray(t)&&4==t.length)for(const e of t)this.addColor(e.hex);else this.colors=[...Array(4).fill("").map((e=>({...Yt})))]}addColor(e){if(!(this.colors.length<4))throw new Error("Max 4 colors per 'ColorPaletteGroup'");const t=Vt(e);t&&this.colors.push({...t})}}const Xt=vt(0,(({store:e,get:t})=>({setActiveColorIndex(t){if(!Number.isInteger(t))throw new Error("Invalid 'setActiveColorIndex' value. Expecting 'Integer'");if(!(t>=0&&t<=4))throw new Error("Invalid 'setActiveColorIndex' number range. Expecting number between '0-4'");e.set(t)},getActiveColorIndex:()=>t(),getActiveColorValue(e){const s=es.stores.activeLayer.get();if(!s)throw new Error("No 'activeLayer' selected");return Number.isInteger(e)||(e=t()),s.colors[e]}}))),Qt=vt([],(({store:e,value:t,get:s,update:o})=>({clear(){es.stores.activeLayer.set(void 0),e.set([])},swapLayers(t,s){e.update((e=>e[t]&&e[s]?([e[t],e[s]]=[e[s],e[t]],es.stores.activeLayer.set(e[s]),e):e))},replaceColor(t){e.update((e=>{const s=e[t.layerIndex],o=Vt(t.hex);return s.colors[t.colorIndex]={hex:o.hex,rgb:o.rgb},es.makeLayerActive(e[t.layerIndex]),e}))},swapColors(t){e.update((e=>{es.update();const s=e[t.layerIndex].colors,o=e[t.to.layerIndex].colors;let n=s[t.colorIndex],r=o[t.to.colorIndex];return s[t.colorIndex]={...Vt(r.hex)},o[t.to.colorIndex]={...Vt(n.hex)},es.makeLayerActive(e[t.to.layerIndex]),e}))}}))),es=vt({selectedColor:Xt,activeLayer:vt(),layers:Qt},(({store:e,value:t,get:s})=>({lastChanged:vt(),stores:t,update(){es.lastChanged.set(Math.random()+Date.now())},createLayer({label:e,colors:s}={},o=!1){t.layers.update((t=>{e=e||"palette_"+(t.length+1);const n=new Zt(e,s);return t=o?[...t,n]:[n,...t],es.makeLayerActive(n),t}))},removeLayer(e){t.layers.update((s=>{const o=s.indexOf(e);return e==t.activeLayer.get()&&(s[o+1]?es.makeLayerActive(s[o+1]):s[o-1]?es.makeLayerActive(s[o-1]):t.activeLayer.set(void 0)),s.splice(o,1),s}))},cloneLayer(e){t.layers.update((t=>{let{label:s,colors:o}=e;s+=" copy";const n=new Zt(s,o);return t=[n,...t],es.makeLayerActive(n),t}))},cloneActiveLayer(){const e=t.activeLayer.get();e?es.cloneLayer(e):es.createLayer()},makeLayerActive(e){if(!(e instanceof Zt))throw new Error("Invalid 'ColorPaletteGroupInstance' while setting 'activeLayer'");t.activeLayer.set(e)},layerIndexFromSource(e){if(!(e instanceof Zt))throw new Error("Invalid 'ColorPaletteGroupInstance' in 'layerIndexFromSource'");return t.layers.get().indexOf(e)},updateLayerLabel(e,s){t.layers.update((t=>(e.label=s,es.makeLayerActive(e),t)))},import(e,t){const s=es.stores.layers.get().length<=0,o=t?e:JSON.parse(e);if(o.version==Ut.palettes.save.version)for(const e of o.data)es.createLayer({...e},!0);s&&es.stores.layers.length&&es.makeLayerActive(es.stores.layers.get()[0])},export(e){const t=es.stores.layers.get();let s={version:Ut.palettes.save.version,data:[...t]};return e&&(s=JSON.stringify(s)),s},exportASMString(e="palettes"){const t=es.stores.layers.get();let s=0;const o=[];for(;s<t.length;){const e=t[s];o.push(`; ${e.label}\n.byte ${e.colors.map((e=>"$"+e.hex)).join(",")}`),s++}return`${e}:\n${o.join("\n")}`},clear(){es.stores.activeLayer.set(void 0),es.stores.layers.set([])}}))),ts=(e,t)=>{const s=e?e.length:0;if(s<1)return[];const o=new Array(Math.ceil(s/t));let n=0,r=0;for(;n<s;)o[r++]=e.slice(n,n+=t);return o},ss=e=>(e=Number(e>>>0).toString(2),"00000000".substring(e.length)+e);function os(e,t){let s=Number(e);return Number(t)&&(s=2),Number(e)+Number(t)>1&&(s=3),s}const ns=({width:e,height:t})=>{const s=document.createElement("canvas"),o=s.getContext("2d");return s.width=e,s.height=t,{element:s,context:o,width:e,height:t}},rs=(e,t=null)=>{if("function"!=typeof e)throw new Error("Invalid callback function.");let s,o=!1,n=0,r=performance.now();const i=e=>cancelAnimationFrame(s),a=e=>o=!0,l=e=>o=!1,c=u=>{if(s=requestAnimationFrame(c),o)return;const p=u-r,h=performance.now();(!t||h-r>1e3/t)&&(e.call(null,{delta:p/1e3,frame:++n,cancel:i,time:u,pause:a,play:l}),r=u)};return s=requestAnimationFrame(c),{unsubscribe:i,pause:a,play:l,toggle:e=>o=!o}};class is{constructor(){this.future=[],this.past=[],this.present}get last(){return this.present}setPresent(e){this.future=[],this.present=JSON.parse(JSON.stringify(e))}push(e){this.past.push(JSON.parse(JSON.stringify(e)))}undo(){if(this.past.length){const e=this.past.pop();this.future.push(this.present),this.present=e}return this.present}redo(){if(this.future.length){const e=this.future.pop();this.push(this.present),this.present=e}return this.present}}class as{constructor({label:e,width:t,height:s,data:o,colorAttributes:n,uuid:r}={}){this._isInitialized=!1,this.uuid=r||Math.random()+Date.now(),this.width=t||128,this.height=s||128,this.label=e||"",this.element=document.createElement("canvas"),this.element.width=this.width,this.element.height=this.height,this.context=this.element.getContext("2d"),this.image=new Image,this.data=o,this.history=new is,this.colorAttributes=n,this.colorAttributes||(this.colorAttributes=new Array(16).fill().map((e=>new Array(16).fill().map((e=>null))))),this.data?this._isInitialized||this.drawFromSource(es.stores.activeLayer.get()):this.data=new Array(16).fill().map((e=>new Array(16).fill().map((e=>new Array(8).fill().map((e=>new Array(8).fill().map((e=>0))))))))}updateImageSource(){return this.image.src=this.element.toDataURL("image/png",.1)}setPresent(e){this.history.setPresent(e||this.data)}forceUpdate(e){this.drawFromSource(es.stores.activeLayer.get(),e)}async toDataURL(e="image/png",t){return await fetch(this.element.toDataURL(e,t)).then((e=>e.blob()))}colorIndexAtPosition(e,t){const s=this.data,o=Math.floor(e/8),n=e%8,r=t%8;return s[Math.floor(t/8)][o][r][n]}setColorIndexAtPosition(e,t,s){const o=this.data,n=Math.floor(e/8),r=e%8,i=t%8;o[Math.floor(t/8)][n][i][r]=s}saveHistory(){this.history.push(this.data)}undo(){const e=this.history.undo();e&&(this.data=e,this.drawFromSource(es.stores.activeLayer.get()))}redo(){const e=this.history.redo();e&&(this.data=e,this.drawFromSource(es.stores.activeLayer.get()))}drawFromSource(e,t){e&&(this._isInitialized||(this._isInitialized=!0),this.data.map(((s,o)=>{s.map(((s,n)=>{this.context.save(),this.context.translate(8*n,8*o);let r,i=(t||ms.stores.activeLayer.get())?.colorAttributes[n][o];i&&(r=i),s.map(((t,s)=>{this.context.save(),this.context.translate(0,s),t.map(((t,s)=>{this.context.save(),this.context.translate(s,0);let o=(r||e).colors[t];o&&(this.context.fillStyle=`rgb(${o.rgb})`,this.context.fillRect(0,0,1,1),this.context.restore())})),this.context.restore()})),this.context.restore()}))})))}clear(){this.context.clearRect(0,0,this.element.width,this.element.height)}}const ls=ns({width:128,height:128}),cs=vt(void 0,(({store:e,value:t,get:s})=>({set(t){Number.isInteger(t.x)&&Number.isInteger(t.y)&&e.set(t)}}))),us=vt(void 0,(({store:e,value:t,get:s})=>({set(t){Number.isInteger(t.x)&&Number.isInteger(t.y)&&e.set(t)}}))),ps=vt({current:cs,fallback:us},(({store:e,value:t,get:s})=>({stores:t}))),hs=vt([],(({store:e,value:t,get:s})=>({swapLayers(t,s){e.update((e=>e[t]&&e[s]?([e[t],e[s]]=[e[s],e[t]],ms.stores.activeLayer.set(e[s]),e):e))}}))),ds=vt(void 0),fs=vt({defaultZoom:4,zoom:4,offset:{x:0,y:0}},(({store:e,value:t,get:s})=>({zoom(e){(e=t.zoom+e)<=0&&(e=Math.max(1,e)),fs.update((t=>(t.zoom=e,t)))},zoomReset(){fs.update((e=>(e.zoom=e.defaultZoom,e)))}}))),ms=vt({activeLayer:ds,layers:hs,selectedTile:ps,artboard:fs},(({store:e,value:t,get:s})=>({data:{width:128,height:128},stores:t,createLayer({label:e,data:t,colorAttributes:s,uuid:o}={}){ms.stores.layers.update((n=>{e=e||"spritesheet_"+(n.length+1);const r=new as({label:e,data:t,colorAttributes:s,uuid:o}),i=[r,...n];return ms.makeLayerActive(r),i}))},removeLayer(e){ms.stores.layers.update((t=>{let s=[...t];const o=s.indexOf(e);return e==ms.stores.activeLayer.get()&&(s[o+1]?ms.makeLayerActive(s[o+1]):s[o-1]?ms.makeLayerActive(s[o-1]):ms.stores.activeLayer.set(void 0)),s=s.filter((t=>t!=e)),s}))},cloneLayer(e){ms.stores.layers.update((t=>{let{width:s,height:o,label:n,data:r,colorAttributes:i}=e;Array.isArray(r)&&(r=JSON.parse(JSON.stringify(r)),i=JSON.parse(JSON.stringify(i))),n+=" copy";const a=new as({width:s,height:o,label:n,data:r,colorAttributes:i});return t=[a,...t],ms.makeLayerActive(a),t}))},cloneActiveLayer(){const e=ms.stores.activeLayer.get();e?ms.cloneLayer(e):ms.createLayer()},makeLayerActive(e){if(!(e instanceof as))throw new Error("Invalid 'CanvasLayerInstance' while setting 'activeLayer'");ms.stores.activeLayer.set(e),e.forceUpdate()},updateLayerLabel(e,t){ms.stores.layers.update((s=>(e.label=t,s)))},import(e,t){const s=t?e:JSON.parse(e);if(s.version==Ut.spritesheets.save.version)for(const e of[...s.data.spritesheets.layers].reverse())ms.createLayer({...e});else console.warn("Invalid file version.")},export(e){const t=JSON.parse(JSON.stringify(ms.stores.layers.get())).map((e=>({label:e.label,data:e.data,colorAttributes:e.colorAttributes,uuid:e.uuid})));let s={version:Ut.spritesheets.save.version,data:{spritesheets:{layers:t}}};return e&&(s=JSON.stringify(s)),s},importCHR(e){(e=>{const t=ts(new Uint8Array(e),16);let s=[];for(let e of t){let t,o,n=[];for(let s=8;s<16;s++){t=ss(e[s-8]),o=ss(e[s]);const r=[];for(let e=0;e<8;e++){const s=os(t[e],o[e]);r.push(s)}n.push(r)}s.push(n)}return s=ts(s,16),ts(s,16)})(e).forEach((e=>ms.createLayer({data:e})))},exportCHR(){const e=ms.stores.activeLayer.get();if(!e||!e.data)throw new Error("Unable to export CHR. No 'activeLayer'");const t=(e=>{const t=[0,85,170,255],s=new ArrayBuffer(4096),o=new Uint8Array(s);let n="";for(let s of e)for(let e of s){let s="",o="";for(let n of e)for(let e of n){const n=t[e];s+=1&n,o+=n>>1&1}n+=s+o}return n.match(/.{8}/g).map(((e,t)=>o[t]=parseInt(e,2))),o})(e.data);return{label:e.label,data:t}},exportAsImage(e,t="image/png",s=1){const o=ms.stores.activeLayer.get();if(!(o instanceof as))throw new Error("Unable to export Image. No 'activeLayer'");const n=128*ms.stores.artboard.get().zoom;return ls.context.clearRect(0,0,n,n),ls.element.width=n,ls.element.height=n,ls.context.imageSmoothingEnabled=!1,ls.context.drawImage(o.element,0,0,128,128,0,0,n,n),{label:o.label,image:ls.element.toBlob((n=>{const r=new FileReader;r.readAsArrayBuffer(n),r.onloadend=i=>{e.call(null,{blob:n,buffer:r.result,label:o.label,options:{mimetype:t,quality:s}})}}),t,s),options:{type:t}}},exportNametableData(e="nametable"){const t=new Array(30).fill(new Array(32).fill(0)),s=ms.stores.activeLayer.get(),o=[];let n,r=0;for(const e in t)for(const i in t[e])n=s.data[e]&&s.data[e][i]?r++:0,o.push(Ge(n,2));const i=[...o],a=ts(i,32);let l=`${e}:\n`;return a.forEach((e=>{l+=`.byte ${e.map((e=>"$"+e)).join(", ")}\n`})),l+="\n\n\n; color the background tiles\nattribute_table:\n; 7654 3210\n; |||| ||++- Color bits 3-2 for top left quadrant of this byte\n; |||| ++--- Color bits 3-2 for top right quadrant of this byte\n; ||++------ Color bits 3-2 for bottom left quadrant of this byte\n; ++-------- Color bits 3-2 for bottom right quadrant of this byte\n.byte %00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000\n.byte %00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000\n.byte %00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000\n.byte %00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000\n.byte %00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000\n.byte %00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000\n.byte %00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000\n.byte %00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000\n\n      ",l},clear(){ms.stores.activeLayer.set(void 0),ms.stores.layers.set([])}})));ms.stores;class gs{constructor({label:e,width:t,height:s,data:o,colorAttributes:n,uuid:r}){this._isInitialized=!1,this.uuid=r||Math.random()+Date.now(),this.width=t||256,this.height=s||240,this.label=e||"",this.element=document.createElement("canvas"),this.element.width=this.width,this.element.height=this.height,this.context=this.element.getContext("2d"),this.image=new Image,this.data=o,this.colorAttributes=n,this.colorAttributes||(this.colorAttributes=new Array(30).fill().map((e=>new Array(32).fill().map((e=>null))))),this.data||(this.data=new Array(30).fill().map((e=>new Array(32).fill().map((e=>{})))))}forceUpdate(e){this.drawFromSource(es.stores.activeLayer.get(),e)}drawFromSource(){this.context.save();for(const e in this.data)for(const t in this.data[e]){if(!this.data[e][t])continue;const{x:s,y:o,uuid:n}=this.data[e][t];if(!Number.isInteger(s)||!Number.isInteger(o))continue;const r=ms.stores.layers.get().find((e=>e.uuid==n));if(!r?.element)return;this.context.drawImage(r.element,8*s,8*o,8,8,8*t,8*e,8,8),this.data[e][t]={x:s,y:o,uuid:n}}}}const $s=vt([],(({store:e,value:t,get:s})=>({swapLayers(t,s){e.update((e=>e[t]&&e[s]?([e[t],e[s]]=[e[s],e[t]],ys.stores.activeLayer.set(e[s]),e):e))}}))),vs=vt(void 0),ys=vt({activeLayer:vs,layers:$s},(({store:e,value:t,get:s})=>({stores:t,createLayer({label:e,data:t,colorAttributes:s}={}){ys.stores.layers.update((o=>{e=e||"tilemap_"+(o.length+1);const n=new gs({label:e,data:t,colorAttributes:s}),r=[n,...o];return ys.makeLayerActive(n),r}))},removeLayer(e){ys.stores.layers.update((t=>{let s=[...t];const o=s.indexOf(e);return e==ys.stores.activeLayer.get()&&(s[o+1]?ys.makeLayerActive(s[o+1]):s[o-1]?ys.makeLayerActive(s[o-1]):ys.stores.activeLayer.set(void 0)),s=s.filter((t=>t!=e)),s}))},cloneLayer(e){ys.stores.layers.update((t=>{let{width:s,height:o,label:n,data:r,colorAttributes:i}=e;Array.isArray(r)&&(r=JSON.parse(JSON.stringify(r)),i=JSON.parse(JSON.stringify(i))),n+=" copy";const a=new gs({width:s,height:o,label:n,data:r,colorAttributes:i});return t=[a,...t],ys.makeLayerActive(a),t}))},cloneActiveLayer(){const e=ys.stores.activeLayer.get();e?ys.cloneLayer(e):ys.createLayer()},makeLayerActive(e){if(!(e instanceof gs))throw new Error("Invalid 'TilemapsLayerInstance' while setting 'activeLayer'");ys.stores.activeLayer.set(e)},updateLayerLabel(e,t){ys.stores.layers.update((s=>(e.label=t,s)))},import(e,t){const s=t?e:JSON.parse(e);if(s.version==Ut.tilemaps.save.version)for(const e of[...s.data.layers].reverse())ys.createLayer({...e});else console.warn("Invalid file version.")},export(e){const t=JSON.parse(JSON.stringify(ys.stores.layers.get())).map((e=>({label:e.label,data:e.data,colorAttributes:e.colorAttributes})));let s={version:Ut.tilemaps.save.version,data:{layers:t}};return e&&(s=JSON.stringify(s)),s},importCHR(e){chr.parse(e).forEach((e=>ys.createLayer({data:e})))},exportCHR(){const e=ys.stores.activeLayer.get();if(!e||!e.data)throw new Error("Unable to export CHR. No 'activeLayer'");const t=chr.generateExport(e.data);return{label:e.label,data:t}},exportAsImage(e,t="image/png",s=1){const o=ys.stores.activeLayer.get();if(!(o instanceof gs))throw new Error("Unable to export Image. No 'activeLayer'");return{label:o.label,image:o.element.toBlob((n=>{e.call(null,{blob:n,label:o.label,options:{mimetype:t,quality:s}})}),t,s),options:{type:t}}},exportNametableData(e){const t=ys.stores.activeLayer.get();e=e||t.label||"nametable";const s=[...t.data].flat().map(((e,t)=>Ge(e?.x&&e?.y?16*e.y+e.x:0,2))),o=ts(s,32);let n=`${e}:\n`;return o.forEach((e=>n+=`.byte ${e.map((e=>"$"+e)).join(", ")}\n`)),n+="\n\n\n; color the background tiles\nattribute_table:\n; 7654 3210\n; |||| ||++- Color bits 3-2 for top left quadrant of this byte\n; |||| ++--- Color bits 3-2 for top right quadrant of this byte\n; ||++------ Color bits 3-2 for bottom left quadrant of this byte\n; ++-------- Color bits 3-2 for bottom right quadrant of this byte\n.byte %00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000\n.byte %00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000\n.byte %00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000\n.byte %00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000\n.byte %00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000\n.byte %00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000\n.byte %00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000\n.byte %00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000\n\n      ",n},clear(){ys.stores.activeLayer.set(void 0),ys.stores.layers.set([])}}))),xs=vt({path:void 0},(({store:e,value:t,get:s,set:o})=>({create(){xs.set({path:void 0}),qt.set([]),es.clear(),ms.clear(),ys.clear()},open(e,t){try{if((t=JSON.parse(t)).project.version!==Ut.project.save.version)throw new Error(`Invalid project version. Trying to load project file with version '${t.project.version}' but expecting '${Ut.project.save.version}'`);xs.set({path:e}),ms.clear(),es.clear(),ys.clear(),es.import(t.palettes,!0),ms.import(t.spritesheets,!0),ys.import(t.tilemaps,!0)}catch(e){throw new Error(e)}},export(e){const t=s(),o=ms.export(),n=es.export(),r=ys.export(),i={project:{...t,version:Ut.project.save.version},spritesheets:o,palettes:n,tilemaps:r};return e?JSON.stringify(i):i}}))),ws=new dt("pointer","pen","paintbucket","eyedropper","colorswap","transform","marquee","zoom","preview","tileswap","preview_region","tilecolor","colorattribute","brush");class bs{constructor(e){this.icon="",this.offset={x:0,y:0},this.size={width:11,height:11},this.scale={x:1,y:1},Object.assign(this,e)}}class _s{constructor(e){this.visible_in_toolbar=!0,this.pixelIndicator=!1,this.singleAction=!1}get optionsPanelComponent(){}onMount(){}onDestroy(){}primary(){}secondary(){}move(){}mouseup(){}reset(){}}class Ls{constructor(){this.canvas=document.createElement("canvas"),this.canvas.width=128,this.canvas.height=128,this.context=this.canvas.getContext("2d")}render(){console.log("Render not implemented")}}const ks=e=>`rgb(${e.join(",")})`;const zs=Object.freeze({primary:1,secondary:2,move:3,mouseup:4}),Es=new class extends Ls{constructor(...e){super(...e),this.width=128,this.height=128,this.size=1,this.x,this.y}render(){isNaN(this.x)||isNaN(this.y)||(this.context.clearRect(0,0,this.width,this.height),this.context.globalAlpha=.4,this.context.fillStyle="white",this.context.fillRect(this.x,this.y,this.size,this.size))}},Is=new class extends Ls{constructor(...e){super(...e),this.width=128,this.height=128,this.size=8,this.x,this.y,this.framecount=0,this.count=0,this.selected=[]}addSelectedTileItem(e,t){this.selected.push({x:e,y:t})}clearSelected(){this.selected=[]}draw(e,t,s){this.context.save(),e=Math.floor(e/8)*this.size,t=Math.floor(t/8)*this.size,this.context.globalAlpha=.85,this.context.strokeStyle=s,this.context.strokeRect(e,t,this.size-1,this.size-1),this.context.restore()}render(){let e=this.count%2==0?"rgba(255,255,255,.98)":"crimson";isNaN(this.x)||isNaN(this.y)||(this.framecount++%16==0&&this.count++,this.context.clearRect(0,0,this.width,this.height),this.context.save(),this.context.translate(.5,.5),this.selected.forEach((({x:e,y:t})=>{this.draw(e,t,this.count%2==0?"rgba(255,255,255,.98)":"crimson")})),this.draw(this.x,this.y,e),this.context.restore())}},Ss=new class extends Ls{constructor(...e){super(...e),this.width=128,this.height=128,this.size=8,this.start,this.end,this.selection,this.framecount=0,this.count=0,this.selectionIsVisible=!0}hasSelection(){return!!this.selection?.start&&!!this.selection?.end}removeSelection(){this.selection=void 0,this.start=void 0,this.end=void 0}addSelection({start:e,end:t}={}){e&&t||(e=this.start,t=this.end),this.selection={start:e,end:t}}draw({start:e,end:t,color:s="crimson",dash:o}){e&&t&&(t.x=Math.min(Math.max(t.x,0),this.width-1),t.y=Math.min(Math.max(t.y,0),this.width-1),this.context.save(),this.context.translate(.5,.5),this.context.globalAlpha=.8,o&&this.context.setLineDash(o),this.context.strokeStyle=s,this.context.strokeRect(e.x,e.y,t.x-e.x,t.y-e.y),this.context.restore())}render(){this.framecount++%16==0&&this.count++,this.context.clearRect(0,0,this.width,this.height),this.selectionIsVisible&&this.draw({...this.selection,color:this.count%2==0?"white":"crimson"}),this.draw({start:this.start,end:this.end,color:this.count%2==0?"white":"crimson"})}},Ms=new class extends Ls{constructor(...e){super(...e),this.width=128,this.height=128,this.size=8,this.start,this.end,this.selection,this.framecount=0,this.count=0,this.selectionIsVisible=!0}hasSelection(){return!!this.selection?.start&&!!this.selection?.end}removeSelection(){this.selection=void 0,this.start=void 0,this.end=void 0}addSelection({start:e,end:t}={}){e&&t||(e=this.start,t=this.end),this.selection={start:e,end:t}}draw({start:e,end:t,color:s="crimson",dash:o}){e&&t&&(t.x=Math.min(Math.max(t.x,0),this.width-1),t.y=Math.min(Math.max(t.y,0),this.width-1),this.context.save(),this.context.translate(.5,.5),this.context.globalAlpha=.8,o&&this.context.setLineDash(o),this.context.strokeStyle=s,this.context.strokeRect(e.x,e.y,t.x-e.x,t.y-e.y),this.context.restore())}render(){this.framecount++%16==0&&this.count++,this.context.clearRect(0,0,this.width,this.height),this.selectionIsVisible&&this.draw({...this.selection,color:this.count%2==0?"white":"crimson"}),this.draw({start:this.start,end:this.end,color:this.count%2==0?"white":"crimson"})}},As=new class extends Ls{constructor(...e){super(...e),this.width=128,this.height=128,this.size=8,this.alpha=.35,this.visible=!0}hide(){this.visible=!1}show(){this.visible=!0}toggle(){this.visible=!this.visible}render(){if(this.context.clearRect(0,0,this.width,this.height),!this.visible)return;const e=ms.stores.activeLayer.get().colorAttributes;if(e?.length)for(let t in e)for(let s in e[t]){const o=e[t][s]?.colors;if(!o?.length)continue;this.context.save(),this.context.globalAlpha=this.alpha,this.context.translate(t*this.size,s*this.size);const[n,r,i,a]=o;this.context.fillStyle=ks(n.rgb),this.context.fillRect(0,0,this.size/2,this.size/2),this.context.fillStyle=ks(r.rgb),this.context.fillRect(0,4,this.size/2,this.size/2),this.context.fillStyle=ks(i.rgb),this.context.fillRect(4,0,this.size/2,this.size/2),this.context.fillStyle=ks(a.rgb),this.context.fillRect(4,4,this.size/2,this.size/2),this.context.restore()}}},Cs=[new class extends Ls{constructor(...e){super(...e),this.width=128,this.height=128,this.size=8,this.o1=.05,this.o2=.005}render(){this.context.clearRect(0,0,this.width,this.height),this.context.globalAlpha=1;for(let e=0;e<=this.width/this.size;e++)for(let t=0;t<=this.height/this.size;t++)this.context.save(),this.context.translate(e*this.size,t*this.size),(e+t)%2==0?(this.context.globalAlpha=this.o1,this.context.fillStyle="white"):(this.context.globalAlpha=this.o2,this.context.fillStyle="black"),this.context.fillRect(0,0,this.size,this.size),this.context.restore()}}];class Ps{constructor({canvas:e,context:t,width:s,height:o}){this.activeLayer=void 0,this.activePaletteLayer=void 0,this.lastChanged=void 0,this.canvas,this.context,this.width=s,this.height=o;this.animationLoop=rs(this.render.bind(this),120),this.events={},this.eventHandler={};const n=(e,t)=>{switch(t.mouseIsDown=i,e){case zs.primary:r("primary",t);break;case zs.secondary:r("secondary",t);break;case zs.move:r("move",t);break;case zs.mouseup:r("mouseup",t);break;default:console.log("hmm...")}};const r=(e,t)=>{this.events[e]&&(t.realMousePosition=function(e,t){if(!e)return{x:0,y:0};const s=e.getBoundingClientRect(),o=e.width/s.width,n=e.height/s.height;return{x:Math.floor((t.clientX-s.left)*o),y:Math.floor((t.clientY-s.top)*n)}}(this.canvas,t),this.events[e].call(null,t))};let i=!1;this.eventHandler.mousemove=e=>{n(zs.move,e)},this.eventHandler.mouseup=e=>{i=!1,n(zs.mouseup,e)},this.eventHandler.mousedown=e=>{let t;if(i=!0,1==e.which)t=zs.primary;else{if(3!=e.which)return;t=zs.secondary}n(t,e)},document.addEventListener("mousemove",this.eventHandler.mousemove),document.addEventListener("mouseup",this.eventHandler.mouseup)}defineCanvas(e){this.canvas=e,this.context=this.canvas.getContext("2d"),this.canvas.addEventListener("mousedown",this.eventHandler.mousedown)}on(e,t){if("string"!=typeof e&&"function"!=typeof t)throw new Error("Invalid eventlistener");if(this.events[e])throw new Error(`Event already exists : ${e}`);this.events[e]=t}render(e){if(!this.canvas)return;this.context.clearRect(0,0,128,128);const t=ms.stores.activeLayer.get(),s=es.stores.activeLayer.get();t&&s&&(this.lastChanged==es.lastChanged.get()&&this.activeLayer==t&&this.activePaletteLayer==s||(this.activeLayer=t,this.activePaletteLayer=s,t.drawFromSource(s),this.lastChanged=es.lastChanged.get()),this.context.drawImage(t.element,0,0),Cs.forEach((t=>{t.render(e),this.context.drawImage(t.canvas,0,0)})),(qs.activeTool.get().cursorLayers||[]).forEach((t=>{t.render(e),this.context.drawImage(t.canvas,0,0)})))}destroy(){this.animationLoop.unsubscribe(),this.canvas&&this.canvas.removeEventListener("mousedown",this.eventHandler.mousedown),document.removeEventListener("mousemove",this.eventHandler.mousemove),document.removeEventListener("mouseup",this.eventHandler.mouseup)}}function Ts(t){let s;return{c(){s=E("canvas"),T(s,"width",t[0]),T(s,"height",t[1]),D(s,"--width",t[0]),D(s,"--height",t[1]),T(s,"class","svelte-p8cnhs")},m(e,o){L(e,s,o),t[5](s)},p(e,[t]){1&t&&T(s,"width",e[0]),2&t&&T(s,"height",e[1]),1&t&&D(s,"--width",e[0]),2&t&&D(s,"--height",e[1])},i:e,o:e,d(e){e&&k(s),t[5](null)}}}function js(e,t,s){let o,n,{offset:r}=t,{width:i=128}=t,{height:a=128}=t,{source:l}=t;return Y((()=>{let e;const{unsubscribe:t}=rs((({cancel:t})=>{if(l?.element){if(e=o?.getContext("2d"),e&&o){if(r&&l){const e=r.end.x-r.start.x,t=r.end.y-r.start.y;n=(({background:e,source:t,x:s,y:o,width:n,height:r})=>{const i=ns({width:n,height:r});return i.context.clearRect(0,0,n,r),e&&(i.context.fillStyle=e,i.context.fillRect(0,0,i.width,i.height)),i.context.drawImage(t.element,s,o,n,r,0,0,n,r),{pattern:e=>t.context.createPattern(i.element,"repeat"),...i}})({...r.start,source:l,width:e,height:t}),n.context.save(),n.context.globalCompositeOperation="screen",isNaN(Es.x)||isNaN(Es.y)||(n.context.fillStyle="rgba(255,255,255,.7)",Es.x>=r.start.x&&Es.x<=r.end.x&&Es.y>=r.start.y&&Es.y<=r.end.y&&n.context.fillRect(Je(Es.x,r.start.x,r.end.x,0,e),Je(Es.y,r.start.y,r.end.y,0,t),1,1)),n.context.restore()}n?.pattern?(e.save(),e.fillStyle=n.pattern(),e.fillRect(0,0,i,a),e.restore()):e.drawImage(l.element,0,0,i,a)}}else t()}),120);return()=>{t&&t()}})),e.$$set=e=>{"offset"in e&&s(3,r=e.offset),"width"in e&&s(0,i=e.width),"height"in e&&s(1,a=e.height),"source"in e&&s(4,l=e.source)},[i,a,o,r,l,function(e){ee[e?"unshift":"push"]((()=>{o=e,s(2,o)}))}]}class Ns extends Te{constructor(e){super(),Pe(this,e,js,Ts,a,{offset:3,width:0,height:1,source:4})}}function Ds(e){let t,s;return t=new Ns({props:{source:e[0],offset:e[2]}}),{c(){Me(t.$$.fragment)},m(e,o){Ae(t,e,o),s=!0},p(e,s){const o={};1&s&&(o.source=e[0]),4&s&&(o.offset=e[2]),t.$set(o)},i(e){s||(xe(t.$$.fragment,e),s=!0)},o(e){we(t.$$.fragment,e),s=!1},d(e){Ce(t,e)}}}function Rs(t){let s,o,n=t[0],r=Ds(t);return{c(){r.c(),s=A()},m(e,t){r.m(e,t),L(e,s,t),o=!0},p(t,[o]){1&o&&a(n,n=t[0])?(ve(),we(r,1,1,e),ye(),r=Ds(t),r.c(),xe(r),r.m(s.parentNode,s)):r.p(t,o)},i(e){o||(xe(r),o=!0)},o(e){we(r),o=!1},d(e){e&&k(s),r.d(e)}}}function Os(e,t,o){let n;const{activeLayer:r}=ms.stores;return c(e,r,(e=>o(0,n=e))),e.$$set=e=>{o(2,t=s(s({},t),d(e)))},t=d(t),[n,r,t]}class Bs extends Te{constructor(e){super(),Pe(this,e,Os,Rs,a,{})}}const Hs={pointer:new class extends _s{constructor(){super(),this.title="Pointer (V)",this.name="pointer",this.enum=ws.get("pointer"),this.weight=100,this.icon="M4 0l16 12.279-6.78 1.138 4.256 8.676-3.902 1.907-4.281-8.758-5.293 4.581z",this.cursor=new bs({})}primary({x:e,y:t,context:s}){}secondary({x:e,y:t,context:s}){}move({x:e,y:t,context:s}){}},pen:new class extends _s{constructor(){super(),this.cursorLayers=[Es],this.hotkeysGroups=["pen"],gt.set(["AltLeft"],{groups:this.hotkeysGroups}).on((e=>{ft.execute("spritesheet_set_active_tool",ws.get("eyedropper"))})).off((e=>{ft.execute("spritesheet_set_active_tool",ws.get("pen"))})),this.title="Pen (B)",this.name="pen",this.enum=ws.get("pen"),this.weight=90,this.icon="M19.769 9.923l-12.642 12.639-7.127 1.438 1.438-7.128 12.641-12.64 5.69 5.691zm1.414-1.414l2.817-2.82-5.691-5.689-2.816 2.817 5.69 5.692z",this.cursor=new bs({icon:"M19.769 9.923l-12.642 12.639-7.127 1.438 1.438-7.128 12.641-12.64 5.69 5.691zm1.414-1.414l2.817-2.82-5.691-5.689-2.816 2.817 5.69 5.692z",size:{width:46,height:46},offset:{x:0,y:11}}),this.properties={size:1,direction:void 0,drawStack:[],lastDraw:void 0,start:void 0},this.modifiedPixels=[]}paint(e){const t=ms.stores.activeLayer?.get().colorAttributes,s=ms.stores.activeLayer.get()?.context;s&&(this.properties.drawStack.map((o=>{const{x:n,y:r}=o.realMousePosition,i=Math.floor(n/8),a=Math.floor(r/8),l=Number.isInteger(e.colorIndex)?e.colorIndex:es.stores.selectedColor.get();let c=es.stores.selectedColor.getActiveColorValue(l);c&&(i>=0&&i<=15&&a>=0&&a<=15&&(c=t[i]&&t[i][a]&&t[i][a].colors[l]?t[i][a].colors[l]:c),s.save(),s.translate(n,r),s.fillStyle=`rgb(${c.rgb.join(",")})`,s.fillRect(0,0,this.properties.size,this.properties.size),this.modifiedPixels.push({x:n,y:r,colorIndex:l}),s.restore())})),this.properties.lastDraw=this.properties.drawStack.pop(),this.properties.drawStack=[])}primary(e,t){e.realMousePosition,e.shiftKey?this.drawLineFromPoint(e,{...e.realMousePosition}):this.properties.drawStack.push(e),this.paint.call(this,e)}secondary(e){e.colorIndex=0,this.primary(e)}drawLineFromPoint(e,t){if(!this.properties.start)return;let{x:s,y:o}=this.properties.start;if(Math.abs(t.x-s)>Math.abs(t.y-o))for(;s!=t.x;)s<t.x&&s++,s>t.x&&s--,this.properties.drawStack.push({...e,realMousePosition:{x:s,y:o}});else for(;o!=t.y;)o<t.y&&o++,o>t.y&&o--,this.properties.drawStack.push({...e,realMousePosition:{x:s,y:o}})}move(e){let{x:t,y:s}=e.realMousePosition;if(Es.x=t,Es.y=s,!e.mouseIsDown)return;this.properties.start=void 0;const o=e=>{if(this.properties.lastDraw){let{x:o,y:n}={...this.properties.lastDraw.realMousePosition};for(;o!=t||n!=s;)o<t&&o++,o>t&&o--,n<s&&n++,n>s&&n--,this.properties.drawStack.push({...e,realMousePosition:{x:o,y:n}})}else this.properties.drawStack.push(e)};1==e.which?(o(e),this.primary.call(this,e,!0)):3==e.which&&(o(e),this.secondary.call(this,e))}mouseup(){const e=ms.stores.activeLayer.get()?.data;if(!e)return;this.modifiedPixels.length&&ms.stores.activeLayer.get().saveHistory();for(const t of this.modifiedPixels){let{x:s,y:o,colorIndex:n}=t;const r={x:Math.floor(s/8),y:Math.floor(o/8)},i={x:s%8,y:o%8};e[r.y]&&e[r.y][r.x]&&e[r.y][r.x][i.y]&&Number.isInteger(e[r.y][r.x][i.y][i.x])&&(e[r.y][r.x][i.y][i.x]=n)}const t=this.modifiedPixels[this.modifiedPixels.length-1];t&&(this.properties.start={...t},ms.stores.activeLayer.get().setPresent()),this.modifiedPixels=[]}},eyedropper:new class extends _s{constructor(){super(),this.cursorLayers=[Es],this.title="Eyedropper (E)",this.name="eyedropper",this.enum=ws.get("eyedropper"),this.weight=95,this.icon="M12.142 13.178l1.506 1.318-6.83 7.6c-1.31 1.464-2.22.315-3.953 1.647-.232.178-.483.257-.724.257-.601 0-1.141-.49-1.141-1.151 0-.218.062-.455.196-.698.978-1.791-.129-2.629 1.148-4.052l6.787-7.555 1.505 1.317-3.727 4.139h2.691l2.542-2.822zm5.764-13.178c-2.434 0-4.871 1.707-4.797 5.831.021 1.167-.356 1.698-.884 1.698-.298 0-.597-.169-.877-.386-.407-.315-.99-.26-1.331.129-.374.426-.329 1.076.096 1.448l5.253 4.598c.423.371 1.067.328 1.438-.096.343-.392.32-.979-.049-1.345-.277-.275-.501-.581-.501-.913 0-.479.486-.876 1.572-1.002 3.69-.428 5.174-2.656 5.174-4.88 0-2.799-2.149-5.082-5.094-5.082z",this.cursor=new bs({icon:"M12.142 13.178l1.506 1.318-6.83 7.6c-1.31 1.464-2.22.315-3.953 1.647-.232.178-.483.257-.724.257-.601 0-1.141-.49-1.141-1.151 0-.218.062-.455.196-.698.978-1.791-.129-2.629 1.148-4.052l6.787-7.555 1.505 1.317-3.727 4.139h2.691l2.542-2.822zm5.764-13.178c-2.434 0-4.871 1.707-4.797 5.831.021 1.167-.356 1.698-.884 1.698-.298 0-.597-.169-.877-.386-.407-.315-.99-.26-1.331.129-.374.426-.329 1.076.096 1.448l5.253 4.598c.423.371 1.067.328 1.438-.096.343-.392.32-.979-.049-1.345-.277-.275-.501-.581-.501-.913 0-.479.486-.876 1.572-1.002 3.69-.428 5.174-2.656 5.174-4.88 0-2.799-2.149-5.082-5.094-5.082z",size:{width:46,height:46},offset:{x:0,y:10}})}primary(e){const{x:t,y:s}=e.realMousePosition,o=ms.stores.activeLayer.get().colorIndexAtPosition(t,s);Number.isInteger(o)&&es.stores.selectedColor.set(o)}secondary(e){}move(e){Es.x=e.realMousePosition.x,Es.y=e.realMousePosition.y}},paintbucket:new class extends _s{constructor(){super(),this.cursorLayers=[Es],this.hotkeysGroups=["paintbucket"],gt.set(["AltLeft"],{groups:this.hotkeysGroups}).on((e=>{ft.execute("spritesheet_set_active_tool",ws.get("eyedropper"))})).off((e=>{ft.execute("spritesheet_set_active_tool",ws.get("paintbucket"))})),this.title="Paintbucket (G)",this.name="paintbucket",this.enum=ws.get("paintbucket"),this.weight=80,this.icon="M24 19.007c0-3.167-1.409-6.771-2.835-9.301l-.006-.01-.014-.026c-.732-1.392-1.914-3.052-3.619-4.757-2.976-2.976-5.476-3.912-6.785-3.913-.413 0-.708.094-.859.245l-.654.654c-1.898-.236-3.42.105-4.294.982-.876.875-1.164 2.159-.792 3.524.242.893.807 1.891 1.752 2.836.867.867 2.062 1.684 3.615 2.327.488-.839 1.654-1.019 2.359-.315.586.586.584 1.533-.002 2.119s-1.533.589-2.121 0c-.229-.229-.366-.515-.416-.812-1.646-.657-3.066-1.534-4.144-2.612-.728-.728-1.289-1.528-1.664-2.349l-2.835 2.832c-.445.447-.685 1.064-.686 1.82.001 1.635 1.122 3.915 3.714 6.506 2.764 2.764 5.58 4.243 7.431 4.243.649 0 1.181-.195 1.548-.562l8.086-8.079c.911.875-.777 3.541-.777 4.65 0 1.104.896 1.999 2 1.998 1.104 0 1.998-.895 1.998-2zm-18.912-12.974c-.236-.978-.05-1.845.554-2.444.526-.53 1.471-.791 2.656-.761l-3.21 3.205zm9.138 2.341l-.03-.029c-1.29-1.291-3.802-4.354-3.095-5.062.715-.715 3.488 1.521 5.062 3.095.862.863 2.088 2.248 2.938 3.459-1.718-1.073-3.493-1.469-4.875-1.463zm-3.875 12.348c-.547-.082-1.5-.547-1.9-.928l7.086-7.086c.351.37 1.264.931 1.753 1.075l-6.939 6.939z",this.cursor=new bs({icon:"M24 19.007c0-3.167-1.409-6.771-2.835-9.301l-.006-.01-.014-.026c-.732-1.392-1.914-3.052-3.619-4.757-2.976-2.976-5.476-3.912-6.785-3.913-.413 0-.708.094-.859.245l-.654.654c-1.898-.236-3.42.105-4.294.982-.876.875-1.164 2.159-.792 3.524.242.893.807 1.891 1.752 2.836.867.867 2.062 1.684 3.615 2.327.488-.839 1.654-1.019 2.359-.315.586.586.584 1.533-.002 2.119s-1.533.589-2.121 0c-.229-.229-.366-.515-.416-.812-1.646-.657-3.066-1.534-4.144-2.612-.728-.728-1.289-1.528-1.664-2.349l-2.835 2.832c-.445.447-.685 1.064-.686 1.82.001 1.635 1.122 3.915 3.714 6.506 2.764 2.764 5.58 4.243 7.431 4.243.649 0 1.181-.195 1.548-.562l8.086-8.079c.911.875-.777 3.541-.777 4.65 0 1.104.896 1.999 2 1.998 1.104 0 1.998-.895 1.998-2zm-18.912-12.974c-.236-.978-.05-1.845.554-2.444.526-.53 1.471-.791 2.656-.761l-3.21 3.205zm9.138 2.341l-.03-.029c-1.29-1.291-3.802-4.354-3.095-5.062.715-.715 3.488 1.521 5.062 3.095.862.863 2.088 2.248 2.938 3.459-1.718-1.073-3.493-1.469-4.875-1.463zm-3.875 12.348c-.547-.082-1.5-.547-1.9-.928l7.086-7.086c.351.37 1.264.931 1.753 1.075l-6.939 6.939z",offset:{x:3.5,y:11},size:{width:46,height:46}}),this.properties={diagonals:!1}}fillPixelsInsideTile(e,t,s){const o=s>=0&&s<=3?s:es.stores.selectedColor.get(),n=Math.floor(e/8),r=Math.floor(t/8),i=ms.stores.activeLayer.get()?.data[r][n],a=ms.stores.activeLayer.get().colorIndexAtPosition(e,t);if(i){const s=[{x:e%8,y:t%8}];for(;s.length;){let{x:e,y:t}=s.shift(),n=t%8,r=e%8;if(e<0||e>7)continue;if(t<0||t>7)continue;const l=i[t][e];l!=o&&(l==a&&(i[n][r]=o,s.push({x:r,y:n+1}),s.push({x:r,y:n-1}),s.push({x:r-1,y:n}),s.push({x:r+1,y:n}),this.properties.diagonals&&(s.push({x:r+1,y:n+1}),s.push({x:r-1,y:n-1}),s.push({x:r+1,y:n-1}),s.push({x:r-1,y:n+1}))))}}ms.stores.activeLayer.get().forceUpdate()}fill(e,t,s){const o=s>=0&&s<=3?s:es.stores.selectedColor.get(),n=ms.stores.activeLayer.get().colorIndexAtPosition(e,t),r=[{x:e,y:t}];for(;r.length;){const{x:e,y:t}=r.shift();if(t<0||t>127)continue;if(e<0||e>127)continue;const s=ms.stores.activeLayer.get().colorIndexAtPosition(e,t);s!=o&&(s==n&&(ms.stores.activeLayer.get().setColorIndexAtPosition(e,t,o),r.push({x:e,y:t+1}),r.push({x:e,y:t-1}),r.push({x:e-1,y:t}),r.push({x:e+1,y:t}),this.properties.diagonals&&(r.push({x:e+1,y:t+1}),r.push({x:e-1,y:t-1}),r.push({x:e+1,y:t-1}),r.push({x:e-1,y:t+1}))))}ms.stores.activeLayer.get().forceUpdate()}primary(e){ms.stores.activeLayer.get().saveHistory();const{x:t,y:s}=e.realMousePosition;e.ctrlKey?this.fillPixelsInsideTile(t,s):this.fill(t,s),ms.stores.activeLayer.get().setPresent()}secondary(e){const{x:t,y:s}=e.realMousePosition;ms.stores.activeLayer.get().saveHistory(),e.ctrlKey?this.fillPixelsInsideTile(t,s,0):this.fill(t,s,0),ms.stores.activeLayer.get().setPresent()}move(e){Es.x=e.realMousePosition.x,Es.y=e.realMousePosition.y}},colorswap:new class extends _s{constructor(){super(),this.hotkeysGroups=["colorswap"],gt.set(["Escape"],{data:{action:ft.action("tool_action"),props:e=>this.properties.swappedColors=[]},groups:this.hotkeysGroups}),this.cursorLayers=[Es],this.title="Color swap (S)",this.name="colorswap",this.enum=ws.get("colorswap"),this.weight=60,this.icon="M1 12.155c2.256 3.97 4.55 7.918 6.879 11.845h-5.379c-.829 0-1.5-.675-1.5-1.5v-10.345zm2.85.859c3.278 1.952 12.866 7.658 13.121 7.805l-5.162 2.98c-.231.132-.49.201-.751.201-.549 0-1.037-.298-1.299-.75l-5.909-10.236zm1.9-12.813c-.23-.133-.489-.201-.75-.201-.524 0-1.026.277-1.299.75l-3.5 6.062c-.133.23-.201.489-.201.749 0 .527.278 1.028.75 1.3 2.936 1.695 14.58 8.7 17.516 10.396.718.413 1.633.168 2.048-.55l3.5-6.062c.133-.23.186-.488.186-.749 0-.52-.257-1.025-.734-1.3l-17.516-10.395m.25 3.944c1.104 0 2 .896 2 2s-.896 2-2 2-2-.896-2-2 .896-2 2-2",this.cursor=new bs({icon:"M12.142 13.178l1.506 1.318-6.83 7.6c-1.31 1.464-2.22.315-3.953 1.647-.232.178-.483.257-.724.257-.601 0-1.141-.49-1.141-1.151 0-.218.062-.455.196-.698.978-1.791-.129-2.629 1.148-4.052l6.787-7.555 1.505 1.317-3.727 4.139h2.691l2.542-2.822zm5.764-13.178c-2.434 0-4.871 1.707-4.797 5.831.021 1.167-.356 1.698-.884 1.698-.298 0-.597-.169-.877-.386-.407-.315-.99-.26-1.331.129-.374.426-.329 1.076.096 1.448l5.253 4.598c.423.371 1.067.328 1.438-.096.343-.392.32-.979-.049-1.345-.277-.275-.501-.581-.501-.913 0-.479.486-.876 1.572-1.002 3.69-.428 5.174-2.656 5.174-4.88 0-2.799-2.149-5.082-5.094-5.082z",size:{width:46,height:46},offset:{x:0,y:10}}),this.properties={swappedColors:[]}}primary(e){const{x:t,y:s}=e.realMousePosition;if(this.properties.swappedColors.push({column:Math.floor(t/8),row:Math.floor(s/8),x:t%8,y:s%8}),this.properties.swappedColors.length>1){const t=ms.stores.activeLayer;t.get().saveHistory(),t.update((s=>{const[o,n]=this.properties.swappedColors,r=[...s.data];let i=r[o.row][o.column][o.y][o.x],a=r[n.row][n.column][n.y][n.x];return i==a||(e.altKey?s.data[o.row][o.column].forEach(((e,t)=>{e.forEach(((e,n)=>{let r;e==i?r=a:e==a&&(r=i),Number.isInteger(r)&&(s.data[o.row][o.column][t][n]=r)}))})):r.forEach(((e,t)=>{e.forEach(((e,o)=>{e.forEach(((e,n)=>{e.forEach(((e,r)=>{let l;e==i?l=a:e==a&&(l=i),Number.isInteger(l)&&(s.data[t][o][n][r]=l)}))}))}))})),t.get().forceUpdate(),ms.stores.activeLayer.get().setPresent()),s})),this.properties.swappedColors=[]}}secondary(e){}move(e){Es.x=e.realMousePosition.x,Es.y=e.realMousePosition.y}},tileswap:new class extends _s{constructor(){super(),this.hotkeysGroups=["tileswap"];gt.set(["Escape"],{data:{action:ft.action("tool_action"),props:()=>{this.swappedTiles=[],Ss.removeSelection()}},groups:this.hotkeysGroups}),this.cursorLayers=[Ss],this.title="Transpose (T)",this.name="tileswap",this.enum=ws.get("tileswap"),this.weight=60,this.icon="M18 6v-6h-18v18h6v6h18v-18h-6zm-16 10v-14h14v4h-10v10h-4z",this.cursor=new bs({icon:"M24 10h-10v-10h-4v10h-10v4h10v10h4v-10h10z",size:{width:56,height:56},offset:{x:5,y:5}}),this.properties={start:void 0,end:void 0},this.mouseIsDown=!1,this.affected=[],this.swappedTiles=[]}primary(e){Ss.removeSelection(),this.mouseIsDown=e.mouseIsDown,this.properties.modifier=e.ctrlKey||e.altKey;let{x:t,y:s}=e.realMousePosition;const o=Math.floor(t/8),n=Math.floor(s/8),r=8*Math.floor(t/8),i=8*Math.floor(s/8);if(this.properties.start={x:r,y:i},Ss.start={x:r,y:i},Ss.end={x:r+7,y:i+7},this.swappedTiles.length>0){const e=ms.stores.activeLayer;let t=[];t.push(e.get()),this.swappedTiles.forEach((e=>{t.indexOf(e.ref)<0&&t.push(e.ref)})),t.forEach((e=>e.saveHistory())),e.update((e=>(this.swappedTiles.forEach((t=>{if(e.data[n+t.i]&&e.data[n+t.i][o+t.j]){const s=JSON.parse(JSON.stringify(e.data[n+t.i][o+t.j]));e.data[n+t.i][o+t.j]=t.data,this.properties.modifier||(t.ref.data[t.y][t.x]=s)}})),e))),t.forEach((e=>{e.forceUpdate(e),e.setPresent()})),t=[],this.properties.modifier=void 0,this.swappedTiles=[],Ss.removeSelection()}}secondary(e){this.properties.modifier=e?.ctrlKey||e?.altKey,this.swappedTiles=[],Ss.removeSelection(),this.properties={}}move(e){let{x:t,y:s}=e.realMousePosition;t=Math.max(0,8*Math.floor(t/8)),s=Math.max(0,8*Math.floor(s/8));let o={...this.properties.start},n={x:t,y:s};Ss.hasSelection()&&(o={x:t,y:s},n={x:t+Ss.selection.end.x-Ss.selection.start.x-7,y:s+Ss.selection.end.y-Ss.selection.start.y-7});const r=Math.min(n.x,o.x),i=Math.max(n.x,o.x),a=Math.min(n.y,o.y),l=Math.max(n.y,o.y);this.properties.end={x:i,y:l},Ss.start={x:r,y:a},Ss.end={x:this.properties.end.x+7,y:this.properties.end.y+7}}mouseup(e){this.mouseIsDown&&Ss.addSelection({start:Ss.start,end:Ss.end});const t=ms.stores.activeLayer;if(Ss.hasSelection()&&!this.swappedTiles.length){const e={x:Ss.selection.start.x/8,y:Ss.selection.start.y/8};if(this.properties.start&&this.properties.end){let s=Math.abs(Ss.start.x-Ss.end.x-1)/8,o=Math.abs(Ss.start.y-Ss.end.y-1)/8;const n=JSON.parse(JSON.stringify(t.get().data));for(let r=0;r<o;r++)for(let o=0;o<s;o++){const s={x:e.x+o,y:e.y+r,i:r,j:o,data:n[e.y+r][e.x+o],ref:t.get()};this.swappedTiles.push(s)}}}else if(this.mouseIsDown){const e=ms.stores.activeLayer.get();e.forceUpdate(),e.setPresent()}this.mouseIsDown=!1,this.properties={}}onDestroy(){this.secondary()}},transform:new class extends _s{constructor(){super(),this.cursorLayers=[Is],this.title="Transform (R)",this.name="transform",this.enum=ws.get("transform"),this.weight=55,this.icon="M18.885 3.515c-4.617-4.618-12.056-4.676-16.756-.195l-2.129-2.258v7.938h7.484l-2.066-2.191c2.82-2.706 7.297-2.676 10.073.1 4.341 4.341 1.737 12.291-5.491 12.291v4.8c3.708 0 6.614-1.244 8.885-3.515 4.686-4.686 4.686-12.284 0-16.97z",this.cursor=new bs({icon:"M24 10h-10v-10h-4v10h-10v4h10v10h4v-10h10z",size:{width:56,height:56},offset:{x:5,y:5}}),this.properties={modifier:void 0}}flipX(e){let{x:t,y:s}=e.realMousePosition;const o=Math.floor(t/8),n=Math.floor(s/8),r=ms.stores.activeLayer.get().data;r[n][o]=r[n][o].map((e=>e.reverse()))}flipY(e){this.rotate(e),this.rotate(e),this.flipX(e)}rotate(e){let{x:t,y:s}=e.realMousePosition;const o=Math.floor(t/8),n=Math.floor(s/8),r=ms.stores.activeLayer.get().data;this.properties.modifier?this.secondary(e):r[n][o]=r[n][o].map(((e,t)=>r[n][o].map((e=>e[t])).reverse()))}primary(e){ms.stores.activeLayer.get().saveHistory(),this.properties.modifier=e.ctrlKey||e.altKey,this.rotate(e),ms.stores.activeLayer.get().forceUpdate(),ms.stores.activeLayer.get().setPresent()}secondary(e){ms.stores.activeLayer.get().saveHistory(),this.properties.modifier=e.ctrlKey||e.altKey,this.properties.modifier?this.flipX(e):this.flipY(e),ms.stores.activeLayer.get().forceUpdate(),ms.stores.activeLayer.get().setPresent()}move(e){const{x:t,y:s}=e.realMousePosition;Is.x=t,Is.y=s}},colorattribute:new class extends _s{constructor(){super(),this.hotkeysGroups=["colorattribute"];const e=gt.set(["Tab"],{groups:this.hotkeysGroups});e.on((({e:e,Hotkey:t,on:s})=>As.toggle())),e.off((({e:e,Hotkey:t,on:s})=>As.toggle())),this.cursorLayers=[As,Is],this.title="Attribute table (A)",this.name="colorattribute",this.enum=ws.get("colorattribute"),this.weight=75,this.icon="M4 21.832c4.587.38 2.944-4.493 7.188-4.538l1.838 1.534c.458 5.538-6.315 6.773-9.026 3.004zm14.065-7.115c1.427-2.239 5.847-9.749 5.847-9.749.352-.623-.43-1.273-.976-.813 0 0-6.572 5.714-8.511 7.525-1.532 1.432-1.539 2.086-2.035 4.447l1.68 1.4c2.227-.915 2.868-1.039 3.995-2.81zm-11.999 3.876c.666-1.134 1.748-2.977 4.447-3.262.434-2.087.607-3.3 2.547-5.112 1.373-1.282 4.938-4.409 7.021-6.229-1-2.208-4.141-4.023-8.178-3.99-6.624.055-11.956 5.465-11.903 12.092.023 2.911 1.081 5.571 2.82 7.635 1.618.429 2.376.348 3.246-1.134zm6.952-15.835c1.102-.006 2.005.881 2.016 1.983.004 1.103-.882 2.009-1.986 2.016-1.105.009-2.008-.88-2.014-1.984-.013-1.106.876-2.006 1.984-2.015zm-5.997 2.001c1.102-.01 2.008.877 2.012 1.983.012 1.106-.88 2.005-1.98 2.016-1.106.007-2.009-.881-2.016-1.988-.009-1.103.877-2.004 1.984-2.011zm-2.003 5.998c1.106-.007 2.01.882 2.016 1.985.01 1.104-.88 2.008-1.986 2.015-1.105.008-2.005-.88-2.011-1.985-.011-1.105.879-2.004 1.981-2.015zm10.031 8.532c.021 2.239-.882 3.718-1.682 4.587l-.046.044c5.255-.591 9.062-4.304 6.266-7.889-1.373 2.047-2.534 2.442-4.538 3.258z",this.cursor=new bs({icon:"M17.831 7.672c1.096-1.096 2.875-1.865 3.688-3.106.892-1.362.508-3.192-.851-4.085-1.362-.892-3.187-.508-4.081.854-.842 1.286-.801 3.322-1.433 4.779-.817 1.882-3.553 2.116-6.698.474-1.727 3.352-4.075 6.949-6.456 9.874l2.263 1.484c1.018-.174 2.279-1.059 2.792-2.03-.04 1.167-.478 2.2-1.337 2.983l4.275 2.797c.546-.544 1.054-.976 1.616-1.345-.319.643-.532 1.324-.63 1.99l2.532 1.659c1.5-2.884 4.416-7.343 6.455-9.874-2.82-2.272-3.657-4.936-2.135-6.454zm1.762-5.545c.454.296.58.908.281 1.36-.294.457-.905.582-1.356.286-.456-.297-.582-.906-.284-1.36.295-.455.905-.583 1.359-.286zm-3.959 15.037l-8.225-5.386 1.616-2.469 8.221 5.387-1.612 2.468z",size:{width:66,height:66},stroke:1.5,offset:{x:0,y:10}}),this.properties={remove:void 0,previous:{x:void 0,y:void 0}}}primary(e){let{x:t,y:s}=e.realMousePosition;t>0&&t<128&&s>0&&s<128&&(t=Math.floor(t/8),s=Math.floor(s/8),this.properties.previous.x=t,this.properties.previous.y=s,this.setColorAttribute({x:t,y:s}))}secondary(e){let{x:t,y:s}=e.realMousePosition;t=Math.floor(t/8),s=Math.floor(s/8),this.properties.remove=!0,this.setColorAttribute({x:t,y:s})}setColorAttribute({x:e,y:t}){const s=es.stores.activeLayer.get(),o=ms.stores.activeLayer.get().colorAttributes;o&&void 0!==o[e]&&void 0!==o[e][t]&&(o[e][t]=this.properties.remove?null:s)}mouseup(){this.properties.remove=void 0;const e=ms.stores.activeLayer.get();e&&e.forceUpdate()}move(e){let{x:t,y:s}=e.realMousePosition;Is.x=t,Is.y=s,e.mouseIsDown&&t>0&&t<128&&s>0&&s<128&&(t=Math.floor(t/8),s=Math.floor(s/8),1!=e.which&&3!=e.which||(this.properties.previous.x==t&&this.properties.previous.y==s||this.setColorAttribute({x:t,y:s}),this.properties.previous.x=t,this.properties.previous.y=s))}},preview:new class extends _s{constructor(){super(),this.cursorLayers=[Ss],this.title="Pattern preview (P)",this.name="preview",this.enum=ws.get("preview"),this.weight=10,this.icon="M8 0v2h8v-2h-8zm0 24v-2h8v2h-8zm10-24h6v6h-2v-4h-4v-2zm-18 8h2v8h-2v-8zm0-2v-6h6v2h-4v4h-2zm24 10h-2v-8h2v8zm0 2v6h-6v-2h4v-4h2zm-18 6h-6v-6h2v4h4v2zm12-18h-12v12h12v-12z",this.cursor=new bs({icon:"M24 10h-10v-10h-4v10h-10v4h10v10h4v-10h10z",size:{width:56,height:56},offset:{x:5,y:5}}),this.properties={start:void 0,end:void 0},this.mouseIsDown=!1}onMount(){}onDestroy(){}dblclick(){this.mouseIsDown=!0,Ss.start={x:0,y:0},Ss.end={x:128,y:128},this.createPreview()}primary(e){this.mouseIsDown=e.mouseIsDown,Ss.removeSelection();let{x:t,y:s}=e.realMousePosition;t=8*Math.floor(t/8),s=8*Math.floor(s/8),this.properties.start={x:t,y:s},Ss.start={x:t,y:s},Ss.end={x:t+7,y:s+7}}secondary(e){Ss.removeSelection()}move(e){if(!e.mouseIsDown||1!==e.which)return;let{x:t,y:s}=e.realMousePosition;t=Math.max(0,8*Math.floor(t/8)),s=Math.max(0,8*Math.floor(s/8));let o={...this.properties.start},n={x:t,y:s};const r=Math.min(n.x,o.x),i=Math.max(n.x,o.x),a=Math.min(n.y,o.y),l=Math.max(n.y,o.y);Ss.start={x:r,y:a},Ss.end={x:i+7,y:l+7}}mouseup(e){this.createPreview(e)}createPreview(e){if(Ss.start&&Ss.end&&this.mouseIsDown){const e={label:`x:(${Ss.start.x/8}-${(Ss.end.x-7)/8}) y: (${Ss.start.y/8}-${(Ss.end.y-7)/8})`,zoom:2,start:{x:Ss.start.x,y:Ss.start.y},end:{x:Ss.end.x+1,y:Ss.end.y+1}};((e,t={})=>{t={width:128,height:128,zoom:2,...t},qt.update((s=>[...s,{component:e,props:t}]))})(Bs,e)}Ss.removeSelection(),this.mouseIsDown=!1}},brush:new class extends _s{constructor(){super(),this.cursorLayers=[Ms],this.title="Pattern brush (-)",this.name="brush",this.enum=ws.get("brush"),this.weight=80,this.icon="M17.831 7.672c1.096-1.096 2.875-1.865 3.688-3.106.892-1.362.508-3.192-.851-4.085-1.362-.892-3.187-.508-4.081.854-.842 1.286-.801 3.322-1.433 4.779-.817 1.882-3.553 2.116-6.698.474-1.727 3.352-4.075 6.949-6.456 9.874l2.263 1.484c1.018-.174 2.279-1.059 2.792-2.03-.04 1.167-.478 2.2-1.337 2.983l4.275 2.797c.546-.544 1.054-.976 1.616-1.345-.319.643-.532 1.324-.63 1.99l2.532 1.659c1.5-2.884 4.416-7.343 6.455-9.874-2.82-2.272-3.657-4.936-2.135-6.454zm1.762-5.545c.454.296.58.908.281 1.36-.294.457-.905.582-1.356.286-.456-.297-.582-.906-.284-1.36.295-.455.905-.583 1.359-.286zm-3.959 15.037l-8.225-5.386 1.616-2.469 8.221 5.387-1.612 2.468z",this.cursor=new bs({icon:"M17.831 7.672c1.096-1.096 2.875-1.865 3.688-3.106.892-1.362.508-3.192-.851-4.085-1.362-.892-3.187-.508-4.081.854-.842 1.286-.801 3.322-1.433 4.779-.817 1.882-3.553 2.116-6.698.474-1.727 3.352-4.075 6.949-6.456 9.874l2.263 1.484c1.018-.174 2.279-1.059 2.792-2.03-.04 1.167-.478 2.2-1.337 2.983l4.275 2.797c.546-.544 1.054-.976 1.616-1.345-.319.643-.532 1.324-.63 1.99l2.532 1.659c1.5-2.884 4.416-7.343 6.455-9.874-2.82-2.272-3.657-4.936-2.135-6.454zm1.762-5.545c.454.296.58.908.281 1.36-.294.457-.905.582-1.356.286-.456-.297-.582-.906-.284-1.36.295-.455.905-.583 1.359-.286zm-3.959 15.037l-8.225-5.386 1.616-2.469 8.221 5.387-1.612 2.468z",size:{width:66,height:66},stroke:1.5,offset:{x:0,y:10}}),this.mouseIsDown,this.properties={drawStack:{},remove:void 0,previous:{x:void 0,y:void 0}}}primary(e){let{x:t,y:s}=e.realMousePosition;t=8*Math.floor(t/8),s=8*Math.floor(s/8),this.mouseIsDown=e.mouseIsDown,this.mouseIsDown&&e.altKey?(Ms.selectionIsVisible=!0,Ms.removeSelection(),this.properties.start={x:t,y:s},Ms.start={x:t,y:s},Ms.end={x:t+7,y:s+7}):Ms.hasSelection()&&this.paint({x:t/8,y:s/8})}secondary(e){this.mouseIsDown=!1,this.properties.start=void 0,Ms.removeSelection()}mouseup(){if(!this.mouseIsDown)return;const e=ms.stores.activeLayer,t=e.get();if(Ms.start&&Ms.end&&this.mouseIsDown&&!Ms.hasSelection()){Ms.addSelection({start:Ms.start,end:Ms.end}),Ms.selectionIsVisible=!1;const e=new Image;e.src=t.updateImageSource(),this.properties.activeLayerSnapshot={image:e,data:JSON.parse(JSON.stringify(t.data))}}else{const s=Object.entries(this.properties.drawStack);t.saveHistory(),e.update((e=>(s.forEach((([t,s])=>{e.data[t]&&Object.entries(s).forEach((([s,o])=>{e.data[t][s]&&(e.data[t][s]=o)}))})),e))),t.forceUpdate(),t.setPresent()}this.properties.drawStack={},this.properties.start=void 0,this.mouseIsDown=!1}paint(e){const t=this.properties.activeLayerSnapshot?.data;if(!t)return;const s=JSON.parse(JSON.stringify(t)),o=ms.stores.activeLayer.get(),n=Math.abs(Ms.selection.end.x-Ms.selection.start.x+1),r=Math.abs(Ms.selection.end.y-Ms.selection.start.y+1),i=Math.floor(r/8),a=Math.floor(n/8);for(let t=0;t<i;t++)for(let n=0;n<a;n++){const r=e.y+t,i=e.x+n;this.properties.drawStack[r]||(this.properties.drawStack[r]={}),this.properties.drawStack[r][i]=s[Ms.selection.start.y/8+t][Ms.selection.start.x/8+n],this.properties.activeLayerSnapshot.image&&o.context.drawImage(this.properties.activeLayerSnapshot.image,Ms.selection.start.x+8*n,Ms.selection.start.y+8*t,8,8,Math.floor(8*i),Math.floor(8*r),8,8)}}move(e){let{x:t,y:s}=e.realMousePosition;const o=Math.floor(t/8),n=Math.floor(s/8);let r=Math.max(0,8*o),i=Math.max(0,8*n);if(Ms.hasSelection()){let o=8,n=8,r={x:Math.floor(Ms.selection.end.x+1-Ms.selection.start.x),y:Math.floor(Ms.selection.end.y+1-Ms.selection.start.y)};e.shiftKey&&(o=r.x,n=r.y);const i=Math.max(0,Math.floor(t/o)*o),a=Math.max(0,Math.floor(s/n)*n);Ms.start={x:i,y:a},Ms.end={x:i+r.x-1,y:a+r.y-1};const l={x:i/8,y:a/8};this.mouseIsDown&&this.paint(l)}else{if(!e.mouseIsDown||1!==e.which)return;let t={...this.properties.start},s={x:r,y:i};const o=Math.min(s.x,t.x),n=Math.max(s.x,t.x),a=Math.min(s.y,t.y),l=Math.max(s.y,t.y);Ms.start={x:o,y:a},Ms.end={x:n+7,y:l+7}}}},zoom:new class extends _s{constructor(){super(),this.singleAction=!0,this.name="zoom",this.title="Zoom (Z)",this.enum=ws.get("zoom"),this.weight=0,this.icon="M23.822 20.88l-6.353-6.354c.93-1.465 1.467-3.2 1.467-5.059.001-5.219-4.247-9.467-9.468-9.467s-9.468 4.248-9.468 9.468c0 5.221 4.247 9.469 9.468 9.469 1.768 0 3.421-.487 4.839-1.333l6.396 6.396 3.119-3.12zm-20.294-11.412c0-3.273 2.665-5.938 5.939-5.938 3.275 0 5.94 2.664 5.94 5.938 0 3.275-2.665 5.939-5.94 5.939-3.274 0-5.939-2.664-5.939-5.939z",this.cursor=new bs({icon:"M23.822 20.88l-6.353-6.354c.93-1.465 1.467-3.2 1.467-5.059.001-5.219-4.247-9.467-9.468-9.467s-9.468 4.248-9.468 9.468c0 5.221 4.247 9.469 9.468 9.469 1.768 0 3.421-.487 4.839-1.333l6.396 6.396 3.119-3.12zm-20.294-11.412c0-3.273 2.665-5.938 5.939-5.938 3.275 0 5.94 2.664 5.94 5.938 0 3.275-2.665 5.939-5.94 5.939-3.274 0-5.939-2.664-5.939-5.939z",size:{width:56,height:56},offset:{x:5,y:5}})}primary(e){e.altKey?ft.execute("spritesheet_zoom_out"):ft.execute("spritesheet_zoom_in")}secondary(e){e.altKey?ft.execute("spritesheet_zoom_in"):ft.execute("spritesheet_zoom_out")}move(e){}dblclick(){ft.execute("spritesheet_zoom_reset")}}},qs={tools:Hs,activeTool:vt(void 0,(({value:e,store:t,get:s})=>({setActive(e){if(!(e instanceof ht))throw new Error("Invalid tool");const o=s();o instanceof _s&&o.onDestroy();const n=Hs[e.key],{cursor:r}=n;let i="default";r&&r.icon&&(i=`url("data:image/svg+xml,%3Csvg transform='' xmlns='http://www.w3.org/2000/svg' width='${r.size.width}' height='${r.size.height}' viewBox='0 0 100 100' xml:space='preserve'%3E %3Cpath fill='white' stroke='black' stroke-width='${r.stroke||2}' d='${r.icon}'/%3E %3C/svg%3E") ${r.offset.x} ${r.offset.y}, auto`),document.body.style.cursor="default",document.documentElement.style.setProperty("--canvas-cursor",i),t.set(n),Array.isArray(n.hotkeysGroups)&&gt.enableGroups("*","spritesheets",...n.hotkeysGroups)}})))};qs.activeTool.setActive(ws.get("pointer"));const Fs=(e,...t)=>{e&&e.call(qs.activeTool.get(),...t)};globalThis.electron&&(ft.register("window_close",(e=>globalThis.electron.quit())),ft.register("window_minimize",(e=>globalThis.electron.minimize())),ft.register("window_maximize",(e=>globalThis.electron.maximize())),ft.register("window_toggle_fullscreen",(e=>globalThis.electron.toggleFullscreen())),ft.register("project_build",(()=>{console.warn("Not implemented")})),ft.register("project_build_run",(()=>{const e=ms.exportCHR().data,t=ys.exportNametableData("nametable"),s=es.exportASMString();globalThis.electron.spawnChildProcess({chr:e,palettes:s,nametables:[t]})})),ft.register("project_run",(()=>{console.warn("Not implemented")})),ft.register("project_save",(async e=>{const t=xs.get().path;t?globalThis.electron.save(t,xs.export(!0)).then((e=>{st({message:"Successfully saved project",variant:"success"})})):ft.execute("project_save_as")})),ft.register("project_save_as",(async e=>{const{canceled:t,filePath:s}=await globalThis.electron.openSaveDialog([Ut.project.save.extension]);t||(globalThis.electron.save(s,xs.export(!0)).then((e=>{xs.update((t=>(t.path=e,t)))})),st({message:"Successfully saved project",variant:"success"}))})),ft.register("project_open",(async e=>{const t=async e=>{let{filePath:t,data:s}=await globalThis.electron.readFileDataFromPath(e,"utf8");xs.open(t,s)};if(e)return void t(e);const{canceled:s,filePaths:o}=await globalThis.electron.openFileDialog([Ut.project.save.extension]);if(!s&&Array.isArray(o)){for(const e of o)t(e);st({message:"Successfully opened project",variant:"success"})}})),ft.register("external_link",(e=>globalThis.electron.externalLink(e))),ft.register("palette_export",(async e=>{const t=palettesStore.export(!0),{canceled:s,filePath:o}=await globalThis.electron.openSaveDialog([Ut.palettes.save.extension]);s||"string"!=typeof o||(await globalThis.electron.saveAs(o,t),st({message:"Successfully exported palettes",variant:"success"}))})),ft.register("palette_import",(async e=>{const{canceled:t,filePaths:s}=await globalThis.electron.openFileDialog([Ut.palettes.save.extension]);if(!t&&Array.isArray(s)){for(const e of s){const{filePath:t,data:s}=await globalThis.electron.readFileDataFromPath(e,"utf8");es.import(s)}st({message:"Successfully imported palettes",variant:"success"})}})),ft.register("spritesheet_import",(async e=>{const{canceled:t,filePaths:s}=await globalThis.electron.openFileDialog([Ut.spritesheets.save.extension]);if(!t&&Array.isArray(s)){for(const e of s){const{filePath:t,data:s}=await globalThis.electron.readFileDataFromPath(e,"utf8");ms.import(s)}st({message:"Successfully imported spritesheets",variant:"success"})}})),ft.register("spritesheet_import_chr",(async e=>{const{canceled:t,filePaths:s}=await globalThis.electron.openFileDialog(["chr"]);if(!t&&Array.isArray(s)){for(const e of s){const{filePath:t,data:s}=await globalThis.electron.readFileDataFromPath(e);ms.importCHR(s)}st({message:"Successfully imported chr",variant:"success"})}})),ft.register("spritesheet_export_chr",(async e=>{const{label:t,data:s}=ms.exportCHR(),{canceled:o,filePath:n}=await globalThis.electron.openSaveDialog(["chr"]);o||"string"!=typeof n||(await globalThis.electron.saveAs(n,s),st({message:"Successfully exported chr",variant:"success"}))})),ft.register("spritesheet_export",(async e=>{const{canceled:t,filePath:s}=await globalThis.electron.openSaveDialog([Ut.spritesheets.save.extension]);t||"string"!=typeof s||(await globalThis.electron.saveAs(s,ms.export(!0)),st({message:"Successfully exported spritesheets",variant:"success"}))})),ft.register("spritesheet_export_png",(async e=>{const{canceled:t,filePath:s}=await globalThis.electron.openSaveDialog(["png"]);t||"string"!=typeof s||ms.exportAsImage((async({buffer:e})=>{await globalThis.electron.saveBufferAs(s,e),st({message:"Successfully exported png",variant:"success"})}))})));var Ks="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var Gs,Js=(function(e,t){!function(){function t(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function s(e,t,s){var o=new XMLHttpRequest;o.open("GET",e),o.responseType="blob",o.onload=function(){a(o.response,t,s)},o.onerror=function(){console.error("could not download file")},o.send()}function o(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function n(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(s){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var r="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof Ks&&Ks.global===Ks?Ks:void 0,i=r.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),a=r.saveAs||("object"!=typeof window||window!==r?function(){}:"download"in HTMLAnchorElement.prototype&&!i?function(e,t,i){var a=r.URL||r.webkitURL,l=document.createElement("a");t=t||e.name||"download",l.download=t,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?n(l):o(l.href)?s(e,t,i):n(l,l.target="_blank")):(l.href=a.createObjectURL(e),setTimeout((function(){a.revokeObjectURL(l.href)}),4e4),setTimeout((function(){n(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,r,i){if(r=r||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,i),r);else if(o(e))s(e,r,i);else{var a=document.createElement("a");a.href=e,a.target="_blank",setTimeout((function(){n(a)}))}}:function(e,t,o,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof e)return s(e,t,o);var a="application/octet-stream"===e.type,l=/constructor/i.test(r.HTMLElement)||r.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||a&&l||i)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=e:location=e,n=null},u.readAsDataURL(e)}else{var p=r.URL||r.webkitURL,h=p.createObjectURL(e);n?n.location=h:location.href=h,n=null,setTimeout((function(){p.revokeObjectURL(h)}),4e4)}});r.saveAs=a.saveAs=a,e.exports=a}()}(Gs={exports:{}},Gs.exports),Gs.exports);const Us=(e,t)=>{const s=new Date;return`${`${String(s.getFullYear())}_${String(s.getMonth()).padStart(2,"0")}_${String(s.getDay()).padStart(2,"0")}`}_${e}.${t}`},Vs=(e=[],t=(e=>e),s={readAs:"text"})=>{if(!Array.isArray(e))throw new Error("Invalid 'fileDialog' accept. Expecting array of file extentions");if("function"!=typeof t)throw new Error("Invalid 'fileDialog' callback function");const o=document.createElement("input");o.type="file",o.accept=e.map((e=>e.startsWith(".")?e:"."+e)).join(","),o.addEventListener("change",(e=>{const o=e.target.files[0],n=new FileReader;switch(s.readAs){case"binary":n.readAsBinaryString(o);break;case"arraybuffer":n.readAsArrayBuffer(o);break;case"text":default:n.readAsText(o,s.encoding||"utf-8")}n.addEventListener("load",(e=>{t.call(null,o,e.target.result)}))})),o.click()},Ys=(e,t,s={})=>{const o=new Blob([t],{type:s.type||"application/json;charset=utf-8"});Js.saveAs(o,e)};globalThis.electron||(ft.register("window_close",(e=>e)),ft.register("window_minimize",(e=>document.exitFullscreen())),ft.register("window_maximize",(e=>ft.execute("window_toggle_fullscreen"))),ft.register("window_toggle_fullscreen",(()=>{document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()})),ft.register("project_open",(e=>{Vs([Ut.project.save.extension],((e,t)=>{xs.open(void 0,t),st({message:"Successfully opened project",variant:"success"})}))})),ft.register("project_save",(e=>{Ys(Us("insert_projectname",Ut.project.save.extension),xs.export(!0)),st({message:"Successfully saved project",variant:"success"})})),ft.register("palette_import",(e=>{Vs([Ut.palettes.save.extension],((e,t)=>{es.import(t),st({message:"Successfully imported palettes",variant:"success"})}))})),ft.register("palette_export",(e=>{Ys(Us("palette",Ut.palettes.save.extension),es.export(!0)),st({message:"Successfully exported palettes",variant:"success"})})),ft.register("spritesheet_import",(e=>{Vs([Ut.spritesheets.save.extension],((e,t)=>{ms.import(t),st({message:"Successfully imported spritesheets",variant:"success"})}))})),ft.register("spritesheet_export",(e=>{Ys(Us("spritesheet",Ut.spritesheets.save.extension),ms.export(!0)),st({message:"Successfully exported spritesheets",variant:"success"})})),ft.register("spritesheet_import_chr",(e=>{Vs(["chr"],((e,t)=>{ms.importCHR(t),st({message:"Successfully imported chr",variant:"success"})}),{readAs:"arraybuffer"})})),ft.register("spritesheet_export_chr",(e=>{const{label:t,data:s}=ms.exportCHR();Ys(Us(t,"chr"),s)})),ft.register("spritesheet_export_png",(e=>{ms.exportAsImage((({blob:e,label:t,options:s})=>{Ys(Us(t,"png"),e,{mimetype:e.type}),st({message:"Successfully exported png",variant:"success"})}))})),ft.register("tilemap_import",(e=>{Vs([Ut.tilemaps.save.extension],((e,t)=>{ys.import(t)}))})),ft.register("tilemap_export",(e=>{Ys(Us("tilemap",Ut.tilemaps.save.extension),ys.export(!0))})),ft.register("tilemap_export_nametable",(e=>{Ys(Us("tilemap_nametable",Ut.tilemaps.export.extension),ys.exportNametableData())})),ft.register("tilemap_export_png",(e=>{ys.exportAsImage((({blob:e,label:t,options:s})=>{Ys(Us(t,"png"),e,{mimetype:e.type})}))})));const{selectedColor:Ws}=es.stores;ft.register("noop",(e=>e)),ft.register("toggle_theme",(e=>document.documentElement.dataset.theme="dark"==document.documentElement.dataset.theme?"light":"dark")),ft.register("light_theme",(e=>document.documentElement.dataset.theme="light")),ft.register("dark_theme",(e=>document.documentElement.dataset.theme="dark")),ft.register("project_create",(e=>xs.create())),ft.register("graphics_center_artboard",(e=>ct())),ft.register("palette_clear",(e=>es.clear())),ft.register("palette_create",(e=>es.createLayer())),ft.register("palette_remove",(e=>es.removeLayer(e))),ft.register("palette_clone_layer",(e=>es.cloneLayer(e))),ft.register("palette_clone_active_layer",(e=>es.cloneActiveLayer())),ft.register("palette_make_layer_active",(e=>es.makeLayerActive(e))),ft.register("palette_swap_layers",(({to:e,from:t})=>es.stores.layers.swapLayers(e,t))),ft.register("palette_update_layer_label",(({source:e,label:t})=>es.updateLayerLabel(e,t))),ft.register("palette_active_color",(e=>Ws.setActiveColorIndex(e))),ft.register("spritesheet_clear",(e=>ms.clear())),ft.register("spritesheet_create",(e=>ms.createLayer())),ft.register("spritesheet_remove",(e=>ms.removeLayer(e))),ft.register("spritesheet_clone_layer",(e=>ms.cloneLayer(e))),ft.register("spritesheet_clone_active_layer",(e=>ms.cloneActiveLayer())),ft.register("spritesheet_make_layer_active",(e=>ms.makeLayerActive(e))),ft.register("spritesheet_swap_layers",(({to:e,from:t})=>ms.stores.layers.swapLayers(e,t))),ft.register("spritesheet_update_layer_label",(({source:e,label:t})=>ms.updateLayerLabel(e,t))),ft.register("spritesheet_zoom_in",(e=>ms.stores.artboard.zoom(3))),ft.register("spritesheet_zoom_out",(e=>ms.stores.artboard.zoom(-2))),ft.register("spritesheet_zoom_reset",(e=>ms.stores.artboard.zoomReset())),ft.register("spritesheet_set_active_tool",(e=>{gt.enableGroups("*","spritesheets"),qs.activeTool.setActive(e)})),ft.register("spritesheet_tool_dblclick",(e=>{const t=qs.activeTool.get();t&&"function"==typeof t.dblclick&&t.dblclick.call(t)})),ft.register("spritesheet_undo",(e=>{const t=ms.stores.activeLayer.get();t&&t.undo()})),ft.register("spritesheet_redo",(e=>{const t=ms.stores.activeLayer.get();t&&t.redo()})),ft.register("spritesheet_set_selected_tile",(e=>ms.stores.selectedTile.stores.current.set(e))),ft.register("tilemap_clear",(e=>ys.clear())),ft.register("tilemap_create",(()=>{ys.createLayer()})),ft.register("tilemap_remove",(e=>{ys.removeLayer(e)})),ft.register("tilemap_clone_layer",(e=>ys.cloneLayer(e))),ft.register("tilemap_clone_active_layer",(e=>ys.cloneActiveLayer())),ft.register("tilemap_make_layer_active",(e=>ys.makeLayerActive(e))),ft.register("tilemap_swap_layers",(({to:e,from:t})=>ys.stores.layers.swapLayers(e,t))),ft.register("tilemap_update_layer_label",(({source:e,label:t})=>ys.updateLayerLabel(e,t))),ft.register("tool_action",(e=>{if("function"!=typeof e)throw new Error("Invalid action call. 'tool_action' expecting a valid function.");e.call(null)}));class Zs{constructor(e,t,s,o=[]){Object.assign(this,((e,t)=>{t=(t=`${e="/"+e.replace(/^[\/]+|[\/]+$/g,"")}/${t}`.replace(/[\/]+/g,"/")).replace(/^[\/]+|[\/]+$/g,"");const s=/\*$/.test(t)?(t=t.replace(/[\*]+$/g,""),""):"/?$",o=[];let n=0,r=t.replace(/(:)?([^\\/]+)/g,((e,t,s)=>{const[r,i]=s.split("->");if(t){const t=o.filter((e=>e.identifier==i));if(t.length>0)throw new Error(`Duplicated parameter. [${t.map((e=>e.identifier))}]`);return o.push({index:n++,parameter:e,identifier:r}),i?`(${i})`:"([^/]+)"}return`${e}`}));return r=`^/${r}${s}`,{base:e,route:t,regexpRoute:r,parameters:o}})(e,t)),this.callback=s,this.middlewares=o}}class Xs{constructor(...e){this.props=e}use(e){if("function"!=typeof e)throw new Error(`Invalid Middleware use argument. Expecting 'function' got : '${typeof e}'`);return this.execute=(t=>s=>t(e.bind(this,...this.props,s)))(this.execute),this}execute(e){return e.call(null)}}class Qs{constructor(e){Object.assign(this,{base:"",path:"",route:"",query:{},params:{},state:{}},e)}}class eo{constructor(e){Object.assign(this,e)}}class to extends Error{}class so extends class{constructor(e){Object.freeze(this.__properties={initial:void 0,base:"",state:{},...e}),this.__subscribing=!1,this.__get=new Map,this.__catch=new Map,this.__use=new Set}_register(e,t,s,o){return e.map((e=>{const n=new Zs(this.__properties.base,e,t,s);if(o.has(n.regexpRoute))throw new Error(`Route with same endpoint already exist. [${e}, /${o.get(n.regexpRoute).route}](${n.regexpRoute})`);o.set(n.regexpRoute,n)})),e}_props(...e){let t,s,o=[];if(1==e.length)[s]=e,t="*";else if(2==e.length)[t,s]=e;else{if(!(e.length>2))throw new Error("Invalid number prop arguments.");t=e.shift(),s=e.pop(),o=e}return t=Array.isArray(t)?t:[t],{routes:t,fn:s,middlewares:o}}_storeInList(e,t,...s){const{routes:o,fn:n,middlewares:r}=this._props(...s),i=this._register(o,n,r,t),a={[e]:(...t)=>{const{routes:s,fn:o,middlewares:n}=this._props(...t);return i.map((t=>s.map((e=>t+e)).map((t=>this[e](t,...n,o))))),a}};return a}get(...e){return this._storeInList("get",this.__get,...e)}use(...e){const{routes:t,fn:s}=this._props(e);t.map((e=>this.__use.add(new Zs(this.__properties.base,e,...s))))}catch(...e){return this._storeInList("catch",this.__catch,...e)}_findRoute(e,t,s){for(let[o,n]of t){const t=e.match(new RegExp(o,"i"));if(t){t.shift();let o={};t.length>0&&(o=n.parameters.reduce(((e,s,o)=>(e[s.identifier]=t[o],e)),o));const r=new URLSearchParams(window.location.search),i={};for(const[e,t]of r.entries())i[e]?Array.isArray(i[e])?i[e].push(t):i[e]=[i[e],t]:i[e]=t;return{RouteInstance:n,Request:new Qs({path:e,route:"/"+n.route,base:n.base,query:i,params:o,state:{...s}})}}}}execute(e,t={}){if("string"!=typeof e)throw new Error("Invalid 'execute' argument. Expecting 'string'");if(!this.__subscribing)return;const s=new eo({send:(...e)=>this.__router_callback.call(null,...e),error:o=>{const n=this._findRoute(e,this.__catch,t);n?n.RouteInstance.callback.call(null,n.Request,s,o):console.warn(`No route or catch fallbacks found for [${e}]`)}});let o=this._findRoute(e,this.__get,t);if(!o)return void s.error();let n=[];const r=new Xs(o.Request,s);this.__use.forEach((t=>{e.match(new RegExp(t.regexpRoute,"i"))&&n.push(t.callback)})),n=[...n,...o.RouteInstance.middlewares,o.RouteInstance.callback],n.map((e=>r.use(e))),r.execute()}subscribe(e){return this.__subscribing=!0,"function"==typeof e&&(this.__router_callback=e),this.__properties.initial&&this.execute(this.__properties.initial,this.__properties.state),()=>{this.__subscribing=!1}}}{}let oo=new class{constructor(){this.__linkBase="",this.__scrollReset=!0,this.__scrollOffset=0}setLinkBase(e){if("string"!=typeof e)throw new to("Invalid 'linkBase'. Expecting value of type 'string'");return this.__linkBase=e.endsWith("/")?e:e+"/"}set linkBase(e){return this.setLinkBase(e)}get linkBase(){return this.__linkBase}setScrollReset(e){if("boolean"!=typeof e)throw new to("Invalid 'scrollReset'. Expecting value of type 'boolean'");return this.__scrollReset=e}set scrollReset(e){return this.setScrollReset(e)}get scrollReset(){return this.__scrollReset}setScrollOffset(e){if("number"!=typeof e)throw new to("Invalid 'scrollOffset'. Expecting value of type 'number'");return this.__scrollOffset=e}set scrollOffset(e){return this.setScrollOffset(e)}get scrollOffset(){return this.__scrollOffset}};const no=e=>{const t=new RegExp(`^${oo.linkBase}`,"i");return"/"+(e=`/${e}/`.replace(/[\/]+/g,"/").replace(t,"").replace(/^\/|\/$/g,""))},ro=({state:e})=>{dispatchEvent(new CustomEvent("popstate",{detail:{...e}}))},io=(e,t={})=>{e=co(e),history.pushState(t,"",e),ro({url:e,state:t})},ao=(e,t={})=>{e=co(e),history.replaceState(t,"",e),ro({url:e,state:t})},lo=(e,t={})=>{history.pushState(t,"",co(e))},co=e=>`/${oo.linkBase}/${e}`.replace(/[\/]+/g,"/"),uo=(e,t)=>{lo(no(e));const s=window.location.hash.slice(1);if(s){t&&t.preventDefault();const e=document.querySelector(`a[name="${s}"], #${s}`);if(e){const t=e.getBoundingClientRect().top+window.pageYOffset-oo.scrollOffset;window.scrollTo({top:t})}}};let po={location:{...window.location},firstLoad:!1},ho=new Map,fo=Ne(),mo=!1,go=!1;const $o=e=>{const t=e.target;if("A"==t.tagName){const s=t.getAttribute("href"),o=s.indexOf("#")>-1;!/^[a-zA-Z]+\:\/\/(.*)/.test(s)&&o&&(uo(s.startsWith("#")?window.location.pathname+s:s,e),po.location={...window.location})}},vo=async e=>{let t=!1;const s=co(window.location.pathname+"/")==co(po.location.pathname+"/")&&po.location.search==window.location.search;""!=window.location.hash&&s&&po.firstLoad&&(t=!0),""==window.location.hash&&window.location.hash!=po.location.hash&&s&&(t=!0,window.scrollTo({top:0})),t||(fo.set(no(window.location.pathname)),ho.forEach((t=>t.router.execute(window.location.pathname,e.detail)))),po.location={...window.location}};const yo=e=>({component:1&e,props:1&e,decorator:1&e,decoratorProps:1&e}),xo=e=>({component:e[0].context,props:e[0].props,decorator:e[0].decorator,decoratorProps:e[0].decoratorProps});function wo(e){let t;const s=e[3].default,o=u(s,e,e[4],xo),n=o||function(e){let t,s,o,n;const r=[_o,bo],i=[];function a(e,t){return e[0].decorator?0:1}return t=a(e),s=i[t]=r[t](e),{c(){s.c(),o=A()},m(e,s){i[t].m(e,s),L(e,o,s),n=!0},p(e,n){let l=t;t=a(e),t===l?i[t].p(e,n):(ve(),we(i[l],1,1,(()=>{i[l]=null})),ye(),s=i[t],s?s.p(e,n):(s=i[t]=r[t](e),s.c()),xe(s,1),s.m(o.parentNode,o))},i(e){n||(xe(s),n=!0)},o(e){we(s),n=!1},d(e){i[t].d(e),e&&k(o)}}}(e);return{c(){n&&n.c()},m(e,s){n&&n.m(e,s),t=!0},p(e,t){o?o.p&&17&t&&h(o,s,e,e[4],t,yo,xo):n&&n.p&&1&t&&n.p(e,t)},i(e){t||(xe(n,e),t=!0)},o(e){we(n,e),t=!1},d(e){n&&n.d(e)}}}function bo(e){let t,o,n;const r=[e[0].props];var i=e[0].context;function a(e){let t={};for(let e=0;e<r.length;e+=1)t=s(t,r[e]);return{props:t}}return i&&(t=new i(a())),{c(){t&&Me(t.$$.fragment),o=A()},m(e,s){t&&Ae(t,e,s),L(e,o,s),n=!0},p(e,s){const n=1&s?Ee(r,[Ie(e[0].props)]):{};if(i!==(i=e[0].context)){if(t){ve();const e=t;we(e.$$.fragment,1,0,(()=>{Ce(e,1)})),ye()}i?(t=new i(a()),Me(t.$$.fragment),xe(t.$$.fragment,1),Ae(t,o.parentNode,o)):t=null}else i&&t.$set(n)},i(e){n||(t&&xe(t.$$.fragment,e),n=!0)},o(e){t&&we(t.$$.fragment,e),n=!1},d(e){e&&k(o),t&&Ce(t,e)}}}function _o(e){let t,o,n;const r=[e[0].decoratorProps?e[0].decoratorProps:{}];var i=e[0].decorator;function a(e){let t={$$slots:{default:[Lo]},$$scope:{ctx:e}};for(let e=0;e<r.length;e+=1)t=s(t,r[e]);return{props:t}}return i&&(t=new i(a(e))),{c(){t&&Me(t.$$.fragment),o=A()},m(e,s){t&&Ae(t,e,s),L(e,o,s),n=!0},p(e,s){const n=1&s?Ee(r,[Ie(e[0].decoratorProps?e[0].decoratorProps:{})]):{};if(17&s&&(n.$$scope={dirty:s,ctx:e}),i!==(i=e[0].decorator)){if(t){ve();const e=t;we(e.$$.fragment,1,0,(()=>{Ce(e,1)})),ye()}i?(t=new i(a(e)),Me(t.$$.fragment),xe(t.$$.fragment,1),Ae(t,o.parentNode,o)):t=null}else i&&t.$set(n)},i(e){n||(t&&xe(t.$$.fragment,e),n=!0)},o(e){t&&we(t.$$.fragment,e),n=!1},d(e){e&&k(o),t&&Ce(t,e)}}}function Lo(e){let t,o,n;const r=[e[0].props];var i=e[0].context;function a(e){let t={};for(let e=0;e<r.length;e+=1)t=s(t,r[e]);return{props:t}}return i&&(t=new i(a())),{c(){t&&Me(t.$$.fragment),o=A()},m(e,s){t&&Ae(t,e,s),L(e,o,s),n=!0},p(e,s){const n=1&s?Ee(r,[Ie(e[0].props)]):{};if(i!==(i=e[0].context)){if(t){ve();const e=t;we(e.$$.fragment,1,0,(()=>{Ce(e,1)})),ye()}i?(t=new i(a()),Me(t.$$.fragment),xe(t.$$.fragment,1),Ae(t,o.parentNode,o)):t=null}else i&&t.$set(n)},i(e){n||(t&&xe(t.$$.fragment,e),n=!0)},o(e){t&&we(t.$$.fragment,e),n=!1},d(e){e&&k(o),t&&Ce(t,e)}}}function ko(e){let t,s,o=e[0]&&wo(e);return{c(){o&&o.c(),t=A()},m(e,n){o&&o.m(e,n),L(e,t,n),s=!0},p(e,[s]){e[0]?o?(o.p(e,s),1&s&&xe(o,1)):(o=wo(e),o.c(),xe(o,1),o.m(t.parentNode,t)):o&&(ve(),we(o,1,1,(()=>{o=null})),ye())},i(e){s||(xe(o),s=!0)},o(e){we(o),s=!1},d(e){o&&o.d(e),e&&k(t)}}}function zo(e,t,s){let o,{$$slots:n={},$$scope:r}=t,{context:i=ho.keys().next().value}=t;if(!(i&&i instanceof so))throw new Error("Invalid Router context. Did you initialize the component with a valid context?");const{component:a}=ho.get(i);return c(e,a,(e=>s(0,o=e))),i.subscribe((async(e,t={},s={})=>{if("function"!=typeof e)throw new to("Unable to load component. Did you pass a valid svelte component to the 'send' response?");oo.scrollReset&&window.scrollTo({top:0}),a.set({context:s?e:class extends e{},decorator:s.component?class extends s.component{}:void 0,decoratorProps:s.props||void 0,props:t}),window.location.hash&&(await ie(),setTimeout((()=>{uo(window.location.pathname+window.location.hash)}),0)),po.firstLoad||(po.firstLoad=!0)})),e.$$set=e=>{"context"in e&&s(2,i=e.context),"$$scope"in e&&s(4,r=e.$$scope)},[o,a,i,n,r]}class Eo extends Te{constructor(e){super(),Pe(this,e,zo,ko,a,{context:2})}}var Io=(e,t)=>{if(t={type:"navigate",state:{},title:"",...t},oo.linkBase){const t=co(e.getAttribute("href")||"");e.setAttribute("href",t)}const s=e=>{let s=t.to||t.href||e.currentTarget.getAttribute("href")||e.currentTarget.getAttribute("data-href");if(s)if(s=no(s),e.preventDefault(),"navigate"==t.type)io(s,t.state,t.title);else if("redirect"==t.type)ao(s,t.state,t.title);else if("replace"==t.type)lo(s,t.state,t.title);else{if("alter"!=t.type)return void console.warn("Invalid 'use:link' type. Expecting 'navigate'(default), 'redirect', 'replace' or 'alter'");((e,t={})=>{history.replaceState(t,"",co(e))})(s,t.state,t.title)}};return e.addEventListener("click",s),{update(e){t={...t,...e}},destroy(){e.removeEventListener("click",s)}}},So=(e,...t)=>{let s;if(e instanceof so?s=t.shift():(s=e,e=ho.keys().next().value),!e)throw new Error("Invalid Router context. Did you initialize the decorator with a valid context? or made sure to call it after one has been created?");let o="";const n=(r,...i)=>{let a;o||(o=r);let l=e=>{a={...e}};const c=i.pop();return e.get(r,...t,...i,((e,t)=>{c(e,{send:(e,o)=>{t.send(e,o,{component:s,props:a})},error:t.error},l)})),{get:(e,...t)=>n(`${o}/${e}`,...t)}};return n};function Mo(t){let s;return{c(){s=E("div"),s.innerHTML="<h1>This page is not available</h1> \n  <p>Currently not available in this version of the application.</p>",T(s,"class","checkered svelte-19ubedp")},m(e,t){L(e,s,t)},p:e,i:e,o:e,d(e){e&&k(s)}}}class Ao extends Te{constructor(e){super(),Pe(this,e,null,Mo,a,{})}}oo.linkBase=Jt;const Co=(e=>{(async()=>{mo||(mo=!0,go||(go=!0,fo.set(no(window.location.pathname))),window.addEventListener("popstate",vo),window.addEventListener("click",$o))})();const t=new so(e);return ho.set(t,{component:Ne(),router:t}),t})({initial:window.location.pathname,base:oo.linkBase});function Po(e){let t,s,o;const n=e[1].default,r=u(n,e,e[0],null);return{c(){t=E("div"),s=E("ul"),r&&r.c(),T(s,"id","areanav"),T(s,"class","svelte-1vnr3x8"),T(t,"id","tabnav"),T(t,"class","svelte-1vnr3x8")},m(e,n){L(e,t,n),_(t,s),r&&r.m(s,null),o=!0},p(e,[t]){r&&r.p&&1&t&&h(r,n,e,e[0],t,null,null)},i(e){o||(xe(r,e),o=!0)},o(e){we(r,e),o=!1},d(e){e&&k(t),r&&r.d(e)}}}function To(e,t,s){let{$$slots:o={},$$scope:n}=t;return e.$$set=e=>{"$$scope"in e&&s(0,n=e.$$scope)},[n,o]}Co.catch(((e,t)=>{t.send(Ao)}));class jo extends Te{constructor(e){super(),Pe(this,e,To,Po,a,{})}}function No(e,t,s){const o=e.slice();return o[2]=t[s],o}function Do(e){let t,s,o,n,r,i,a,l,c=e[2].label+"";return{c(){t=E("li"),s=E("button"),o=S(c),i=M(),T(s,"href",n=e[2].href),T(s,"label",r=e[2].label),T(s,"class","svelte-1p6gkk9"),T(t,"class","no-drag"),O(t,"active",e[2].href==e[1])},m(e,n){L(e,t,n),_(t,s),_(s,o),_(t,i),a||(l=g(Io.call(null,s)),a=!0)},p(e,i){1&i&&c!==(c=e[2].label+"")&&N(o,c),1&i&&n!==(n=e[2].href)&&T(s,"href",n),1&i&&r!==(r=e[2].label)&&T(s,"label",r),3&i&&O(t,"active",e[2].href==e[1])},d(e){e&&k(t),a=!1,l()}}}function Ro(e){let t,s=e[0],o=[];for(let t=0;t<s.length;t+=1)o[t]=Do(No(e,s,t));return{c(){for(let e=0;e<o.length;e+=1)o[e].c();t=A()},m(e,s){for(let t=0;t<o.length;t+=1)o[t].m(e,s);L(e,t,s)},p(e,n){if(3&n){let r;for(s=e[0],r=0;r<s.length;r+=1){const i=No(e,s,r);o[r]?o[r].p(i,n):(o[r]=Do(i),o[r].c(),o[r].m(t.parentNode,t))}for(;r<o.length;r+=1)o[r].d(1);o.length=s.length}},d(e){z(o,e),e&&k(t)}}}function Oo(e){let t,s;return t=new jo({props:{$$slots:{default:[Ro]},$$scope:{ctx:e}}}),{c(){Me(t.$$.fragment)},m(e,o){Ae(t,e,o),s=!0},p(e,[s]){const o={};35&s&&(o.$$scope={dirty:s,ctx:e}),t.$set(o)},i(e){s||(xe(t.$$.fragment,e),s=!0)},o(e){we(t.$$.fragment,e),s=!1},d(e){Ce(t,e)}}}function Bo(e,t,s){let o;c(e,fo,(e=>s(1,o=e)));let n=[{href:"/graphics/palettes",label:"Palettes"},{href:"/graphics/spritesheets",label:"Spritesheets"}];return Gt.isDev&&(n=[...n,{href:"/graphics/spritesets",label:"Sprites"},{href:"/graphics/metatiles",label:"Metatiles"},{href:"/graphics/tilemaps",label:"Tilemaps"}]),[n,o]}class Ho extends Te{constructor(e){super(),Pe(this,e,Bo,Oo,a,{})}}function qo(e){let t,s,o,n,r,i;o=new Ho({});const a=e[1].default,l=u(a,e,e[0],null);return{c(){t=E("section"),s=E("div"),Me(o.$$.fragment),n=M(),r=E("div"),l&&l.c(),T(r,"class","main svelte-1eju9fl"),T(t,"id","spritesheets"),T(t,"class","svelte-1eju9fl")},m(e,a){L(e,t,a),_(t,s),Ae(o,s,null),_(t,n),_(t,r),l&&l.m(r,null),i=!0},p(e,[t]){l&&l.p&&1&t&&h(l,a,e,e[0],t,null,null)},i(e){i||(xe(o.$$.fragment,e),xe(l,e),i=!0)},o(e){we(o.$$.fragment,e),we(l,e),i=!1},d(e){e&&k(t),Ce(o),l&&l.d(e)}}}function Fo(e,t,s){let{$$slots:o={},$$scope:n}=t;return e.$$set=e=>{"$$scope"in e&&s(0,n=e.$$scope)},[n,o]}class Ko extends Te{constructor(e){super(),Pe(this,e,Fo,qo,a,{})}}function Go(e){let t,s,o,n,r,i;o=new Ho({});const a=e[1].default,l=u(a,e,e[0],null);return{c(){t=E("section"),s=E("div"),Me(o.$$.fragment),n=M(),r=E("div"),l&&l.c(),T(r,"class","main svelte-1husw0i"),T(t,"id","palettes"),T(t,"class","svelte-1husw0i")},m(e,a){L(e,t,a),_(t,s),Ae(o,s,null),_(t,n),_(t,r),l&&l.m(r,null),i=!0},p(e,[t]){l&&l.p&&1&t&&h(l,a,e,e[0],t,null,null)},i(e){i||(xe(o.$$.fragment,e),xe(l,e),i=!0)},o(e){we(o.$$.fragment,e),we(l,e),i=!1},d(e){e&&k(t),Ce(o),l&&l.d(e)}}}function Jo(e,t,s){let{$$slots:o={},$$scope:n}=t;return e.$$set=e=>{"$$scope"in e&&s(0,n=e.$$scope)},[n,o]}function Uo(e){let t,s,o,n,r,i;o=new Ho({});const a=e[1].default,l=u(a,e,e[0],null);return{c(){t=E("section"),s=E("div"),Me(o.$$.fragment),n=M(),r=E("div"),l&&l.c(),T(r,"class","main svelte-ju14kw"),T(t,"id","spritesheets"),T(t,"class","svelte-ju14kw")},m(e,a){L(e,t,a),_(t,s),Ae(o,s,null),_(t,n),_(t,r),l&&l.m(r,null),i=!0},p(e,[t]){l&&l.p&&1&t&&h(l,a,e,e[0],t,null,null)},i(e){i||(xe(o.$$.fragment,e),xe(l,e),i=!0)},o(e){we(o.$$.fragment,e),we(l,e),i=!1},d(e){e&&k(t),Ce(o),l&&l.d(e)}}}function Vo(e,t,s){let{$$slots:o={},$$scope:n}=t;return e.$$set=e=>{"$$scope"in e&&s(0,n=e.$$scope)},[n,o]}function Yo(t){let s,o,n,r,i;return{c(){s=E("button"),o=E("div"),n=S(""),D(o,"--color",t[0]),T(o,"class","svelte-10hh6bt"),T(s,"class","color-selector svelte-10hh6bt"),O(s,"selected",t[1])},m(e,a){L(e,s,a),_(s,o),_(o,n),r||(i=C(s,"click",t[2]),r=!0)},p(e,[t]){1&t&&D(o,"--color",e[0]),2&t&&O(s,"selected",e[1])},i:e,o:e,d(e){e&&k(s),r=!1,i()}}}function Wo(e,t,s){let{color:o}=t,{selected:n}=t;return e.$$set=e=>{"color"in e&&s(0,o=e.color),"selected"in e&&s(1,n=e.selected)},[o,n,function(t){X(e,t)}]}class Zo extends Te{constructor(e){super(),Pe(this,e,Wo,Yo,a,{color:0,selected:1})}}function Xo(e,t,s){const o=e.slice();return o[5]=t[s],o[7]=s,o}function Qo(e){let t,s,o=e[0].colors,n=[];for(let t=0;t<o.length;t+=1)n[t]=en(Xo(e,o,t));const r=e=>we(n[e],1,1,(()=>{n[e]=null}));return{c(){t=E("ul");for(let e=0;e<n.length;e+=1)n[e].c()},m(e,o){L(e,t,o);for(let e=0;e<n.length;e+=1)n[e].m(t,null);s=!0},p(e,s){if(3&s){let i;for(o=e[0].colors,i=0;i<o.length;i+=1){const r=Xo(e,o,i);n[i]?(n[i].p(r,s),xe(n[i],1)):(n[i]=en(r),n[i].c(),xe(n[i],1),n[i].m(t,null))}for(ve(),i=o.length;i<n.length;i+=1)r(i);ye()}},i(e){if(!s){for(let e=0;e<o.length;e+=1)xe(n[e]);s=!0}},o(e){n=n.filter(Boolean);for(let e=0;e<n.length;e+=1)we(n[e]);s=!1},d(e){e&&k(t),z(n,e)}}}function en(e){let t,s,o,n;return s=new Zo({props:{color:e[5].rgb,selected:e[1]===e[7]}}),s.$on("click",(function(...t){return e[4](e[7],...t)})),{c(){t=E("li"),Me(s.$$.fragment),o=M()},m(e,r){L(e,t,r),Ae(s,t,null),_(t,o),n=!0},p(t,o){e=t;const n={};1&o&&(n.color=e[5].rgb),2&o&&(n.selected=e[1]===e[7]),s.$set(n)},i(e){n||(xe(s.$$.fragment,e),n=!0)},o(e){we(s.$$.fragment,e),n=!1},d(e){e&&k(t),Ce(s)}}}function tn(e){let t,s,o=e[0]&&Qo(e);return{c(){o&&o.c(),t=A()},m(e,n){o&&o.m(e,n),L(e,t,n),s=!0},p(e,[s]){e[0]?o?(o.p(e,s),1&s&&xe(o,1)):(o=Qo(e),o.c(),xe(o,1),o.m(t.parentNode,t)):o&&(ve(),we(o,1,1,(()=>{o=null})),ye())},i(e){s||(xe(o),s=!0)},o(e){we(o),s=!1},d(e){o&&o.d(e),e&&k(t)}}}function sn(e,t,s){let o,n;const{activeLayer:r,selectedColor:i}=es.stores;c(e,r,(e=>s(0,o=e))),c(e,i,(e=>s(1,n=e)));return[o,n,r,i,(e,t)=>ft.execute("palette_active_color",e)]}class on extends Te{constructor(e){super(),Pe(this,e,sn,tn,a,{})}}function nn(e){let t,s,o,n;const i=e[3].default,a=u(i,e,e[2],null);return{c(){t=E("button"),a&&a.c(),T(t,"title",e[1]),T(t,"class","svelte-1j1cp6x"),O(t,"selected",e[0])},m(r,i){L(r,t,i),a&&a.m(t,null),s=!0,o||(n=[C(t,"dblclick",e[4]),C(t,"click",e[5])],o=!0)},p(e,[o]){a&&a.p&&4&o&&h(a,i,e,e[2],o,null,null),(!s||2&o)&&T(t,"title",e[1]),1&o&&O(t,"selected",e[0])},i(e){s||(xe(a,e),s=!0)},o(e){we(a,e),s=!1},d(e){e&&k(t),a&&a.d(e),o=!1,r(n)}}}function rn(e,t,s){let{$$slots:o={},$$scope:n}=t,{selected:r}=t,{title:i}=t;return e.$$set=e=>{"selected"in e&&s(0,r=e.selected),"title"in e&&s(1,i=e.title),"$$scope"in e&&s(2,n=e.$$scope)},[r,i,n,o,function(t){X(e,t)},function(t){X(e,t)}]}class an extends Te{constructor(e){super(),Pe(this,e,rn,nn,a,{selected:0,title:1})}}function ln(e,t,s){const o=e.slice();return o[6]=t[s],o}function cn(t){let s,o;return{c(){s=I("svg"),o=I("path"),T(o,"d",t[6].icon),T(s,"xmlns","http://www.w3.org/2000/svg"),T(s,"width","18"),T(s,"height","18"),T(s,"viewBox","0 0 24 24")},m(e,t){L(e,s,t),_(s,o)},p:e,d(e){e&&k(s)}}}function un(e){let t,s,o=e[6].visible_in_toolbar&&function(e){let t,s,o,n;return s=new an({props:{title:e[6].title,selected:e[0]===e[6],$$slots:{default:[cn]},$$scope:{ctx:e}}}),s.$on("dblclick",e[3]),s.$on("click",(function(...t){return e[4](e[6],...t)})),{c(){t=E("li"),Me(s.$$.fragment),o=M(),T(t,"class","svelte-1pqmo8i")},m(e,r){L(e,t,r),Ae(s,t,null),_(t,o),n=!0},p(t,o){e=t;const n={};1&o&&(n.selected=e[0]===e[6]),512&o&&(n.$$scope={dirty:o,ctx:e}),s.$set(n)},i(e){n||(xe(s.$$.fragment,e),n=!0)},o(e){we(s.$$.fragment,e),n=!1},d(e){e&&k(t),Ce(s)}}}(e);return{c(){o&&o.c(),t=A()},m(e,n){o&&o.m(e,n),L(e,t,n),s=!0},p(e,t){e[6].visible_in_toolbar&&o.p(e,t)},i(e){s||(xe(o),s=!0)},o(e){we(o),s=!1},d(e){o&&o.d(e),e&&k(t)}}}function pn(e){let t,s,o=e[2],n=[];for(let t=0;t<o.length;t+=1)n[t]=un(ln(e,o,t));const r=e=>we(n[e],1,1,(()=>{n[e]=null}));return{c(){t=E("ul");for(let e=0;e<n.length;e+=1)n[e].c()},m(e,o){L(e,t,o);for(let e=0;e<n.length;e+=1)n[e].m(t,null);s=!0},p(e,[s]){if(5&s){let i;for(o=e[2],i=0;i<o.length;i+=1){const r=ln(e,o,i);n[i]?(n[i].p(r,s),xe(n[i],1)):(n[i]=un(r),n[i].c(),xe(n[i],1),n[i].m(t,null))}for(ve(),i=o.length;i<n.length;i+=1)r(i);ye()}},i(e){if(!s){for(let e=0;e<o.length;e+=1)xe(n[e]);s=!0}},o(e){n=n.filter(Boolean);for(let e=0;e<n.length;e+=1)we(n[e]);s=!1},d(e){e&&k(t),z(n,e)}}}function hn(e,t,s){let o;const{tools:n,activeTool:r}=qs;c(e,r,(e=>s(0,o=e)));const i=Object.values(n);i.sort(((e,t)=>t.weight-e.weight));return[o,r,i,e=>ft.execute("spritesheet_tool_dblclick"),(e,t)=>ft.execute("spritesheet_set_active_tool",e.enum)]}class dn extends Te{constructor(e){super(),Pe(this,e,hn,pn,a,{})}}function fn(t){let s,o,n,r,i,a,l;return n=new dn({}),a=new on({}),{c(){s=E("section"),o=E("section"),Me(n.$$.fragment),r=M(),i=E("section"),Me(a.$$.fragment),T(o,"class","toolbar-section svelte-t490rv"),T(i,"class","color-selector-section svelte-t490rv"),T(s,"class","toolbar svelte-t490rv")},m(e,t){L(e,s,t),_(s,o),Ae(n,o,null),_(s,r),_(s,i),Ae(a,i,null),l=!0},p:e,i(e){l||(xe(n.$$.fragment,e),xe(a.$$.fragment,e),l=!0)},o(e){we(n.$$.fragment,e),we(a.$$.fragment,e),l=!1},d(e){e&&k(s),Ce(n),Ce(a)}}}class mn extends Te{constructor(e){super(),Pe(this,e,null,fn,a,{})}}function gn(e){let t,o,n,r;const i=e[4].default,a=u(i,e,e[3],null),l=a||function(e){let t;return{c(){t=S("placeholder")},m(e,s){L(e,t,s)},d(e){e&&k(t)}}}();let c=[{role:"button"},e[2]],p={};for(let e=0;e<c.length;e+=1)p=s(p,c[e]);return{c(){t=E("button"),l&&l.c(),j(t,p),O(t,"danger","danger"==e[0]),O(t,"svelte-vh27lv",!0)},m(s,i){L(s,t,i),l&&l.m(t,null),o=!0,n||(r=C(t,"click",e[1]),n=!0)},p(e,[s]){a&&a.p&&8&s&&h(a,i,e,e[3],s,null,null),j(t,p=Ee(c,[{role:"button"},4&s&&e[2]])),O(t,"danger","danger"==e[0]),O(t,"svelte-vh27lv",!0)},i(e){o||(xe(l,e),o=!0)},o(e){we(l,e),o=!1},d(e){e&&k(t),l&&l.d(e),n=!1,r()}}}function $n(e,t,o){let{$$slots:n={},$$scope:r}=t;const i=Z();let{variant:a}=t;return e.$$set=e=>{o(2,t=s(s({},t),d(e))),"variant"in e&&o(0,a=e.variant),"$$scope"in e&&o(3,r=e.$$scope)},t=d(t),[a,e=>{("danger"!=a||e.ctrlKey||e.altKey)&&i("click")},t,r,n]}class vn extends Te{constructor(e){super(),Pe(this,e,$n,gn,a,{variant:0})}}const yn=(e,t,s,o)=>{const n=e;if(t<n.length){const o=e.slice(0,t);e=o.slice(0,o.lastIndexOf(s))}return"function"==typeof o&&(e=o.call(null,e,n,s)),e},xn=e=>e.split(/[\\/]/).pop();function wn(e){let t,s,o,n;const i=e[10].default,a=u(i,e,e[9],null),l=a||function(e){let t;return{c(){t=S("Label")},m(e,s){L(e,t,s)},d(e){e&&k(t)}}}();return{c(){t=E("div"),l&&l.c(),T(t,"class","heading svelte-ekw9ql"),T(t,"spellcheck","false"),O(t,"active",e[0])},m(r,i){L(r,t,i),l&&l.m(t,null),e[11](t),s=!0,o||(n=[C(t,"click",e[1]),C(t,"focus",e[3]),C(t,"blur",e[5]),C(t,"keydown",e[4])],o=!0)},p(e,[s]){a&&a.p&&512&s&&h(a,i,e,e[9],s,null,null),1&s&&O(t,"active",e[0])},i(e){s||(xe(l,e),s=!0)},o(e){we(l,e),s=!1},d(s){s&&k(t),l&&l.d(s),e[11](null),o=!1,r(n)}}}function bn(e,t,s){let{$$slots:o={},$$scope:n}=t,{editable:r=!0}=t,{active:i}=t,{label:a}=t,{iconIndicator:l}=t;const c=Z();let u,p=null;return e.$$set=e=>{"editable"in e&&s(7,r=e.editable),"active"in e&&s(0,i=e.active),"label"in e&&s(8,a=e.label),"iconIndicator"in e&&s(6,l=e.iconIndicator),"$$scope"in e&&s(9,n=e.$$scope)},[i,e=>{if(!r)return;e.preventDefault();let t=!1;1==e.detail&&e.target==u?(c("makeActive"),t||(t=!0,setTimeout((e=>t=!1),60))):(s(6,l=!1),s(2,u.contentEditable=!0,u),u.focus())},u,e=>{e.target.textContent=a;const t=document.createRange(),s=window.getSelection();t.selectNodeContents(e.target),s.removeAllRanges(),s.addRange(t)},e=>{if(p||(p=e.currentTarget.textContent),e.stopPropagation(),e.stopImmediatePropagation(),27==e.which)return e.currentTarget.textContent=p,e.preventDefault(),void u.blur();if(13==e.which&&(e.preventDefault(),u.blur()),8==e.which||46==e.which||37==e.which||39==e.which)return;/^[a-z\s0-8\-\_]$/i.test(e.key)||"Backspace"===e.key?e.currentTarget.textContent.length>20&&e.preventDefault():e.preventDefault()},e=>{p=null,s(6,l=!0);const t=e.target.textContent;e.target.textContent=yn(t,15,"",((e,t)=>e!=t?e+"...":e)),window.getSelection().removeAllRanges(),e.target.contentEditable=!1,c("change",t)},l,r,a,n,o,function(e){ee[e?"unshift":"push"]((()=>{u=e,s(2,u)}))}]}class _n extends Te{constructor(e){super(),Pe(this,e,bn,wn,a,{editable:7,active:0,label:8,iconIndicator:6,edit:1})}get edit(){return this.$$.ctx[1]}}const Ln=(e,t)=>{if(!t||"string"!=typeof t.type)throw new Error("Invalid 'drag' actions properties. Expecting 'type' of type 'string'");if(!t.value)throw new Error("Invalid 'drag' actions value.");e.draggable=!0,e.classList.add("draggable");const s=e=>{e.stopImmediatePropagation(),e.dataTransfer.setData(t.type,JSON.stringify(t.value||"")),window.dispatchEvent(new Event("mouseup"))};return e.addEventListener("dragstart",s),{destroy(){e.removeEventListener("dragstart",s)}}},kn=(e,t)=>{if(!t)throw new Error("Invalid 'drop' actions props.");const s=(e,s)=>{if(t[e]||"function"==typeof t[e])return t[e];if(!s)throw new Error(`Invalid 'drop' callback : [${e}]`)},o=t=>{t.preventDefault(),s("over",!0).call(null,t,e)};e.addEventListener("dragover",o);e.addEventListener("dragleave",(t=>{s("leave",!0).call(null,t,e)}));const n=o=>{s("drop").call(null,{e:o,node:e,value:t.value})};return e.addEventListener("drop",n),{destroy(){e.removeEventListener("dragover",o),e.removeEventListener("drop",n)}}};function zn(e){let t;return{c(){t=S(e[5])},m(e,s){L(e,t,s)},p(e,s){32&s&&N(t,e[5])},d(e){e&&k(t)}}}function En(e){let t,s,o,n;s=new Pt({props:{$$slots:{default:[In]},$$scope:{ctx:e}}}),s.$on("click",e[19]);let r=e[2]&&Sn(e);return{c(){t=E("div"),Me(s.$$.fragment),o=M(),r&&r.c(),T(t,"class","icon-indicator svelte-18jtf9z")},m(e,i){L(e,t,i),Ae(s,t,null),_(t,o),r&&r.m(t,null),n=!0},p(e,o){const n={};1048576&o&&(n.$$scope={dirty:o,ctx:e}),s.$set(n),e[2]?r?(r.p(e,o),4&o&&xe(r,1)):(r=Sn(e),r.c(),xe(r,1),r.m(t,null)):r&&(ve(),we(r,1,1,(()=>{r=null})),ye())},i(e){n||(xe(s.$$.fragment,e),xe(r),n=!0)},o(e){we(s.$$.fragment,e),we(r),n=!1},d(e){e&&k(t),Ce(s),r&&r.d()}}}function In(e){let t,s;return{c(){t=I("svg"),s=I("path"),T(s,"d","M19.769 9.923l-12.642 12.639-7.127 1.438 1.438-7.128 12.641-12.64 5.69 5.691zm1.414-1.414l2.817-2.82-5.691-5.689-2.816 2.817 5.69 5.692z"),T(s,"class","svelte-18jtf9z"),T(t,"xmlns","http://www.w3.org/2000/svg"),T(t,"width","12"),T(t,"height","12"),T(t,"viewBox","0 0 24 24"),T(t,"class","svelte-18jtf9z")},m(e,o){L(e,t,o),_(t,s)},d(e){e&&k(t)}}}function Sn(e){let t,s,o,n;return t=new Pt({props:{$$slots:{default:[Mn]},$$scope:{ctx:e}}}),t.$on("click",e[11]),o=new Pt({props:{variant:"danger",$$slots:{default:[An]},$$scope:{ctx:e}}}),o.$on("click",e[10]),{c(){Me(t.$$.fragment),s=M(),Me(o.$$.fragment)},m(e,r){Ae(t,e,r),L(e,s,r),Ae(o,e,r),n=!0},p(e,s){const n={};1048576&s&&(n.$$scope={dirty:s,ctx:e}),t.$set(n);const r={};1048576&s&&(r.$$scope={dirty:s,ctx:e}),o.$set(r)},i(e){n||(xe(t.$$.fragment,e),xe(o.$$.fragment,e),n=!0)},o(e){we(t.$$.fragment,e),we(o.$$.fragment,e),n=!1},d(e){Ce(t,e),e&&k(s),Ce(o,e)}}}function Mn(e){let t,s;return{c(){t=I("svg"),s=I("path"),T(s,"d","M18 6v-6h-18v18h6v6h18v-18h-6zm-12 10h-4v-14h14v4h-10v10zm16 6h-14v-14h14v14zm-3-8h-3v-3h-2v3h-3v2h3v3h2v-3h3v-2z"),T(s,"class","svelte-18jtf9z"),T(t,"xmlns","http://www.w3.org/2000/svg"),T(t,"width","12"),T(t,"height","12"),T(t,"viewBox","0 0 24 24"),T(t,"class","svelte-18jtf9z")},m(e,o){L(e,t,o),_(t,s)},d(e){e&&k(t)}}}function An(e){let t,s;return{c(){t=I("svg"),s=I("path"),T(s,"d","M3 6v18h18v-18h-18zm5 14c0 .552-.448 1-1 1s-1-.448-1-1v-10c0-.552.448-1 1-1s1 .448 1 1v10zm5 0c0 .552-.448 1-1 1s-1-.448-1-1v-10c0-.552.448-1 1-1s1 .448 1 1v10zm5 0c0 .552-.448 1-1 1s-1-.448-1-1v-10c0-.552.448-1 1-1s1 .448 1 1v10zm4-18v2h-20v-2h5.711c.9 0 1.631-1.099 1.631-2h5.315c0 .901.73 2 1.631 2h5.712z"),T(s,"class","svelte-18jtf9z"),T(t,"xmlns","http://www.w3.org/2000/svg"),T(t,"width","12"),T(t,"height","12"),T(t,"viewBox","0 0 24 24"),T(t,"class","svelte-18jtf9z")},m(e,o){L(e,t,o),_(t,s)},d(e){e&&k(t)}}}function Cn(e){let t,s,o,n,r;function i(t){e[15].call(null,t)}let a={active:e[8],label:e[0].label,$$slots:{default:[zn]},$$scope:{ctx:e}};void 0!==e[4]&&(a.iconIndicator=e[4]),t=new _n({props:a}),ee.push((()=>Se(t,"iconIndicator",i))),e[16](t),t.$on("makeActive",e[17]),t.$on("change",e[18]);let l=e[4]&&En(e);return{c(){Me(t.$$.fragment),o=M(),l&&l.c(),n=A()},m(e,s){Ae(t,e,s),L(e,o,s),l&&l.m(e,s),L(e,n,s),r=!0},p(e,o){const r={};256&o&&(r.active=e[8]),1&o&&(r.label=e[0].label),1048608&o&&(r.$$scope={dirty:o,ctx:e}),!s&&16&o&&(s=!0,r.iconIndicator=e[4],le((()=>s=!1))),t.$set(r),e[4]?l?(l.p(e,o),16&o&&xe(l,1)):(l=En(e),l.c(),xe(l,1),l.m(n.parentNode,n)):l&&(ve(),we(l,1,1,(()=>{l=null})),ye())},i(e){r||(xe(t.$$.fragment,e),xe(l),r=!0)},o(e){we(t.$$.fragment,e),we(l),r=!1},d(s){e[16](null),Ce(t,s),s&&k(o),l&&l.d(s),s&&k(n)}}}function Pn(e){let t,s,o,n,a,l,c,p;s=new Mt({props:{$$slots:{default:[Cn]},$$scope:{ctx:e}}});const d=e[14].default,f=u(d,e,e[20],null);return{c(){t=E("div"),Me(s.$$.fragment),o=M(),f&&f.c(),T(t,"class","layer-item svelte-18jtf9z"),O(t,"over",e[7]),O(t,"active",e[8])},m(r,i){L(r,t,i),Ae(s,t,null),_(t,o),f&&f.m(t,null),l=!0,c||(p=[g(n=Ln.call(null,t,{type:"flipPalette",value:{layerIndex:e[3]}})),g(a=kn.call(null,t,{...e[12],value:{layerIndex:e[3]}}))],c=!0)},p(e,[o]){const r={};1048949&o&&(r.$$scope={dirty:o,ctx:e}),s.$set(r),f&&f.p&&1048576&o&&h(f,d,e,e[20],o,null,null),n&&i(n.update)&&8&o&&n.update.call(null,{type:"flipPalette",value:{layerIndex:e[3]}}),a&&i(a.update)&&8&o&&a.update.call(null,{...e[12],value:{layerIndex:e[3]}}),128&o&&O(t,"over",e[7]),256&o&&O(t,"active",e[8])},i(e){l||(xe(s.$$.fragment,e),xe(f,e),l=!0)},o(e){we(s.$$.fragment,e),we(f,e),l=!1},d(e){e&&k(t),Ce(s),f&&f.d(e),c=!1,r(p)}}}function Tn(t,s,o){let n,r,i=e,a=()=>(i(),i=l(h,(e=>o(13,r=e))),h);t.$$.on_destroy.push((()=>i()));let{$$slots:c={},$$scope:u}=s,{source:p}=s,{activeLayer:h}=s;a();let d,f,{showEditButtons:m=!0}=s,{layerIndex:g}=s,$=!0;const v=Z();let y;const x={over:e=>o(7,y=!0),leave:e=>o(7,y=!1),drop:({e:e,value:t})=>{o(7,y=!1);const s=e.dataTransfer.getData("flipPalette");if(s){const e=Number(JSON.parse(s).layerIndex);v("swapLayers",{to:e,from:t.layerIndex})}}};return t.$$set=e=>{"source"in e&&o(0,p=e.source),"activeLayer"in e&&a(o(1,h=e.activeLayer)),"showEditButtons"in e&&o(2,m=e.showEditButtons),"layerIndex"in e&&o(3,g=e.layerIndex),"$$scope"in e&&o(20,u=e.$$scope)},t.$$.update=()=>{1&t.$$.dirty&&o(5,d=yn(p.label,15,"",((e,t)=>e!=t?e+"...":e))),8193&t.$$.dirty&&o(8,n=p==r)},[p,h,m,g,$,d,f,y,n,v,e=>{e.ctrlKey||e.altKey?v("remove",p):console.warn("Dispatch tooltip to let user know he has to hold down ctr or alt key")},e=>v("clone",p),x,r,c,function(e){$=e,o(4,$)},function(e){ee[e?"unshift":"push"]((()=>{f=e,o(6,f)}))},e=>v("makeActive",p),e=>v("updateLabel",{source:p,value:e.detail}),e=>f.edit(e),u]}class jn extends Te{constructor(e){super(),Pe(this,e,Tn,Pn,a,{source:0,activeLayer:1,showEditButtons:2,layerIndex:3})}}function Nn(e){let t;const s=e[6].default,o=u(s,e,e[7],null);return{c(){o&&o.c()},m(e,s){o&&o.m(e,s),t=!0},p(e,t){o&&o.p&&128&t&&h(o,s,e,e[7],t,null,null)},i(e){t||(xe(o,e),t=!0)},o(e){we(o,e),t=!1},d(e){o&&o.d(e)}}}function Dn(e){let t,o;const n=[e[5]];let r={$$slots:{default:[Nn]},$$scope:{ctx:e}};for(let e=0;e<n.length;e+=1)r=s(r,n[e]);return t=new jn({props:r}),t.$on("swapLayers",e[4]),t.$on("remove",e[0]),t.$on("updateLabel",e[1]),t.$on("makeActive",e[2]),t.$on("clone",e[3]),{c(){Me(t.$$.fragment)},m(e,s){Ae(t,e,s),o=!0},p(e,[s]){const o=32&s?Ee(n,[Ie(e[5])]):{};128&s&&(o.$$scope={dirty:s,ctx:e}),t.$set(o)},i(e){o||(xe(t.$$.fragment,e),o=!0)},o(e){we(t.$$.fragment,e),o=!1},d(e){Ce(t,e)}}}function Rn(e,t,o){const n=[];let r=f(t,n),{$$slots:i={},$$scope:a}=t;return e.$$set=e=>{t=s(s({},t),d(e)),o(5,r=f(t,n)),"$$scope"in e&&o(7,a=e.$$scope)},[e=>ft.execute("spritesheet_remove",e.detail),e=>ft.execute("spritesheet_update_layer_label",{source:e.detail.source,label:e.detail.value}),e=>ft.execute("spritesheet_make_layer_active",e.detail),e=>ft.execute("spritesheet_clone_layer",e.detail),e=>ft.execute("spritesheet_swap_layers",e.detail),r,i,a]}class On extends Te{constructor(e){super(),Pe(this,e,Rn,Dn,a,{})}}function Bn(e,t,s){const o=e.slice();return o[4]=t[s],o[6]=s,o}function Hn(t){let s;return{c(){s=E("div"),s.textContent="No spritesheets",T(s,"class","center svelte-1xx5how")},m(e,t){L(e,s,t)},p:e,i:e,o:e,d(e){e&&k(s)}}}function qn(t){let s,o,n=t[0],r=Gn(t);return{c(){r.c(),s=A()},m(e,t){r.m(e,t),L(e,s,t),o=!0},p(t,o){1&o&&a(n,n=t[0])?(ve(),we(r,1,1,e),ye(),r=Gn(t),r.c(),xe(r),r.m(s.parentNode,s)):r.p(t,o)},i(e){o||(xe(r),o=!0)},o(e){we(r),o=!1},d(e){e&&k(s),r.d(e)}}}function Fn(e){let t,s,o,n;return s=new Ns({props:{source:e[4]}}),{c(){t=E("div"),Me(s.$$.fragment),o=M(),T(t,"class","canvas-preview-wrapper svelte-1xx5how")},m(e,r){L(e,t,r),Ae(s,t,null),L(e,o,r),n=!0},p(e,t){const o={};1&t&&(o.source=e[4]),s.$set(o)},i(e){n||(xe(s.$$.fragment,e),n=!0)},o(e){we(s.$$.fragment,e),n=!1},d(e){e&&k(t),Ce(s),e&&k(o)}}}function Kn(e){let t,s;return t=new On({props:{source:e[4],activeLayer:e[1],layerIndex:e[6],$$slots:{default:[Fn]},$$scope:{ctx:e}}}),{c(){Me(t.$$.fragment)},m(e,o){Ae(t,e,o),s=!0},p(e,s){const o={};1&s&&(o.source=e[4]),129&s&&(o.$$scope={dirty:s,ctx:e}),t.$set(o)},i(e){s||(xe(t.$$.fragment,e),s=!0)},o(e){we(t.$$.fragment,e),s=!1},d(e){Ce(t,e)}}}function Gn(e){let t,s,o=e[0],n=[];for(let t=0;t<o.length;t+=1)n[t]=Kn(Bn(e,o,t));const r=e=>we(n[e],1,1,(()=>{n[e]=null}));return{c(){for(let e=0;e<n.length;e+=1)n[e].c();t=A()},m(e,o){for(let t=0;t<n.length;t+=1)n[t].m(e,o);L(e,t,o),s=!0},p(e,s){if(3&s){let i;for(o=e[0],i=0;i<o.length;i+=1){const r=Bn(e,o,i);n[i]?(n[i].p(r,s),xe(n[i],1)):(n[i]=Kn(r),n[i].c(),xe(n[i],1),n[i].m(t.parentNode,t))}for(ve(),i=o.length;i<n.length;i+=1)r(i);ye()}},i(e){if(!s){for(let e=0;e<o.length;e+=1)xe(n[e]);s=!0}},o(e){n=n.filter(Boolean);for(let e=0;e<n.length;e+=1)we(n[e]);s=!1},d(e){z(n,e),e&&k(t)}}}function Jn(e){let t;return{c(){t=S("Create spritesheet")},m(e,s){L(e,t,s)},d(e){e&&k(t)}}}function Un(e){let t,s,o,n,r,i,a,l;const c=[qn,Hn],u=[];function p(e,t){return e[0].length?0:1}return o=p(e),n=u[o]=c[o](e),a=new vn({props:{$$slots:{default:[Jn]},$$scope:{ctx:e}}}),a.$on("click",e[3]),{c(){t=E("div"),s=E("div"),n.c(),r=M(),i=E("div"),Me(a.$$.fragment),T(s,"class","layers svelte-1xx5how"),T(i,"class","center svelte-1xx5how"),T(t,"class","palette-layer svelte-1xx5how")},m(e,n){L(e,t,n),_(t,s),u[o].m(s,null),_(t,r),_(t,i),Ae(a,i,null),l=!0},p(e,[t]){let r=o;o=p(e),o===r?u[o].p(e,t):(ve(),we(u[r],1,1,(()=>{u[r]=null})),ye(),n=u[o],n?n.p(e,t):(n=u[o]=c[o](e),n.c()),xe(n,1),n.m(s,null));const i={};128&t&&(i.$$scope={dirty:t,ctx:e}),a.$set(i)},i(e){l||(xe(n),xe(a.$$.fragment,e),l=!0)},o(e){we(n),we(a.$$.fragment,e),l=!1},d(e){e&&k(t),u[o].d(),Ce(a)}}}function Vn(e,t,s){let o;const{activeLayer:n,layers:r}=ms.stores;c(e,r,(e=>s(0,o=e)));return[o,n,r,e=>ft.execute("spritesheet_create")]}class Yn extends Te{constructor(e){super(),Pe(this,e,Vn,Un,a,{})}}function Wn(e){let t;const s=e[6].default,o=u(s,e,e[7],null);return{c(){o&&o.c()},m(e,s){o&&o.m(e,s),t=!0},p(e,t){o&&o.p&&128&t&&h(o,s,e,e[7],t,null,null)},i(e){t||(xe(o,e),t=!0)},o(e){we(o,e),t=!1},d(e){o&&o.d(e)}}}function Zn(e){let t,o;const n=[e[5]];let r={$$slots:{default:[Wn]},$$scope:{ctx:e}};for(let e=0;e<n.length;e+=1)r=s(r,n[e]);return t=new jn({props:r}),t.$on("swapLayers",e[4]),t.$on("remove",e[0]),t.$on("updateLabel",e[1]),t.$on("makeActive",e[2]),t.$on("clone",e[3]),{c(){Me(t.$$.fragment)},m(e,s){Ae(t,e,s),o=!0},p(e,[s]){const o=32&s?Ee(n,[Ie(e[5])]):{};128&s&&(o.$$scope={dirty:s,ctx:e}),t.$set(o)},i(e){o||(xe(t.$$.fragment,e),o=!0)},o(e){we(t.$$.fragment,e),o=!1},d(e){Ce(t,e)}}}function Xn(e,t,o){const n=[];let r=f(t,n),{$$slots:i={},$$scope:a}=t;return e.$$set=e=>{t=s(s({},t),d(e)),o(5,r=f(t,n)),"$$scope"in e&&o(7,a=e.$$scope)},[e=>ft.execute("palette_remove",e.detail),e=>ft.execute("palette_update_layer_label",{source:e.detail.source,label:e.detail.value}),e=>ft.execute("palette_make_layer_active",e.detail),e=>ft.execute("palette_clone_layer",e.detail),e=>ft.execute("palette_swap_layers",e.detail),r,i,a]}class Qn extends Te{constructor(e){super(),Pe(this,e,Xn,Zn,a,{})}}function er(e){let t,s,o,n,a,l;const c=e[10].default,p=u(c,e,e[9],null),d=p||function(e){let t,s;return{c(){t=S("0x"),s=S(e[1])},m(e,o){L(e,t,o),L(e,s,o)},p(e,t){2&t&&N(s,e[1])},d(e){e&&k(t),e&&k(s)}}}(e);return{c(){t=E("div"),s=E("span"),d&&d.c(),D(s,"pointer-events","none"),T(s,"class","svelte-1j057y7"),T(t,"class","color svelte-1j057y7"),T(t,"data-hex",e[1]),D(t,"--rgb","rgb("+e[0].join(",")+")"),O(t,"active",e[5]&&e[4]==e[6]&&e[3]==es.layerIndexFromSource(e[5]))},m(r,i){L(r,t,i),_(t,s),d&&d.m(s,null),n=!0,a||(l=[C(t,"click",e[11]),g(o=Ln.call(null,t,{type:e[2],value:{rgb:e[0],hex:e[1],type:e[2],layerIndex:e[3],colorIndex:e[4]}}))],a=!0)},p(e,[s]){p?p.p&&512&s&&h(p,c,e,e[9],s,null,null):d&&d.p&&2&s&&d.p(e,s),(!n||2&s)&&T(t,"data-hex",e[1]),(!n||1&s)&&D(t,"--rgb","rgb("+e[0].join(",")+")"),o&&i(o.update)&&31&s&&o.update.call(null,{type:e[2],value:{rgb:e[0],hex:e[1],type:e[2],layerIndex:e[3],colorIndex:e[4]}}),120&s&&O(t,"active",e[5]&&e[4]==e[6]&&e[3]==es.layerIndexFromSource(e[5]))},i(e){n||(xe(d,e),n=!0)},o(e){we(d,e),n=!1},d(e){e&&k(t),d&&d.d(e),a=!1,r(l)}}}function tr(e,t,s){let o,n,{$$slots:r={},$$scope:i}=t,{rgb:a}=t,{hex:l}=t,{type:u}=t,{layerIndex:p}=t,{colorIndex:h}=t;const{selectedColor:d,activeLayer:f}=es.stores;return c(e,d,(e=>s(6,n=e))),c(e,f,(e=>s(5,o=e))),e.$$set=e=>{"rgb"in e&&s(0,a=e.rgb),"hex"in e&&s(1,l=e.hex),"type"in e&&s(2,u=e.type),"layerIndex"in e&&s(3,p=e.layerIndex),"colorIndex"in e&&s(4,h=e.colorIndex),"$$scope"in e&&s(9,i=e.$$scope)},[a,l,u,p,h,o,n,d,f,i,r,function(t){X(e,t)}]}class sr extends Te{constructor(e){super(),Pe(this,e,tr,er,a,{rgb:0,hex:1,type:2,layerIndex:3,colorIndex:4})}}function or(e,t,s){const o=e.slice();return o[7]=t[s],o[9]=s,o}function nr(e,t,s){const o=e.slice();return o[10]=t[s],o[12]=s,o}function rr(t){let s;return{c(){s=E("div"),s.textContent="No palettes",T(s,"class","center svelte-njkqod")},m(e,t){L(e,s,t)},p:e,i:e,o:e,d(e){e&&k(s)}}}function ir(e){let t,s,o=e[1],n=[];for(let t=0;t<o.length;t+=1)n[t]=ur(or(e,o,t));const r=e=>we(n[e],1,1,(()=>{n[e]=null}));return{c(){for(let e=0;e<n.length;e+=1)n[e].c();t=A()},m(e,o){for(let t=0;t<n.length;t+=1)n[t].m(e,o);L(e,t,o),s=!0},p(e,s){if(23&s){let i;for(o=e[1],i=0;i<o.length;i+=1){const r=or(e,o,i);n[i]?(n[i].p(r,s),xe(n[i],1)):(n[i]=ur(r),n[i].c(),xe(n[i],1),n[i].m(t.parentNode,t))}for(ve(),i=o.length;i<n.length;i+=1)r(i);ye()}},i(e){if(!s){for(let e=0;e<o.length;e+=1)xe(n[e]);s=!0}},o(e){n=n.filter(Boolean);for(let e=0;e<n.length;e+=1)we(n[e]);s=!1},d(e){z(n,e),e&&k(t)}}}function ar(e){let t,s,o=e[10].hex+"";return{c(){t=S("0x"),s=S(o)},m(e,o){L(e,t,o),L(e,s,o)},p(e,t){2&t&&o!==(o=e[10].hex+"")&&N(s,o)},d(e){e&&k(t),e&&k(s)}}}function lr(e,t){let s,o,n,r,a,l,c;return o=new sr({props:{hex:t[10].hex,rgb:t[10].rgb,layerIndex:t[9],colorIndex:t[12],type:"swap",$$slots:{default:[ar]},$$scope:{ctx:t}}}),{key:e,first:null,c(){s=E("li"),Me(o.$$.fragment),n=M(),T(s,"class","svelte-njkqod"),this.first=s},m(e,i){L(e,s,i),Ae(o,s,null),_(s,n),a=!0,l||(c=g(r=kn.call(null,s,{...t[4],value:{layerIndex:t[9],colorIndex:t[12]}})),l=!0)},p(e,s){t=e;const n={};2&s&&(n.hex=t[10].hex),2&s&&(n.rgb=t[10].rgb),2&s&&(n.colorIndex=t[12]),8194&s&&(n.$$scope={dirty:s,ctx:t}),o.$set(n),r&&i(r.update)&&2&s&&r.update.call(null,{...t[4],value:{layerIndex:t[9],colorIndex:t[12]}})},i(e){a||(xe(o.$$.fragment,e),a=!0)},o(e){we(o.$$.fragment,e),a=!1},d(e){e&&k(s),Ce(o),l=!1,c()}}}function cr(e){let t,s,o,n=[],r=new Map,i=e[7].colors;const a=e=>e[12];for(let t=0;t<i.length;t+=1){let s=nr(e,i,t),o=a(s);r.set(o,n[t]=lr(o,s))}return{c(){t=E("ul");for(let e=0;e<n.length;e+=1)n[e].c();s=M(),T(t,"class","svelte-njkqod")},m(e,r){L(e,t,r);for(let e=0;e<n.length;e+=1)n[e].m(t,null);L(e,s,r),o=!0},p(e,s){18&s&&(i=e[7].colors,ve(),n=ze(n,s,a,1,e,i,r,t,Le,lr,null,nr),ye())},i(e){if(!o){for(let e=0;e<i.length;e+=1)xe(n[e]);o=!0}},o(e){for(let e=0;e<n.length;e+=1)we(n[e]);o=!1},d(e){e&&k(t);for(let e=0;e<n.length;e+=1)n[e].d();e&&k(s)}}}function ur(e){let t,s;return t=new Qn({props:{source:e[7],showEditButtons:e[0],activeLayer:e[2],layerIndex:e[9],$$slots:{default:[cr]},$$scope:{ctx:e}}}),{c(){Me(t.$$.fragment)},m(e,o){Ae(t,e,o),s=!0},p(e,s){const o={};2&s&&(o.source=e[7]),1&s&&(o.showEditButtons=e[0]),8194&s&&(o.$$scope={dirty:s,ctx:e}),t.$set(o)},i(e){s||(xe(t.$$.fragment,e),s=!0)},o(e){we(t.$$.fragment,e),s=!1},d(e){Ce(t,e)}}}function pr(e){let t,s;return t=new vn({props:{$$slots:{default:[hr]},$$scope:{ctx:e}}}),t.$on("click",e[5]),{c(){Me(t.$$.fragment)},m(e,o){Ae(t,e,o),s=!0},p(e,s){const o={};8192&s&&(o.$$scope={dirty:s,ctx:e}),t.$set(o)},i(e){s||(xe(t.$$.fragment,e),s=!0)},o(e){we(t.$$.fragment,e),s=!1},d(e){Ce(t,e)}}}function hr(e){let t;return{c(){t=S("Create palette")},m(e,s){L(e,t,s)},d(e){e&&k(t)}}}function dr(e){let t,s,o,n,r,i,a;const l=[ir,rr],c=[];function u(e,t){return e[1]&&e[1].length?0:1}o=u(e),n=c[o]=l[o](e);let p=e[0]&&pr(e);return{c(){t=E("div"),s=E("div"),n.c(),r=M(),i=E("div"),p&&p.c(),T(s,"class","layers svelte-njkqod"),T(i,"class","center svelte-njkqod"),T(t,"class","palette-layer svelte-njkqod")},m(e,n){L(e,t,n),_(t,s),c[o].m(s,null),_(t,r),_(t,i),p&&p.m(i,null),a=!0},p(e,[t]){let r=o;o=u(e),o===r?c[o].p(e,t):(ve(),we(c[r],1,1,(()=>{c[r]=null})),ye(),n=c[o],n?n.p(e,t):(n=c[o]=l[o](e),n.c()),xe(n,1),n.m(s,null)),e[0]?p?(p.p(e,t),1&t&&xe(p,1)):(p=pr(e),p.c(),xe(p,1),p.m(i,null)):p&&(ve(),we(p,1,1,(()=>{p=null})),ye())},i(e){a||(xe(n),xe(p),a=!0)},o(e){we(n),we(p),a=!1},d(e){e&&k(t),c[o].d(),p&&p.d()}}}function fr(e,t,s){let o,{showEditButtons:n=!0}=t;const{activeLayer:r,layers:i}=es.stores;c(e,i,(e=>s(1,o=e)));const a={over:e=>!0,leave:e=>!1,drop:({e:e,value:t})=>{const s=e.dataTransfer.getData("swap");s&&i.swapColors({...JSON.parse(s),to:{...t}});const o=e.dataTransfer.getData("replace");o&&i.replaceColor({...JSON.parse(o),...t})}};return e.$$set=e=>{"showEditButtons"in e&&s(0,n=e.showEditButtons)},[n,o,r,i,a,e=>ft.execute("palette_create")]}class mr extends Te{constructor(e){super(),Pe(this,e,fr,dr,a,{showEditButtons:0})}}var gr=(e,t)=>{const s=s=>{e.contains(s.target)||(s.preventDefault(),t.call(null))};return window.addEventListener("click",s),{destroy(){window.removeEventListener("click",s)}}};function $r(e){let t,s,o,n;const r=e[1].default,i=u(r,e,e[0],null);return{c(){t=E("button"),i&&i.c(),T(t,"class","svelte-8gzkl6")},m(r,a){L(r,t,a),i&&i.m(t,null),s=!0,o||(n=C(t,"click",e[2]),o=!0)},p(e,[t]){i&&i.p&&1&t&&h(i,r,e,e[0],t,null,null)},i(e){s||(xe(i,e),s=!0)},o(e){we(i,e),s=!1},d(e){e&&k(t),i&&i.d(e),o=!1,n()}}}function vr(e,t,s){let{$$slots:o={},$$scope:n}=t;return e.$$set=e=>{"$$scope"in e&&s(0,n=e.$$scope)},[n,o,function(t){X(e,t)}]}class yr extends Te{constructor(e){super(),Pe(this,e,vr,$r,a,{})}}const xr=e=>({}),wr=e=>({}),br=e=>({}),_r=e=>({});function Lr(e){let t;const s=e[1].icon,o=u(s,e,e[4],_r);return{c(){o&&o.c()},m(e,s){o&&o.m(e,s),t=!0},p(e,t){o&&o.p&&16&t&&h(o,s,e,e[4],t,br,_r)},i(e){t||(xe(o,e),t=!0)},o(e){we(o,e),t=!1},d(e){o&&o.d(e)}}}function kr(e){let t,s,o,n,r,a,l,c,p;const d=e[1].default,f=u(d,e,e[4],null);o=new yr({props:{$$slots:{default:[Lr]},$$scope:{ctx:e}}}),o.$on("click",e[2]);const m=e[1].list,$=u(m,e,e[4],wr);return{c(){t=E("div"),f&&f.c(),s=M(),Me(o.$$.fragment),n=M(),r=E("div"),$&&$.c(),T(r,"class","dropdown svelte-1rwcx4c"),T(t,"class","select-button svelte-1rwcx4c"),O(t,"active",e[0])},m(i,u){L(i,t,u),f&&f.m(t,null),_(t,s),Ae(o,t,null),_(t,n),_(t,r),$&&$.m(r,null),l=!0,c||(p=g(a=gr.call(null,t,e[3])),c=!0)},p(e,[s]){f&&f.p&&16&s&&h(f,d,e,e[4],s,null,null);const n={};16&s&&(n.$$scope={dirty:s,ctx:e}),o.$set(n),$&&$.p&&16&s&&h($,m,e,e[4],s,xr,wr),a&&i(a.update)&&1&s&&a.update.call(null,e[3]),1&s&&O(t,"active",e[0])},i(e){l||(xe(f,e),xe(o.$$.fragment,e),xe($,e),l=!0)},o(e){we(f,e),we(o.$$.fragment,e),we($,e),l=!1},d(e){e&&k(t),f&&f.d(e),Ce(o),$&&$.d(e),c=!1,p()}}}function zr(e,t,s){let{$$slots:o={},$$scope:n}=t,r=!1;return e.$$set=e=>{"$$scope"in e&&s(4,n=e.$$scope)},[r,o,e=>s(0,r=!r),e=>s(0,r=!1),n]}class Er extends Te{constructor(e){super(),Pe(this,e,zr,kr,a,{})}}function Ir(e){let t,s,o,n,r,i,a,l;const c=e[2].default,p=u(c,e,e[1],null);return{c(){t=E("div"),s=E("div"),p&&p.c(),o=M(),n=E("div"),r=E("button"),r.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="13" height="13" viewBox="0 0 24 24" class="svelte-1ux55nb"><path d="M10.573 3.021h7.427v-3.021l6 5.39-6 5.61v-3h-7.427c-3.071 0-5.561 2.356-5.561 5.427 0 3.071 2.489 5.573 5.561 5.573h7.427v5h-7.427c-5.84 0-10.573-4.734-10.573-10.573s4.733-10.406 10.573-10.406z"></path></svg>',T(s,"class","group svelte-1ux55nb"),T(r,"class","svelte-1ux55nb"),T(n,"class","group svelte-1ux55nb"),T(t,"id","buttons"),T(t,"class","svelte-1ux55nb")},m(c,u){L(c,t,u),_(t,s),p&&p.m(s,null),_(t,o),_(t,n),_(n,r),i=!0,a||(l=C(r,"click",e[3]),a=!0)},p(e,[t]){p&&p.p&&2&t&&h(p,c,e,e[1],t,null,null)},i(e){i||(xe(p,e),i=!0)},o(e){we(p,e),i=!1},d(e){e&&k(t),p&&p.d(e),a=!1,l()}}}function Sr(e,t,s){let{$$slots:o={},$$scope:n}=t;const r=Z();return e.$$set=e=>{"$$scope"in e&&s(1,n=e.$$scope)},[r,n,o,e=>r("centerArtboard")]}class Mr extends Te{constructor(e){super(),Pe(this,e,Sr,Ir,a,{})}}const Ar=e=>({}),Cr=e=>({slot:"list"}),Pr=e=>({}),Tr=e=>({slot:"icon"});function jr(e){let t;const s=e[0].default,o=u(s,e,e[8],Tr),n=o||function(e){let t,s;return{c(){t=I("svg"),s=I("path"),T(s,"d","M24 13.616v-3.232c-1.651-.587-2.694-.752-3.219-2.019v-.001c-.527-1.271.1-2.134.847-3.707l-2.285-2.285c-1.561.742-2.433 1.375-3.707.847h-.001c-1.269-.526-1.435-1.576-2.019-3.219h-3.232c-.582 1.635-.749 2.692-2.019 3.219h-.001c-1.271.528-2.132-.098-3.707-.847l-2.285 2.285c.745 1.568 1.375 2.434.847 3.707-.527 1.271-1.584 1.438-3.219 2.02v3.232c1.632.58 2.692.749 3.219 2.019.53 1.282-.114 2.166-.847 3.707l2.285 2.286c1.562-.743 2.434-1.375 3.707-.847h.001c1.27.526 1.436 1.579 2.019 3.219h3.232c.582-1.636.75-2.69 2.027-3.222h.001c1.262-.524 2.12.101 3.698.851l2.285-2.286c-.744-1.563-1.375-2.433-.848-3.706.527-1.271 1.588-1.44 3.221-2.021zm-12 2.384c-2.209 0-4-1.791-4-4s1.791-4 4-4 4 1.791 4 4-1.791 4-4 4z"),T(t,"xmlns","http://www.w3.org/2000/svg"),T(t,"width","13"),T(t,"height","13"),T(t,"viewBox","0 0 24 24")},m(e,o){L(e,t,o),_(t,s)},d(e){e&&k(t)}}}();return{c(){n&&n.c()},m(e,s){n&&n.m(e,s),t=!0},p(e,t){o&&o.p&&256&t&&h(o,s,e,e[8],t,Pr,Tr)},i(e){t||(xe(n,e),t=!0)},o(e){we(n,e),t=!1},d(e){n&&n.d(e)}}}function Nr(e){let t;return{c(){t=S("Import spritesheet")},m(e,s){L(e,t,s)},d(e){e&&k(t)}}}function Dr(e){let t;return{c(){t=S("Import CHR")},m(e,s){L(e,t,s)},d(e){e&&k(t)}}}function Rr(e){let t;return{c(){t=S("Export spritesheet")},m(e,s){L(e,t,s)},d(e){e&&k(t)}}}function Or(e){let t;return{c(){t=S("Export CHR")},m(e,s){L(e,t,s)},d(e){e&&k(t)}}}function Br(e){let t;return{c(){t=S("Export PNG")},m(e,s){L(e,t,s)},d(e){e&&k(t)}}}function Hr(e){let t;return{c(){t=S("Clear all")},m(e,s){L(e,t,s)},d(e){e&&k(t)}}}function qr(e){let t;const s=e[0].default,o=u(s,e,e[8],Cr),n=o||function(e){let t,s,o,n,r,i,a,l,c,u,p,h,d,f,m;return s=new vn({props:{$$slots:{default:[Nr]},$$scope:{ctx:e}}}),s.$on("click",e[1]),n=new vn({props:{$$slots:{default:[Dr]},$$scope:{ctx:e}}}),n.$on("click",e[2]),a=new vn({props:{$$slots:{default:[Rr]},$$scope:{ctx:e}}}),a.$on("click",e[3]),c=new vn({props:{$$slots:{default:[Or]},$$scope:{ctx:e}}}),c.$on("click",e[4]),p=new vn({props:{$$slots:{default:[Br]},$$scope:{ctx:e}}}),p.$on("click",e[5]),f=new vn({props:{variant:"danger",$$slots:{default:[Hr]},$$scope:{ctx:e}}}),f.$on("click",e[6]),{c(){t=E("div"),Me(s.$$.fragment),o=M(),Me(n.$$.fragment),r=M(),i=E("div"),Me(a.$$.fragment),l=M(),Me(c.$$.fragment),u=M(),Me(p.$$.fragment),h=M(),d=E("div"),Me(f.$$.fragment)},m(e,g){L(e,t,g),Ae(s,t,null),_(t,o),Ae(n,t,null),L(e,r,g),L(e,i,g),Ae(a,i,null),_(i,l),Ae(c,i,null),_(i,u),Ae(p,i,null),L(e,h,g),L(e,d,g),Ae(f,d,null),m=!0},p(e,t){const o={};256&t&&(o.$$scope={dirty:t,ctx:e}),s.$set(o);const r={};256&t&&(r.$$scope={dirty:t,ctx:e}),n.$set(r);const i={};256&t&&(i.$$scope={dirty:t,ctx:e}),a.$set(i);const l={};256&t&&(l.$$scope={dirty:t,ctx:e}),c.$set(l);const u={};256&t&&(u.$$scope={dirty:t,ctx:e}),p.$set(u);const h={};256&t&&(h.$$scope={dirty:t,ctx:e}),f.$set(h)},i(e){m||(xe(s.$$.fragment,e),xe(n.$$.fragment,e),xe(a.$$.fragment,e),xe(c.$$.fragment,e),xe(p.$$.fragment,e),xe(f.$$.fragment,e),m=!0)},o(e){we(s.$$.fragment,e),we(n.$$.fragment,e),we(a.$$.fragment,e),we(c.$$.fragment,e),we(p.$$.fragment,e),we(f.$$.fragment,e),m=!1},d(e){e&&k(t),Ce(s),Ce(n),e&&k(r),e&&k(i),Ce(a),Ce(c),Ce(p),e&&k(h),e&&k(d),Ce(f)}}}(e);return{c(){n&&n.c()},m(e,s){n&&n.m(e,s),t=!0},p(e,t){o&&o.p&&256&t&&h(o,s,e,e[8],t,Ar,Cr)},i(e){t||(xe(n,e),t=!0)},o(e){we(n,e),t=!1},d(e){n&&n.d(e)}}}function Fr(t){let s;return{c(){s=M()},m(e,t){L(e,s,t)},p:e,i:e,o:e,d(e){e&&k(s)}}}function Kr(e){let t,s;return t=new Er({props:{$$slots:{default:[Fr],list:[qr],icon:[jr]},$$scope:{ctx:e}}}),{c(){Me(t.$$.fragment)},m(e,o){Ae(t,e,o),s=!0},p(e,s){const o={};256&s&&(o.$$scope={dirty:s,ctx:e}),t.$set(o)},i(e){s||(xe(t.$$.fragment,e),s=!0)},o(e){we(t.$$.fragment,e),s=!1},d(e){Ce(t,e)}}}function Gr(e){let t,s;return t=new Mr({props:{$$slots:{default:[Kr]},$$scope:{ctx:e}}}),t.$on("centerArtboard",e[7]),{c(){Me(t.$$.fragment)},m(e,o){Ae(t,e,o),s=!0},p(e,[s]){const o={};256&s&&(o.$$scope={dirty:s,ctx:e}),t.$set(o)},i(e){s||(xe(t.$$.fragment,e),s=!0)},o(e){we(t.$$.fragment,e),s=!1},d(e){Ce(t,e)}}}function Jr(e,t,s){let{$$slots:o={},$$scope:n}=t;return e.$$set=e=>{"$$scope"in e&&s(8,n=e.$$scope)},[o,e=>ft.execute("spritesheet_import"),e=>ft.execute("spritesheet_import_chr"),e=>ft.execute("spritesheet_export"),e=>ft.execute("spritesheet_export_chr"),e=>ft.execute("spritesheet_export_png"),e=>ft.execute("spritesheet_clear"),function(t){X(e,t)},n]}class Ur extends Te{constructor(e){super(),Pe(this,e,Jr,Gr,a,{})}}function Vr(t){let s;return{c(){s=S("Please select a spritesheet and palette")},m(e,t){L(e,s,t)},p:e,i:e,o:e,d(e){e&&k(s)}}}function Yr(e){let t,s,o;const n=e[9].default,r=u(n,e,e[8],null);return{c(){t=E("div"),s=E("canvas"),r&&r.c(),T(s,"width",128),T(s,"height",128),T(s,"class","svelte-9op668"),D(t,"--zoom",e[0]),T(t,"class","svelte-9op668")},m(n,i){L(n,t,i),_(t,s),r&&r.m(s,null),e[10](s),o=!0},p(e,s){r&&r.p&&256&s&&h(r,n,e,e[8],s,null,null),(!o||1&s)&&D(t,"--zoom",e[0])},i(e){o||(xe(r,e),o=!0)},o(e){we(r,e),o=!1},d(s){s&&k(t),r&&r.d(s),e[10](null)}}}function Wr(e){let t,s,o,n;const r=[Yr,Vr],i=[];function a(e,t){return e[2]&&e[3].length&&e[4]?0:1}return t=a(e),s=i[t]=r[t](e),{c(){s.c(),o=A()},m(e,s){i[t].m(e,s),L(e,o,s),n=!0},p(e,[n]){let l=t;t=a(e),t===l?i[t].p(e,n):(ve(),we(i[l],1,1,(()=>{i[l]=null})),ye(),s=i[t],s?s.p(e,n):(s=i[t]=r[t](e),s.c()),xe(s,1),s.m(o.parentNode,o))},i(e){n||(xe(s),n=!0)},o(e){we(s),n=!1},d(e){i[t].d(e),e&&k(o)}}}function Zr(e,t,s){let o,n,r,{$$slots:i={},$$scope:a}=t,{zoom:l}=t;const{activeLayer:u,layers:p,width:h,height:d}=ms.stores;c(e,u,(e=>s(2,o=e))),c(e,p,(e=>s(3,n=e)));const f=es.stores.activeLayer;let m;c(e,f,(e=>s(4,r=e)));let g=new Ps({width:h,height:d});return g.on("primary",(e=>((...e)=>Fs(qs.activeTool.get()?.primary,...e))(e))),g.on("secondary",(e=>((...e)=>Fs(qs.activeTool.get()?.secondary,...e))(e))),g.on("move",(e=>((...e)=>Fs(qs.activeTool.get()?.move,...e))(e))),g.on("mouseup",(e=>((...e)=>Fs(qs.activeTool.get()?.mouseup,...e))(e))),Y((()=>()=>{g&&g.destroy()})),e.$$set=e=>{"zoom"in e&&s(0,l=e.zoom),"$$scope"in e&&s(8,a=e.$$scope)},e.$$.update=()=>{2&e.$$.dirty&&m&&g.defineCanvas(m)},[l,m,o,n,r,u,p,f,a,i,function(e){ee[e?"unshift":"push"]((()=>{m=e,s(1,m)}))}]}class Xr extends Te{constructor(e){super(),Pe(this,e,Zr,Wr,a,{zoom:0})}}function Qr(e){let t,s;return t=new Xr({props:{zoom:e[0]}}),{c(){Me(t.$$.fragment)},m(e,o){Ae(t,e,o),s=!0},p(e,[s]){const o={};1&s&&(o.zoom=e[0]),t.$set(o)},i(e){s||(xe(t.$$.fragment,e),s=!0)},o(e){we(t.$$.fragment,e),s=!1},d(e){Ce(t,e)}}}function ei(e,t,s){let{zoom:o}=t;return e.$$set=e=>{"zoom"in e&&s(0,o=e.zoom)},[o]}class ti extends Te{constructor(e){super(),Pe(this,e,ei,Qr,a,{zoom:0})}}function si(e){let t,s;return t=new ti({props:{zoom:e[1]}}),{c(){Me(t.$$.fragment)},m(e,o){Ae(t,e,o),s=!0},p(e,s){const o={};2&s&&(o.zoom=e[1]),t.$set(o)},i(e){s||(xe(t.$$.fragment,e),s=!0)},o(e){we(t.$$.fragment,e),s=!1},d(e){Ce(t,e)}}}function oi(e){let t,s,o,n,r,i,a,l,c,u,p,h,d,f,m,g,$;return r=new Ur({}),r.$on("centerArtboard",ct),a=new pt({props:{x:e[0].offset.x,y:e[0].offset.y,$$slots:{default:[si]},$$scope:{ctx:e}}}),a.$on("artboardScrollEvent",e[3]),a.$on("artboardOffsetEvent",e[4]),u=new mn({}),d=new Yn({}),g=new mr({props:{showEditButtons:!1}}),{c(){t=E("section"),s=E("div"),o=M(),n=E("div"),Me(r.$$.fragment),i=M(),Me(a.$$.fragment),l=M(),c=E("section"),Me(u.$$.fragment),p=M(),h=E("section"),Me(d.$$.fragment),f=M(),m=E("section"),Me(g.$$.fragment),T(n,"class","inner-artboard svelte-18f6yhk"),T(t,"class","main-artboard svelte-18f6yhk"),T(c,"class","toolbar-layer svelte-18f6yhk"),T(h,"class","spritesheets-layer svelte-18f6yhk"),T(m,"class","palettes-layer svelte-18f6yhk")},m(e,v){L(e,t,v),_(t,s),_(t,o),_(t,n),Ae(r,n,null),_(n,i),Ae(a,n,null),L(e,l,v),L(e,c,v),Ae(u,c,null),L(e,p,v),L(e,h,v),Ae(d,h,null),L(e,f,v),L(e,m,v),Ae(g,m,null),$=!0},p(e,[t]){const s={};1&t&&(s.x=e[0].offset.x),1&t&&(s.y=e[0].offset.y),34&t&&(s.$$scope={dirty:t,ctx:e}),a.$set(s)},i(e){$||(xe(r.$$.fragment,e),xe(a.$$.fragment,e),xe(u.$$.fragment,e),xe(d.$$.fragment,e),xe(g.$$.fragment,e),$=!0)},o(e){we(r.$$.fragment,e),we(a.$$.fragment,e),we(u.$$.fragment,e),we(d.$$.fragment,e),we(g.$$.fragment,e),$=!1},d(e){e&&k(t),Ce(r),Ce(a),e&&k(l),e&&k(c),Ce(u),e&&k(p),e&&k(h),Ce(d),e&&k(f),e&&k(m),Ce(g)}}}function ni(e,t,s){let o,n;const{artboard:r}=ms.stores;c(e,r,(e=>s(0,n=e)));return e.$$.update=()=>{1&e.$$.dirty&&s(1,o=n.zoom)},[n,o,r,e=>{e.detail,m(r,n.zoom=Math.max(1,o+(o-e.detail.deltaY>0?2:-2)),n)},e=>m(r,n.offset=e.detail,n)]}class ri extends Te{constructor(e){super(),Pe(this,e,ni,oi,a,{})}}function ii(e){let t,s;return{c(){t=E("div"),s=S(e[0]),T(t,"class","label svelte-j9cd0w")},m(e,o){L(e,t,o),_(t,s)},p(e,t){1&t&&N(s,e[0])},d(e){e&&k(t)}}}function ai(e){let t,s,o,n=e[0]&&ii(e);const r=e[2].default,i=u(r,e,e[1],null);return{c(){t=E("div"),n&&n.c(),s=M(),i&&i.c(),T(t,"class","labeled svelte-j9cd0w")},m(e,r){L(e,t,r),n&&n.m(t,null),_(t,s),i&&i.m(t,null),o=!0},p(e,[o]){e[0]?n?n.p(e,o):(n=ii(e),n.c(),n.m(t,s)):n&&(n.d(1),n=null),i&&i.p&&2&o&&h(i,r,e,e[1],o,null,null)},i(e){o||(xe(i,e),o=!0)},o(e){we(i,e),o=!1},d(e){e&&k(t),n&&n.d(),i&&i.d(e)}}}function li(e,t,s){let{$$slots:o={},$$scope:n}=t,{label:r}=t;return e.$$set=e=>{"label"in e&&s(0,r=e.label),"$$scope"in e&&s(1,n=e.$$scope)},[r,n,o]}class ci extends Te{constructor(e){super(),Pe(this,e,li,ai,a,{label:0})}}const ui=e=>({}),pi=e=>({slot:"list"}),hi=e=>({}),di=e=>({slot:"icon"});function fi(e){let t;const s=e[0].default,o=u(s,e,e[5],di),n=o||function(e){let t,s;return{c(){t=I("svg"),s=I("path"),T(s,"d","M24 13.616v-3.232c-1.651-.587-2.694-.752-3.219-2.019v-.001c-.527-1.271.1-2.134.847-3.707l-2.285-2.285c-1.561.742-2.433 1.375-3.707.847h-.001c-1.269-.526-1.435-1.576-2.019-3.219h-3.232c-.582 1.635-.749 2.692-2.019 3.219h-.001c-1.271.528-2.132-.098-3.707-.847l-2.285 2.285c.745 1.568 1.375 2.434.847 3.707-.527 1.271-1.584 1.438-3.219 2.02v3.232c1.632.58 2.692.749 3.219 2.019.53 1.282-.114 2.166-.847 3.707l2.285 2.286c1.562-.743 2.434-1.375 3.707-.847h.001c1.27.526 1.436 1.579 2.019 3.219h3.232c.582-1.636.75-2.69 2.027-3.222h.001c1.262-.524 2.12.101 3.698.851l2.285-2.286c-.744-1.563-1.375-2.433-.848-3.706.527-1.271 1.588-1.44 3.221-2.021zm-12 2.384c-2.209 0-4-1.791-4-4s1.791-4 4-4 4 1.791 4 4-1.791 4-4 4z"),T(t,"xmlns","http://www.w3.org/2000/svg"),T(t,"width","13"),T(t,"height","13"),T(t,"viewBox","0 0 24 24")},m(e,o){L(e,t,o),_(t,s)},d(e){e&&k(t)}}}();return{c(){n&&n.c()},m(e,s){n&&n.m(e,s),t=!0},p(e,t){o&&o.p&&32&t&&h(o,s,e,e[5],t,hi,di)},i(e){t||(xe(n,e),t=!0)},o(e){we(n,e),t=!1},d(e){n&&n.d(e)}}}function mi(e){let t;return{c(){t=S("Import palette")},m(e,s){L(e,t,s)},d(e){e&&k(t)}}}function gi(e){let t;return{c(){t=S("Export palette")},m(e,s){L(e,t,s)},d(e){e&&k(t)}}}function $i(e){let t;return{c(){t=S("Clear all")},m(e,s){L(e,t,s)},d(e){e&&k(t)}}}function vi(e){let t;const s=e[0].default,o=u(s,e,e[5],pi),n=o||function(e){let t,s,o,n,r,i,a,l;return s=new vn({props:{$$slots:{default:[mi]},$$scope:{ctx:e}}}),s.$on("click",e[1]),n=new vn({props:{$$slots:{default:[gi]},$$scope:{ctx:e}}}),n.$on("click",e[2]),a=new vn({props:{variant:"danger",$$slots:{default:[$i]},$$scope:{ctx:e}}}),a.$on("click",e[3]),{c(){t=E("div"),Me(s.$$.fragment),o=M(),Me(n.$$.fragment),r=M(),i=E("div"),Me(a.$$.fragment)},m(e,c){L(e,t,c),Ae(s,t,null),_(t,o),Ae(n,t,null),L(e,r,c),L(e,i,c),Ae(a,i,null),l=!0},p(e,t){const o={};32&t&&(o.$$scope={dirty:t,ctx:e}),s.$set(o);const r={};32&t&&(r.$$scope={dirty:t,ctx:e}),n.$set(r);const i={};32&t&&(i.$$scope={dirty:t,ctx:e}),a.$set(i)},i(e){l||(xe(s.$$.fragment,e),xe(n.$$.fragment,e),xe(a.$$.fragment,e),l=!0)},o(e){we(s.$$.fragment,e),we(n.$$.fragment,e),we(a.$$.fragment,e),l=!1},d(e){e&&k(t),Ce(s),Ce(n),e&&k(r),e&&k(i),Ce(a)}}}(e);return{c(){n&&n.c()},m(e,s){n&&n.m(e,s),t=!0},p(e,t){o&&o.p&&32&t&&h(o,s,e,e[5],t,ui,pi)},i(e){t||(xe(n,e),t=!0)},o(e){we(n,e),t=!1},d(e){n&&n.d(e)}}}function yi(t){let s;return{c(){s=M()},m(e,t){L(e,s,t)},p:e,i:e,o:e,d(e){e&&k(s)}}}function xi(e){let t,s;return t=new Er({props:{$$slots:{default:[yi],list:[vi],icon:[fi]},$$scope:{ctx:e}}}),{c(){Me(t.$$.fragment)},m(e,o){Ae(t,e,o),s=!0},p(e,s){const o={};32&s&&(o.$$scope={dirty:s,ctx:e}),t.$set(o)},i(e){s||(xe(t.$$.fragment,e),s=!0)},o(e){we(t.$$.fragment,e),s=!1},d(e){Ce(t,e)}}}function wi(e){let t,s;return t=new Mr({props:{$$slots:{default:[xi]},$$scope:{ctx:e}}}),t.$on("centerArtboard",e[4]),{c(){Me(t.$$.fragment)},m(e,o){Ae(t,e,o),s=!0},p(e,[s]){const o={};32&s&&(o.$$scope={dirty:s,ctx:e}),t.$set(o)},i(e){s||(xe(t.$$.fragment,e),s=!0)},o(e){we(t.$$.fragment,e),s=!1},d(e){Ce(t,e)}}}function bi(e,t,s){let{$$slots:o={},$$scope:n}=t;return e.$$set=e=>{"$$scope"in e&&s(5,n=e.$$scope)},[o,e=>ft.execute("palette_import"),e=>ft.execute("palette_export"),e=>ft.execute("palette_clear"),function(t){X(e,t)},n]}class _i extends Te{constructor(e){super(),Pe(this,e,bi,wi,a,{})}}function Li(e,t,s){const o=e.slice();return o[1]=t[s],o}function ki(t){let s,o,n;return o=new sr({props:{rgb:t[1].rgb,hex:t[1].hex,type:"replace"}}),o.$on("click",t[0]),{c(){s=E("li"),Me(o.$$.fragment)},m(e,t){L(e,s,t),Ae(o,s,null),n=!0},p:e,i(e){n||(xe(o.$$.fragment,e),n=!0)},o(e){we(o.$$.fragment,e),n=!1},d(e){e&&k(s),Ce(o)}}}function zi(e){let t,s,o=qe,n=[];for(let t=0;t<o.length;t+=1)n[t]=ki(Li(e,o,t));const r=e=>we(n[e],1,1,(()=>{n[e]=null}));return{c(){t=E("ul");for(let e=0;e<n.length;e+=1)n[e].c()},m(e,o){L(e,t,o);for(let e=0;e<n.length;e+=1)n[e].m(t,null);s=!0},p(e,[s]){if(1&s){let i;for(o=qe,i=0;i<o.length;i+=1){const r=Li(e,o,i);n[i]?(n[i].p(r,s),xe(n[i],1)):(n[i]=ki(r),n[i].c(),xe(n[i],1),n[i].m(t,null))}for(ve(),i=o.length;i<n.length;i+=1)r(i);ye()}},i(e){if(!s){for(let e=0;e<o.length;e+=1)xe(n[e]);s=!0}},o(e){n=n.filter(Boolean);for(let e=0;e<n.length;e+=1)we(n[e]);s=!1},d(e){e&&k(t),z(n,e)}}}function Ei(e){return[e=>{console.log(e)}]}class Ii extends Te{constructor(e){super(),Pe(this,e,Ei,zi,a,{})}}function Si(e,t,s){const o=e.slice();return o[5]=t[s],o[7]=s,o}function Mi(t){let s;return{c(){s=S("No layer selected")},m(e,t){L(e,s,t)},p:e,i:e,o:e,d(e){e&&k(s)}}}function Ai(t){let s,o,n=t[0],r=Ti(t);return{c(){r.c(),s=A()},m(e,t){r.m(e,t),L(e,s,t),o=!0},p(t,o){1&o&&a(n,n=t[0])?(ve(),we(r,1,1,e),ye(),r=Ti(t),r.c(),xe(r),r.m(s.parentNode,s)):r.p(t,o)},i(e){o||(xe(r),o=!0)},o(e){we(r),o=!1},d(e){e&&k(s),r.d(e)}}}function Ci(e){let t,s,o,n,r,a,l;return s=new sr({props:{hex:e[5].hex,rgb:e[5].rgb,layerIndex:es.layerIndexFromSource(e[0]),colorIndex:e[7],type:"swap"}}),{c(){t=E("li"),Me(s.$$.fragment),o=M(),T(t,"class","svelte-dgveli")},m(i,c){L(i,t,c),Ae(s,t,null),_(t,o),r=!0,a||(l=g(n=kn.call(null,t,{...e[2],value:{layerIndex:es.layerIndexFromSource(e[0]),colorIndex:e[7]}})),a=!0)},p(t,o){e=t;const r={};1&o&&(r.hex=e[5].hex),1&o&&(r.rgb=e[5].rgb),1&o&&(r.layerIndex=es.layerIndexFromSource(e[0])),s.$set(r),n&&i(n.update)&&1&o&&n.update.call(null,{...e[2],value:{layerIndex:es.layerIndexFromSource(e[0]),colorIndex:e[7]}})},i(e){r||(xe(s.$$.fragment,e),r=!0)},o(e){we(s.$$.fragment,e),r=!1},d(e){e&&k(t),Ce(s),a=!1,l()}}}function Pi(e){let t,s,o=e[0].colors,n=[];for(let t=0;t<o.length;t+=1)n[t]=Ci(Si(e,o,t));const r=e=>we(n[e],1,1,(()=>{n[e]=null}));return{c(){t=E("ul");for(let e=0;e<n.length;e+=1)n[e].c();T(t,"class","active-color-group svelte-dgveli")},m(e,o){L(e,t,o);for(let e=0;e<n.length;e+=1)n[e].m(t,null);s=!0},p(e,s){if(5&s){let i;for(o=e[0].colors,i=0;i<o.length;i+=1){const r=Si(e,o,i);n[i]?(n[i].p(r,s),xe(n[i],1)):(n[i]=Ci(r),n[i].c(),xe(n[i],1),n[i].m(t,null))}for(ve(),i=o.length;i<n.length;i+=1)r(i);ye()}},i(e){if(!s){for(let e=0;e<o.length;e+=1)xe(n[e]);s=!0}},o(e){n=n.filter(Boolean);for(let e=0;e<n.length;e+=1)we(n[e]);s=!1},d(e){e&&k(t),z(n,e)}}}function Ti(e){let t,s;return t=new ci({props:{label:e[0].label,$$slots:{default:[Pi]},$$scope:{ctx:e}}}),{c(){Me(t.$$.fragment)},m(e,o){Ae(t,e,o),s=!0},p(e,s){const o={};1&s&&(o.label=e[0].label),257&s&&(o.$$scope={dirty:s,ctx:e}),t.$set(o)},i(e){s||(xe(t.$$.fragment,e),s=!0)},o(e){we(t.$$.fragment,e),s=!1},d(e){Ce(t,e)}}}function ji(e){let t,s,o,n;const r=[Ai,Mi],i=[];function a(e,t){return e[0]?0:1}return t=a(e),s=i[t]=r[t](e),{c(){s.c(),o=A()},m(e,s){i[t].m(e,s),L(e,o,s),n=!0},p(e,n){let l=t;t=a(e),t===l?i[t].p(e,n):(ve(),we(i[l],1,1,(()=>{i[l]=null})),ye(),s=i[t],s?s.p(e,n):(s=i[t]=r[t](e),s.c()),xe(s,1),s.m(o.parentNode,o))},i(e){n||(xe(s),n=!0)},o(e){we(s),n=!1},d(e){i[t].d(e),e&&k(o)}}}function Ni(e){let t,s,o,n,r,i,a,l,c,u,p,h,d,f;return r=new _i({}),r.$on("centerArtboard",ct),a=new pt({props:{$$slots:{default:[ji]},$$scope:{ctx:e}}}),u=new Ii({}),d=new mr({props:{showEditButtons:!0}}),{c(){t=E("section"),s=E("div"),o=M(),n=E("div"),Me(r.$$.fragment),i=M(),Me(a.$$.fragment),l=M(),c=E("section"),Me(u.$$.fragment),p=M(),h=E("section"),Me(d.$$.fragment),T(n,"class","inner-artboard svelte-dgveli"),T(t,"class","main-artboard svelte-dgveli"),T(c,"class","swatchlist svelte-dgveli"),T(h,"class","palettes-layers svelte-dgveli")},m(e,m){L(e,t,m),_(t,s),_(t,o),_(t,n),Ae(r,n,null),_(n,i),Ae(a,n,null),L(e,l,m),L(e,c,m),Ae(u,c,null),L(e,p,m),L(e,h,m),Ae(d,h,null),f=!0},p(e,[t]){const s={};257&t&&(s.$$scope={dirty:t,ctx:e}),a.$set(s)},i(e){f||(xe(r.$$.fragment,e),xe(a.$$.fragment,e),xe(u.$$.fragment,e),xe(d.$$.fragment,e),f=!0)},o(e){we(r.$$.fragment,e),we(a.$$.fragment,e),we(u.$$.fragment,e),we(d.$$.fragment,e),f=!1},d(e){e&&k(t),Ce(r),Ce(a),e&&k(l),e&&k(c),Ce(u),e&&k(p),e&&k(h),Ce(d)}}}function Di(e,t,s){let o;const{activeLayer:n,layers:r}=es.stores;c(e,n,(e=>s(0,o=e)));return[o,n,{over:e=>!0,leave:e=>!1,drop:({e:e,value:t})=>{const s=e.dataTransfer.getData("swap");s&&r.swapColors({...JSON.parse(s),to:{...t}});const o=e.dataTransfer.getData("replace");o&&r.replaceColor({...JSON.parse(o),...t})}}]}class Ri extends Te{constructor(e){super(),Pe(this,e,Di,Ni,a,{})}}let Oi;const Bi=De(ms.stores.activeLayer,((e,t)=>{if(clearInterval(Oi),e)return Oi=setInterval((()=>{e.updateImageSource(),t(e.updateImageSource())}),500),()=>{clearInterval(Oi)}})),Hi=De(ms.stores.layers,(e=>e)),qi=vt({layers:Hi,activeImage:Bi},(({store:e,value:t,get:s})=>({stores:t})));function Fi(e){let t,s;return{c(){t=E("label"),s=S(e[1]),T(t,"for","select"),T(t,"class","svelte-gfpjc3")},m(e,o){L(e,t,o),_(t,s)},p(e,t){2&t&&N(s,e[1])},d(e){e&&k(t)}}}function Ki(e){let t,s,o,n,i,a,l,c=e[1]&&Fi(e);const p=e[5].default,d=u(p,e,e[4],null);return{c(){t=E("div"),c&&c.c(),s=M(),o=E("div"),n=E("select"),d&&d.c(),T(n,"name","select"),n.disabled=e[2],T(n,"class","svelte-gfpjc3"),void 0===e[0]&&ae((()=>e[7].call(n))),T(o,"class","select svelte-gfpjc3"),O(o,"multiple",e[3]),T(t,"class","select-group svelte-gfpjc3")},m(r,u){L(r,t,u),c&&c.m(t,null),_(t,s),_(t,o),_(o,n),d&&d.m(n,null),R(n,e[0]),i=!0,a||(l=[C(n,"change",e[7]),C(o,"change",e[6])],a=!0)},p(e,[r]){e[1]?c?c.p(e,r):(c=Fi(e),c.c(),c.m(t,s)):c&&(c.d(1),c=null),d&&d.p&&16&r&&h(d,p,e,e[4],r,null,null),(!i||4&r)&&(n.disabled=e[2]),1&r&&R(n,e[0]),8&r&&O(o,"multiple",e[3])},i(e){i||(xe(d,e),i=!0)},o(e){we(d,e),i=!1},d(e){e&&k(t),c&&c.d(),d&&d.d(e),a=!1,r(l)}}}function Gi(e,t,s){let{$$slots:o={},$$scope:n}=t,{label:r}=t,{disabled:i=!1}=t,{multiple:a=!1}=t,{value:l}=t;return e.$$set=e=>{"label"in e&&s(1,r=e.label),"disabled"in e&&s(2,i=e.disabled),"multiple"in e&&s(3,a=e.multiple),"value"in e&&s(0,l=e.value),"$$scope"in e&&s(4,n=e.$$scope)},[l,r,i,a,n,o,function(t){X(e,t)},function(){l=function(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}(this),s(0,l)}]}class Ji extends Te{constructor(e){super(),Pe(this,e,Gi,Ki,a,{label:1,disabled:2,multiple:3,value:0})}}function Ui(e,t,s){const o=e.slice();return o[16]=t[s],o}function Vi(e,t,s){const o=e.slice();return o[19]=t[s],o}function Yi(e,t,s){const o=e.slice();return o[22]=t[s],o}function Wi(e){let t,s;return t=new ti({props:{zoom:e[0]}}),{c(){Me(t.$$.fragment)},m(e,o){Ae(t,e,o),s=!0},p(e,s){const o={};1&s&&(o.zoom=e[0]),t.$set(o)},i(e){s||(xe(t.$$.fragment,e),s=!0)},o(e){we(t.$$.fragment,e),s=!1},d(e){Ce(t,e)}}}function Zi(e){let t;return{c(){t=E("option"),t.textContent="oh noo!",t.__value="oh noo!",t.value=t.__value},m(e,s){L(e,t,s)},d(e){e&&k(t)}}}function Xi(e){let t,s,o,n=e[22].label+"";return{c(){t=E("option"),s=S(n),t.__value=o=e[22],t.value=t.__value},m(e,o){L(e,t,o),_(t,s)},p(e,r){4&r&&n!==(n=e[22].label+"")&&N(s,n),4&r&&o!==(o=e[22])&&(t.__value=o,t.value=t.__value)},d(e){e&&k(t)}}}function Qi(e){let t,s=e[2],o=[];for(let t=0;t<s.length;t+=1)o[t]=Xi(Yi(e,s,t));let n=null;return s.length||(n=Zi()),{c(){for(let e=0;e<o.length;e+=1)o[e].c();t=A(),n&&n.c()},m(e,s){for(let t=0;t<o.length;t+=1)o[t].m(e,s);L(e,t,s),n&&n.m(e,s)},p(e,r){if(4&r){let i;for(s=e[2],i=0;i<s.length;i+=1){const n=Yi(e,s,i);o[i]?o[i].p(n,r):(o[i]=Xi(n),o[i].c(),o[i].m(t.parentNode,t))}for(;i<o.length;i+=1)o[i].d(1);o.length=s.length,s.length?n&&(n.d(1),n=null):n||(n=Zi(),n.c(),n.m(t.parentNode,t))}},d(e){z(o,e),e&&k(t),n&&n.d(e)}}}function ea(e){let t,s=e[4],o=oa(e);return{c(){o.c(),t=A()},m(e,s){o.m(e,s),L(e,t,s)},p(e,n){16&n&&a(s,s=e[4])?(o.d(1),o=oa(e),o.c(),o.m(t.parentNode,t)):o.p(e,n)},d(e){e&&k(t),o.d(e)}}}function ta(e){let t;return{c(){t=E("div"),T(t,"class","tile-image svelte-1og0o7w"),D(t,"--src","url("+e[3].image.src+")"),D(t,"--x",e[16]),D(t,"--y",e[19])},m(e,s){L(e,t,s)},p(e,s){8&s&&D(t,"--src","url("+e[3].image.src+")")},d(e){e&&k(t)}}}function sa(e){let t,s=e[11],o=[];for(let t=0;t<s.length;t+=1)o[t]=ta(Vi(e,s,t));return{c(){for(let e=0;e<o.length;e+=1)o[e].c();t=A()},m(e,s){for(let t=0;t<o.length;t+=1)o[t].m(e,s);L(e,t,s)},p(e,n){if(3080&n){let r;for(s=e[11],r=0;r<s.length;r+=1){const i=Vi(e,s,r);o[r]?o[r].p(i,n):(o[r]=ta(i),o[r].c(),o[r].m(t.parentNode,t))}for(;r<o.length;r+=1)o[r].d(1);o.length=s.length}},d(e){z(o,e),e&&k(t)}}}function oa(e){let t,s=e[10],o=[];for(let t=0;t<s.length;t+=1)o[t]=sa(Ui(e,s,t));return{c(){for(let e=0;e<o.length;e+=1)o[e].c();t=A()},m(e,s){for(let t=0;t<o.length;t+=1)o[t].m(e,s);L(e,t,s)},p(e,n){if(3080&n){let r;for(s=e[10],r=0;r<s.length;r+=1){const i=Ui(e,s,r);o[r]?o[r].p(i,n):(o[r]=sa(i),o[r].c(),o[r].m(t.parentNode,t))}for(;r<o.length;r+=1)o[r].d(1);o.length=s.length}},d(e){z(o,e),e&&k(t)}}}function na(e){let t,s,o,n,r,i,a,l,c,u,p,h,d,f,m,g,$,v,y,x,w,b,z,I;function S(t){e[13].call(null,t)}r=new Ur({}),r.$on("centerArtboard",ct),a=new pt({props:{$$slots:{default:[Wi]},$$scope:{ctx:e}}}),a.$on("artboardScrollEvent",e[9]);let A={$$slots:{default:[Qi]},$$scope:{ctx:e}};void 0!==e[1]&&(A.value=e[1]),h=new Ji({props:A}),ee.push((()=>Se(h,"value",S))),h.$on("change",e[12]);let C=e[3]&&ea(e);return v=new mn({}),z=new mr({props:{showEditButtons:!1}}),{c(){t=E("section"),s=E("div"),o=M(),n=E("div"),Me(r.$$.fragment),i=M(),Me(a.$$.fragment),l=M(),c=E("section"),u=E("header"),p=E("div"),Me(h.$$.fragment),f=M(),m=E("div"),C&&C.c(),g=M(),$=E("section"),Me(v.$$.fragment),y=M(),x=E("section"),w=M(),b=E("section"),Me(z.$$.fragment),T(n,"class","inner-artboard svelte-1og0o7w"),T(u,"class","svelte-1og0o7w"),T(m,"class","tile-grid svelte-1og0o7w"),T(c,"class","tiles svelte-1og0o7w"),T(t,"class","main-artboard svelte-1og0o7w"),T($,"class","toolbar-layer svelte-1og0o7w"),T(x,"class","spritesheets-layer svelte-1og0o7w"),T(b,"class","palettes-layer svelte-1og0o7w")},m(e,d){L(e,t,d),_(t,s),_(t,o),_(t,n),Ae(r,n,null),_(n,i),Ae(a,n,null),_(t,l),_(t,c),_(c,u),_(u,p),Ae(h,p,null),_(c,f),_(c,m),C&&C.m(m,null),L(e,g,d),L(e,$,d),Ae(v,$,null),L(e,y,d),L(e,x,d),L(e,w,d),L(e,b,d),Ae(z,b,null),I=!0},p(e,[t]){const s={};33554433&t&&(s.$$scope={dirty:t,ctx:e}),a.$set(s);const o={};33554436&t&&(o.$$scope={dirty:t,ctx:e}),!d&&2&t&&(d=!0,o.value=e[1],le((()=>d=!1))),h.$set(o),e[3]?C?C.p(e,t):(C=ea(e),C.c(),C.m(m,null)):C&&(C.d(1),C=null)},i(e){I||(xe(r.$$.fragment,e),xe(a.$$.fragment,e),xe(h.$$.fragment,e),xe(v.$$.fragment,e),xe(z.$$.fragment,e),I=!0)},o(e){we(r.$$.fragment,e),we(a.$$.fragment,e),we(h.$$.fragment,e),we(v.$$.fragment,e),we(z.$$.fragment,e),I=!1},d(e){e&&k(t),Ce(r),Ce(a),Ce(h),C&&C.d(),e&&k(g),e&&k($),Ce(v),e&&k(y),e&&k(x),e&&k(w),e&&k(b),Ce(z)}}}function ra(e,t,s){let o,n,r,i;const{activeImage:a}=qi.stores;c(e,a,(e=>s(4,i=e)));const{layers:l,activeLayer:u,artboard:p}=ms.stores;c(e,l,(e=>s(2,n=e))),c(e,u,(e=>s(3,r=e))),c(e,p,(e=>s(14,o=e)));let h=o.zoom;const d=(e=16)=>new Array(e).fill(null).map(((e,t)=>t+1)).reverse();let f,m=[...d()],g=[...d()];return[h,f,n,r,i,a,l,u,p,e=>{s(0,h=Math.max(1,h+(h-e.detail.deltaY>0?1:-1)))},m,g,e=>{ft.execute("spritesheet_make_layer_active",f)},function(e){f=e,s(1,f)}]}class ia extends Te{constructor(e){super(),Pe(this,e,ra,na,a,{})}}function aa(e){let t;const s=e[6].default,o=u(s,e,e[7],null);return{c(){o&&o.c()},m(e,s){o&&o.m(e,s),t=!0},p(e,t){o&&o.p&&128&t&&h(o,s,e,e[7],t,null,null)},i(e){t||(xe(o,e),t=!0)},o(e){we(o,e),t=!1},d(e){o&&o.d(e)}}}function la(e){let t,o;const n=[e[5]];let r={$$slots:{default:[aa]},$$scope:{ctx:e}};for(let e=0;e<n.length;e+=1)r=s(r,n[e]);return t=new jn({props:r}),t.$on("swapLayers",e[4]),t.$on("remove",e[0]),t.$on("updateLabel",e[1]),t.$on("makeActive",e[2]),t.$on("clone",e[3]),{c(){Me(t.$$.fragment)},m(e,s){Ae(t,e,s),o=!0},p(e,[s]){const o=32&s?Ee(n,[Ie(e[5])]):{};128&s&&(o.$$scope={dirty:s,ctx:e}),t.$set(o)},i(e){o||(xe(t.$$.fragment,e),o=!0)},o(e){we(t.$$.fragment,e),o=!1},d(e){Ce(t,e)}}}function ca(e,t,o){const n=[];let r=f(t,n),{$$slots:i={},$$scope:a}=t;return e.$$set=e=>{t=s(s({},t),d(e)),o(5,r=f(t,n)),"$$scope"in e&&o(7,a=e.$$scope)},[e=>ft.execute("tilemap_remove",e.detail),e=>ft.execute("tilemap_update_layer_label",{source:e.detail.source,label:e.detail.value}),e=>ft.execute("tilemap_make_layer_active",e.detail),e=>ft.execute("tilemap_clone_layer",e.detail),e=>ft.execute("tilemap_swap_layers",e.detail),r,i,a]}class ua extends Te{constructor(e){super(),Pe(this,e,ca,la,a,{})}}function pa(e,t,s){const o=e.slice();return o[4]=t[s],o[6]=s,o}function ha(t){let s;return{c(){s=E("div"),s.textContent="No tilemaps",T(s,"class","center svelte-1xx5how")},m(e,t){L(e,s,t)},p:e,i:e,o:e,d(e){e&&k(s)}}}function da(t){let s,o,n=t[0],r=ga(t);return{c(){r.c(),s=A()},m(e,t){r.m(e,t),L(e,s,t),o=!0},p(t,o){1&o&&a(n,n=t[0])?(ve(),we(r,1,1,e),ye(),r=ga(t),r.c(),xe(r),r.m(s.parentNode,s)):r.p(t,o)},i(e){o||(xe(r),o=!0)},o(e){we(r),o=!1},d(e){e&&k(s),r.d(e)}}}function fa(e){let t,s,o,n;return s=new Ns({props:{source:e[4],width:256,height:240}}),{c(){t=E("div"),Me(s.$$.fragment),o=M(),T(t,"class","canvas-preview-wrapper svelte-1xx5how")},m(e,r){L(e,t,r),Ae(s,t,null),L(e,o,r),n=!0},p(e,t){const o={};1&t&&(o.source=e[4]),s.$set(o)},i(e){n||(xe(s.$$.fragment,e),n=!0)},o(e){we(s.$$.fragment,e),n=!1},d(e){e&&k(t),Ce(s),e&&k(o)}}}function ma(e){let t,s;return t=new ua({props:{source:e[4],activeLayer:e[1],layerIndex:e[6],$$slots:{default:[fa]},$$scope:{ctx:e}}}),{c(){Me(t.$$.fragment)},m(e,o){Ae(t,e,o),s=!0},p(e,s){const o={};1&s&&(o.source=e[4]),129&s&&(o.$$scope={dirty:s,ctx:e}),t.$set(o)},i(e){s||(xe(t.$$.fragment,e),s=!0)},o(e){we(t.$$.fragment,e),s=!1},d(e){Ce(t,e)}}}function ga(e){let t,s,o=e[0],n=[];for(let t=0;t<o.length;t+=1)n[t]=ma(pa(e,o,t));const r=e=>we(n[e],1,1,(()=>{n[e]=null}));return{c(){for(let e=0;e<n.length;e+=1)n[e].c();t=A()},m(e,o){for(let t=0;t<n.length;t+=1)n[t].m(e,o);L(e,t,o),s=!0},p(e,s){if(3&s){let i;for(o=e[0],i=0;i<o.length;i+=1){const r=pa(e,o,i);n[i]?(n[i].p(r,s),xe(n[i],1)):(n[i]=ma(r),n[i].c(),xe(n[i],1),n[i].m(t.parentNode,t))}for(ve(),i=o.length;i<n.length;i+=1)r(i);ye()}},i(e){if(!s){for(let e=0;e<o.length;e+=1)xe(n[e]);s=!0}},o(e){n=n.filter(Boolean);for(let e=0;e<n.length;e+=1)we(n[e]);s=!1},d(e){z(n,e),e&&k(t)}}}function $a(e){let t;return{c(){t=S("Create tilemap")},m(e,s){L(e,t,s)},d(e){e&&k(t)}}}function va(e){let t,s,o,n,r,i,a,l;const c=[da,ha],u=[];function p(e,t){return e[0].length?0:1}return o=p(e),n=u[o]=c[o](e),a=new vn({props:{$$slots:{default:[$a]},$$scope:{ctx:e}}}),a.$on("click",e[3]),{c(){t=E("div"),s=E("div"),n.c(),r=M(),i=E("div"),Me(a.$$.fragment),T(s,"class","layers svelte-1xx5how"),T(i,"class","center svelte-1xx5how"),T(t,"class","palette-layer svelte-1xx5how")},m(e,n){L(e,t,n),_(t,s),u[o].m(s,null),_(t,r),_(t,i),Ae(a,i,null),l=!0},p(e,[t]){let r=o;o=p(e),o===r?u[o].p(e,t):(ve(),we(u[r],1,1,(()=>{u[r]=null})),ye(),n=u[o],n?n.p(e,t):(n=u[o]=c[o](e),n.c()),xe(n,1),n.m(s,null));const i={};128&t&&(i.$$scope={dirty:t,ctx:e}),a.$set(i)},i(e){l||(xe(n),xe(a.$$.fragment,e),l=!0)},o(e){we(n),we(a.$$.fragment,e),l=!1},d(e){e&&k(t),u[o].d(),Ce(a)}}}function ya(e,t,s){let o;const{activeLayer:n,layers:r}=ys.stores;c(e,r,(e=>s(0,o=e)));return[o,n,r,e=>ft.execute("tilemap_create")]}class xa extends Te{constructor(e){super(),Pe(this,e,ya,va,a,{})}}const wa=e=>({}),ba=e=>({slot:"list"}),_a=e=>({}),La=e=>({slot:"icon"});function ka(e){let t;const s=e[0].default,o=u(s,e,e[7],La),n=o||function(e){let t,s;return{c(){t=I("svg"),s=I("path"),T(s,"d","M24 13.616v-3.232c-1.651-.587-2.694-.752-3.219-2.019v-.001c-.527-1.271.1-2.134.847-3.707l-2.285-2.285c-1.561.742-2.433 1.375-3.707.847h-.001c-1.269-.526-1.435-1.576-2.019-3.219h-3.232c-.582 1.635-.749 2.692-2.019 3.219h-.001c-1.271.528-2.132-.098-3.707-.847l-2.285 2.285c.745 1.568 1.375 2.434.847 3.707-.527 1.271-1.584 1.438-3.219 2.02v3.232c1.632.58 2.692.749 3.219 2.019.53 1.282-.114 2.166-.847 3.707l2.285 2.286c1.562-.743 2.434-1.375 3.707-.847h.001c1.27.526 1.436 1.579 2.019 3.219h3.232c.582-1.636.75-2.69 2.027-3.222h.001c1.262-.524 2.12.101 3.698.851l2.285-2.286c-.744-1.563-1.375-2.433-.848-3.706.527-1.271 1.588-1.44 3.221-2.021zm-12 2.384c-2.209 0-4-1.791-4-4s1.791-4 4-4 4 1.791 4 4-1.791 4-4 4z"),T(t,"xmlns","http://www.w3.org/2000/svg"),T(t,"width","13"),T(t,"height","13"),T(t,"viewBox","0 0 24 24")},m(e,o){L(e,t,o),_(t,s)},d(e){e&&k(t)}}}();return{c(){n&&n.c()},m(e,s){n&&n.m(e,s),t=!0},p(e,t){o&&o.p&&128&t&&h(o,s,e,e[7],t,_a,La)},i(e){t||(xe(n,e),t=!0)},o(e){we(n,e),t=!1},d(e){n&&n.d(e)}}}function za(e){let t;return{c(){t=S("Import tilemap")},m(e,s){L(e,t,s)},d(e){e&&k(t)}}}function Ea(e){let t;return{c(){t=S("Export tilemap")},m(e,s){L(e,t,s)},d(e){e&&k(t)}}}function Ia(e){let t;return{c(){t=S("Export nametable")},m(e,s){L(e,t,s)},d(e){e&&k(t)}}}function Sa(e){let t;return{c(){t=S("Export PNG")},m(e,s){L(e,t,s)},d(e){e&&k(t)}}}function Ma(e){let t;return{c(){t=S("Clear all")},m(e,s){L(e,t,s)},d(e){e&&k(t)}}}function Aa(e){let t;const s=e[0].default,o=u(s,e,e[7],ba),n=o||function(e){let t,s,o,n,r,i,a,l,c,u,p,h,d;return s=new vn({props:{$$slots:{default:[za]},$$scope:{ctx:e}}}),s.$on("click",e[1]),r=new vn({props:{$$slots:{default:[Ea]},$$scope:{ctx:e}}}),r.$on("click",e[2]),a=new vn({props:{$$slots:{default:[Ia]},$$scope:{ctx:e}}}),a.$on("click",e[3]),c=new vn({props:{$$slots:{default:[Sa]},$$scope:{ctx:e}}}),c.$on("click",e[4]),h=new vn({props:{variant:"danger",$$slots:{default:[Ma]},$$scope:{ctx:e}}}),h.$on("click",e[5]),{c(){t=E("div"),Me(s.$$.fragment),o=M(),n=E("div"),Me(r.$$.fragment),i=M(),Me(a.$$.fragment),l=M(),Me(c.$$.fragment),u=M(),p=E("div"),Me(h.$$.fragment)},m(e,f){L(e,t,f),Ae(s,t,null),L(e,o,f),L(e,n,f),Ae(r,n,null),_(n,i),Ae(a,n,null),_(n,l),Ae(c,n,null),L(e,u,f),L(e,p,f),Ae(h,p,null),d=!0},p(e,t){const o={};128&t&&(o.$$scope={dirty:t,ctx:e}),s.$set(o);const n={};128&t&&(n.$$scope={dirty:t,ctx:e}),r.$set(n);const i={};128&t&&(i.$$scope={dirty:t,ctx:e}),a.$set(i);const l={};128&t&&(l.$$scope={dirty:t,ctx:e}),c.$set(l);const u={};128&t&&(u.$$scope={dirty:t,ctx:e}),h.$set(u)},i(e){d||(xe(s.$$.fragment,e),xe(r.$$.fragment,e),xe(a.$$.fragment,e),xe(c.$$.fragment,e),xe(h.$$.fragment,e),d=!0)},o(e){we(s.$$.fragment,e),we(r.$$.fragment,e),we(a.$$.fragment,e),we(c.$$.fragment,e),we(h.$$.fragment,e),d=!1},d(e){e&&k(t),Ce(s),e&&k(o),e&&k(n),Ce(r),Ce(a),Ce(c),e&&k(u),e&&k(p),Ce(h)}}}(e);return{c(){n&&n.c()},m(e,s){n&&n.m(e,s),t=!0},p(e,t){o&&o.p&&128&t&&h(o,s,e,e[7],t,wa,ba)},i(e){t||(xe(n,e),t=!0)},o(e){we(n,e),t=!1},d(e){n&&n.d(e)}}}function Ca(t){let s;return{c(){s=M()},m(e,t){L(e,s,t)},p:e,i:e,o:e,d(e){e&&k(s)}}}function Pa(e){let t,s;return t=new Er({props:{$$slots:{default:[Ca],list:[Aa],icon:[ka]},$$scope:{ctx:e}}}),{c(){Me(t.$$.fragment)},m(e,o){Ae(t,e,o),s=!0},p(e,s){const o={};128&s&&(o.$$scope={dirty:s,ctx:e}),t.$set(o)},i(e){s||(xe(t.$$.fragment,e),s=!0)},o(e){we(t.$$.fragment,e),s=!1},d(e){Ce(t,e)}}}function Ta(e){let t,s;return t=new Mr({props:{$$slots:{default:[Pa]},$$scope:{ctx:e}}}),t.$on("centerArtboard",e[6]),{c(){Me(t.$$.fragment)},m(e,o){Ae(t,e,o),s=!0},p(e,[s]){const o={};128&s&&(o.$$scope={dirty:s,ctx:e}),t.$set(o)},i(e){s||(xe(t.$$.fragment,e),s=!0)},o(e){we(t.$$.fragment,e),s=!1},d(e){Ce(t,e)}}}function ja(e,t,s){let{$$slots:o={},$$scope:n}=t;return e.$$set=e=>{"$$scope"in e&&s(7,n=e.$$scope)},[o,e=>ft.execute("tilemap_import"),e=>ft.execute("tilemap_export"),e=>ft.execute("tilemap_export_nametable"),e=>ft.execute("tilemap_export_png"),e=>ft.execute("tilemap_clear"),function(t){X(e,t)},n]}class Na extends Te{constructor(e){super(),Pe(this,e,ja,Ta,a,{})}}const Da=Object.freeze({primary:1,secondary:2,move:3,mouseup:4});class Ra{constructor({canvas:e,context:t,width:s,height:o}){this.activeLayer=void 0,this.activePaletteLayer=void 0,this.lastChanged=void 0,this.canvas,this.context,this.width=s,this.height=o;this.animationLoop=rs(this.render.bind(this),120),this.events={},this.eventHandler={};const n=(e,t)=>{switch(t.mouseIsDown=i,e){case Da.primary:r("primary",t);break;case Da.secondary:r("secondary",t);break;case Da.move:r("move",t);break;case Da.mouseup:r("mouseup",t);break;default:console.log("hmm...")}};const r=(e,t)=>{this.events[e]&&(t.realMousePosition=function(e,t){if(!e)return{x:0,y:0};const s=e.getBoundingClientRect(),o=e.width/s.width,n=e.height/s.height;return{x:Math.floor((t.clientX-s.left)*o),y:Math.floor((t.clientY-s.top)*n)}}(this.canvas,t),this.events[e].call(null,t))};let i=!1;this.eventHandler.mousemove=e=>{n(Da.move,e)},this.eventHandler.mouseup=e=>{i=!1,n(Da.mouseup,e)},this.eventHandler.mousedown=e=>{let t;if(i=!0,1==e.which)t=Da.primary;else{if(3!=e.which)return;t=Da.secondary}n(t,e)},document.addEventListener("mousemove",this.eventHandler.mousemove),document.addEventListener("mouseup",this.eventHandler.mouseup)}defineCanvas(e){this.canvas=e,this.context=this.canvas.getContext("2d"),this.canvas.addEventListener("mousedown",this.eventHandler.mousedown)}on(e,t){if("string"!=typeof e&&"function"!=typeof t)throw new Error("Invalid eventlistener");if(this.events[e])throw new Error(`Event already exists : ${e}`);this.events[e]=t}render(e){if(!this.canvas)return;this.context.clearRect(0,0,256,240);const t=ys.stores.activeLayer.get(),s=es.stores.activeLayer.get();t&&s&&(this.lastChanged==es.lastChanged.get()&&this.activeLayer==t&&this.activePaletteLayer==s||(t.drawFromSource(s),this.activeLayer=t,this.activePaletteLayer=s,this.lastChanged=es.lastChanged.get()),this.context.drawImage(t.element,0,0))}destroy(){this.animationLoop.unsubscribe(),this.canvas&&this.canvas.removeEventListener("mousedown",this.eventHandler.mousedown),document.removeEventListener("mousemove",this.eventHandler.mousemove),document.removeEventListener("mouseup",this.eventHandler.mouseup)}}const Oa=new dt("pointer","tile");class Ba{constructor(e){this.icon="",this.offset={x:0,y:0},this.size={width:11,height:11},this.scale={x:1,y:1},Object.assign(this,e)}}class Ha{constructor(e){this.visible_in_toolbar=!0,this.pixelIndicator=!1,this.singleAction=!1}onMount(){}onDestroy(){}primary(){}secondary(){}move(){}mouseup(){}reset(){}}const qa={pointer:new class extends Ha{constructor(){super(),this.title="Pointer (V)",this.name="pointer",this.enum=Oa.get("pointer"),this.weight=100,this.icon="M4 0l16 12.279-6.78 1.138 4.256 8.676-3.902 1.907-4.281-8.758-5.293 4.581z",this.cursor=new Ba({})}primary(e){}secondary(e){}move(e){console.log("aa")}},tile:new class extends Ha{constructor(){super(),this.title="Tile (B)",this.name="tile",this.enum=Oa.get("tile"),this.weight=75,this.icon="M17.831 7.672c1.096-1.096 2.875-1.865 3.688-3.106.892-1.362.508-3.192-.851-4.085-1.362-.892-3.187-.508-4.081.854-.842 1.286-.801 3.322-1.433 4.779-.817 1.882-3.553 2.116-6.698.474-1.727 3.352-4.075 6.949-6.456 9.874l2.263 1.484c1.018-.174 2.279-1.059 2.792-2.03-.04 1.167-.478 2.2-1.337 2.983l4.275 2.797c.546-.544 1.054-.976 1.616-1.345-.319.643-.532 1.324-.63 1.99l2.532 1.659c1.5-2.884 4.416-7.343 6.455-9.874-2.82-2.272-3.657-4.936-2.135-6.454zm1.762-5.545c.454.296.58.908.281 1.36-.294.457-.905.582-1.356.286-.456-.297-.582-.906-.284-1.36.295-.455.905-.583 1.359-.286zm-3.959 15.037l-8.225-5.386 1.616-2.469 8.221 5.387-1.612 2.468z",this.cursor=new Ba({icon:"M17.831 7.672c1.096-1.096 2.875-1.865 3.688-3.106.892-1.362.508-3.192-.851-4.085-1.362-.892-3.187-.508-4.081.854-.842 1.286-.801 3.322-1.433 4.779-.817 1.882-3.553 2.116-6.698.474-1.727 3.352-4.075 6.949-6.456 9.874l2.263 1.484c1.018-.174 2.279-1.059 2.792-2.03-.04 1.167-.478 2.2-1.337 2.983l4.275 2.797c.546-.544 1.054-.976 1.616-1.345-.319.643-.532 1.324-.63 1.99l2.532 1.659c1.5-2.884 4.416-7.343 6.455-9.874-2.82-2.272-3.657-4.936-2.135-6.454zm1.762-5.545c.454.296.58.908.281 1.36-.294.457-.905.582-1.356.286-.456-.297-.582-.906-.284-1.36.295-.455.905-.583 1.359-.286zm-3.959 15.037l-8.225-5.386 1.616-2.469 8.221 5.387-1.612 2.468z",size:{width:66,height:66},stroke:1.5,offset:{x:0,y:10}}),this.properties={remove:void 0,previous:{x:void 0,y:void 0}}}primary(e){let{x:t,y:s}=e.realMousePosition;t>0&&t<256&&s>0&&s<240&&(t=Math.floor(t/8),s=Math.floor(s/8),this.properties.previous.x=t,this.properties.previous.y=s,this.setTileAtPosition({x:t,y:s}))}secondary(e){}setTileAtPosition({x:e,y:t}){const s=ys.stores.activeLayer.get();if(!s)return;const o=ms.stores.selectedTile.stores.current.get();if(!o)return;const{x:n,y:r}=o;s.data[t][e]={x:n,y:r,uuid:ms.stores.activeLayer.get().uuid},s.context.drawImage(ms.stores.activeLayer.get().element,8*n,8*r,8,8,8*e,8*t,8,8)}mouseup(){this.properties.remove=void 0;const e=ys.stores.activeLayer.get();e&&e.forceUpdate()}move(e){let{x:t,y:s}=e.realMousePosition;Is.x=t,Is.y=s,e.mouseIsDown&&t>0&&t<256&&s>0&&s<240&&(t=Math.floor(t/8),s=Math.floor(s/8),1!=e.which&&3!=e.which||(this.properties.previous.x==t&&this.properties.previous.y==s||this.setTileAtPosition({x:t,y:s}),this.properties.previous.x=t,this.properties.previous.y=s))}}},Fa={tools:qa,activeTool:vt(void 0,(({value:e,store:t,get:s})=>({setActive(e){if(!(e instanceof ht))throw new Error("Invalid tool");const o=s();o instanceof Ha&&o.onDestroy();const n=qa[e.key],{cursor:r}=n;let i="default";r&&r.icon&&(i=`url("data:image/svg+xml,%3Csvg transform='' xmlns='http://www.w3.org/2000/svg' width='${r.size.width}' height='${r.size.height}' viewBox='0 0 100 100' xml:space='preserve'%3E %3Cpath fill='white' stroke='black' stroke-width='${r.stroke||2}' d='${r.icon}'/%3E %3C/svg%3E") ${r.offset.x} ${r.offset.y}, auto`),document.documentElement.style.setProperty("--canvas-cursor",i),t.set(n),Array.isArray(n.hotkeysGroups)&&gt.enableGroups("*","tilemaps",...n.hotkeysGroups)}})))};Fa.activeTool.setActive(Oa.get("tile"));const Ka=(e,...t)=>{e&&e.call(Fa.activeTool.get(),...t)};function Ga(t){let s;return{c(){s=S("Please select a spritesheet and palette")},m(e,t){L(e,s,t)},p:e,i:e,o:e,d(e){e&&k(s)}}}function Ja(e){let t,s,o;const n=e[9].default,r=u(n,e,e[8],null);return{c(){t=E("div"),s=E("canvas"),r&&r.c(),T(s,"width",256),T(s,"height",240),T(s,"class","svelte-13r9qvw"),D(t,"--zoom",e[0]),T(t,"class","svelte-13r9qvw")},m(n,i){L(n,t,i),_(t,s),r&&r.m(s,null),e[10](s),o=!0},p(e,s){r&&r.p&&256&s&&h(r,n,e,e[8],s,null,null),(!o||1&s)&&D(t,"--zoom",e[0])},i(e){o||(xe(r,e),o=!0)},o(e){we(r,e),o=!1},d(s){s&&k(t),r&&r.d(s),e[10](null)}}}function Ua(e){let t,s,o,n;const r=[Ja,Ga],i=[];function a(e,t){return e[2]&&e[3].length&&e[4]?0:1}return t=a(e),s=i[t]=r[t](e),{c(){s.c(),o=A()},m(e,s){i[t].m(e,s),L(e,o,s),n=!0},p(e,[n]){let l=t;t=a(e),t===l?i[t].p(e,n):(ve(),we(i[l],1,1,(()=>{i[l]=null})),ye(),s=i[t],s?s.p(e,n):(s=i[t]=r[t](e),s.c()),xe(s,1),s.m(o.parentNode,o))},i(e){n||(xe(s),n=!0)},o(e){we(s),n=!1},d(e){i[t].d(e),e&&k(o)}}}function Va(e,t,s){let o,n,r,{$$slots:i={},$$scope:a}=t,{zoom:l}=t;const{activeLayer:u,layers:p,width:h,height:d}=ys.stores;c(e,u,(e=>s(2,o=e))),c(e,p,(e=>s(3,n=e)));const f=es.stores.activeLayer;let m;c(e,f,(e=>s(4,r=e)));let g=new Ra({width:256,height:240});return g.on("primary",(e=>((...e)=>Ka(Fa.activeTool.get()?.primary,...e))(e))),g.on("secondary",(e=>((...e)=>Ka(Fa.activeTool.get()?.secondary,...e))(e))),g.on("move",(e=>((...e)=>Ka(Fa.activeTool.get()?.move,...e))(e))),g.on("mouseup",(e=>((...e)=>Ka(Fa.activeTool.get()?.mouseup,...e))(e))),Y((()=>()=>{g&&g.destroy()})),e.$$set=e=>{"zoom"in e&&s(0,l=e.zoom),"$$scope"in e&&s(8,a=e.$$scope)},e.$$.update=()=>{2&e.$$.dirty&&m&&g.defineCanvas(m)},[l,m,o,n,r,u,p,f,a,i,function(e){ee[e?"unshift":"push"]((()=>{m=e,s(1,m)}))}]}class Ya extends Te{constructor(e){super(),Pe(this,e,Va,Ua,a,{zoom:0})}}function Wa(e){let t,s;return t=new Ya({props:{zoom:e[0]}}),{c(){Me(t.$$.fragment)},m(e,o){Ae(t,e,o),s=!0},p(e,[s]){const o={};1&s&&(o.zoom=e[0]),t.$set(o)},i(e){s||(xe(t.$$.fragment,e),s=!0)},o(e){we(t.$$.fragment,e),s=!1},d(e){Ce(t,e)}}}function Za(e,t,s){let{zoom:o}=t;return e.$$set=e=>{"zoom"in e&&s(0,o=e.zoom)},[o]}class Xa extends Te{constructor(e){super(),Pe(this,e,Za,Wa,a,{zoom:0})}}function Qa(e,t,s){const o=e.slice();return o[22]=t[s],o}function el(e,t,s){const o=e.slice();return o[25]=t[s],o}function tl(e,t,s){const o=e.slice();return o[28]=t[s],o}function sl(e){let t,s;return t=new Xa({props:{zoom:e[0]}}),{c(){Me(t.$$.fragment)},m(e,o){Ae(t,e,o),s=!0},p(e,s){const o={};1&s[0]&&(o.zoom=e[0]),t.$set(o)},i(e){s||(xe(t.$$.fragment,e),s=!0)},o(e){we(t.$$.fragment,e),s=!1},d(e){Ce(t,e)}}}function ol(e){let t;return{c(){t=E("option"),t.textContent="oh noo!",t.__value="oh noo!",t.value=t.__value},m(e,s){L(e,t,s)},d(e){e&&k(t)}}}function nl(e){let t,s,o,n=e[28].label+"";return{c(){t=E("option"),s=S(n),t.__value=o=e[28],t.value=t.__value},m(e,o){L(e,t,o),_(t,s)},p(e,r){4&r[0]&&n!==(n=e[28].label+"")&&N(s,n),4&r[0]&&o!==(o=e[28])&&(t.__value=o,t.value=t.__value)},d(e){e&&k(t)}}}function rl(e){let t,s=e[2],o=[];for(let t=0;t<s.length;t+=1)o[t]=nl(tl(e,s,t));let n=null;return s.length||(n=ol()),{c(){for(let e=0;e<o.length;e+=1)o[e].c();t=A(),n&&n.c()},m(e,s){for(let t=0;t<o.length;t+=1)o[t].m(e,s);L(e,t,s),n&&n.m(e,s)},p(e,r){if(4&r[0]){let i;for(s=e[2],i=0;i<s.length;i+=1){const n=tl(e,s,i);o[i]?o[i].p(n,r):(o[i]=nl(n),o[i].c(),o[i].m(t.parentNode,t))}for(;i<o.length;i+=1)o[i].d(1);o.length=s.length,s.length?n&&(n.d(1),n=null):n||(n=ol(),n.c(),n.m(t.parentNode,t))}},d(e){z(o,e),e&&k(t),n&&n.d(e)}}}function il(e){let t,s=e[4],o=cl(e);return{c(){o.c(),t=A()},m(e,s){o.m(e,s),L(e,t,s)},p(e,n){16&n[0]&&a(s,s=e[4])?(o.d(1),o=cl(e),o.c(),o.m(t.parentNode,t)):o.p(e,n)},d(e){e&&k(t),o.d(e)}}}function al(e){let t,s,o;function n(...t){return e[15](e[25],e[22],...t)}return{c(){t=E("div"),T(t,"class","tile-image svelte-on0f2o"),D(t,"--src","url("+e[3].image.src+")"),D(t,"--x",e[22]+1),D(t,"--y",e[25]+1),O(t,"active",e[5]?.x==15-e[25]&&e[5]?.y==15-e[22]&&e[3]==e[5].ref)},m(e,r){L(e,t,r),s||(o=C(t,"click",n),s=!0)},p(s,o){e=s,8&o[0]&&D(t,"--src","url("+e[3].image.src+")"),6184&o[0]&&O(t,"active",e[5]?.x==15-e[25]&&e[5]?.y==15-e[22]&&e[3]==e[5].ref)},d(e){e&&k(t),s=!1,o()}}}function ll(e){let t,s=e[12],o=[];for(let t=0;t<s.length;t+=1)o[t]=al(el(e,s,t));return{c(){for(let e=0;e<o.length;e+=1)o[e].c();t=A()},m(e,s){for(let t=0;t<o.length;t+=1)o[t].m(e,s);L(e,t,s)},p(e,n){if(6184&n[0]){let r;for(s=e[12],r=0;r<s.length;r+=1){const i=el(e,s,r);o[r]?o[r].p(i,n):(o[r]=al(i),o[r].c(),o[r].m(t.parentNode,t))}for(;r<o.length;r+=1)o[r].d(1);o.length=s.length}},d(e){z(o,e),e&&k(t)}}}function cl(e){let t,s=e[11],o=[];for(let t=0;t<s.length;t+=1)o[t]=ll(Qa(e,s,t));return{c(){for(let e=0;e<o.length;e+=1)o[e].c();t=A()},m(e,s){for(let t=0;t<o.length;t+=1)o[t].m(e,s);L(e,t,s)},p(e,n){if(6184&n[0]){let r;for(s=e[11],r=0;r<s.length;r+=1){const i=Qa(e,s,r);o[r]?o[r].p(i,n):(o[r]=ll(i),o[r].c(),o[r].m(t.parentNode,t))}for(;r<o.length;r+=1)o[r].d(1);o.length=s.length}},d(e){z(o,e),e&&k(t)}}}function ul(e){let t,s,o,n,r,i,a,l,c,u,p,h,d,f,m,g,$,v,y,x,w,b;function z(t){e[14].call(null,t)}r=new Na({}),r.$on("centerArtboard",ct),a=new pt({props:{$$slots:{default:[sl]},$$scope:{ctx:e}}}),a.$on("artboardScrollEvent",e[10]);let I={$$slots:{default:[rl]},$$scope:{ctx:e}};void 0!==e[1]&&(I.value=e[1]),h=new Ji({props:I}),ee.push((()=>Se(h,"value",z))),h.$on("change",e[13]);let S=e[3]&&il(e);return v=new xa({}),w=new mr({props:{showEditButtons:!1}}),{c(){t=E("section"),s=E("div"),o=M(),n=E("div"),Me(r.$$.fragment),i=M(),Me(a.$$.fragment),l=M(),c=E("section"),u=E("header"),p=E("div"),Me(h.$$.fragment),f=M(),m=E("div"),S&&S.c(),g=M(),$=E("section"),Me(v.$$.fragment),y=M(),x=E("section"),Me(w.$$.fragment),T(n,"class","inner-artboard svelte-on0f2o"),T(u,"class","svelte-on0f2o"),T(m,"class","tile-grid svelte-on0f2o"),T(c,"class","tiles svelte-on0f2o"),T(t,"class","main-artboard svelte-on0f2o"),T($,"class","spritesheets-layer svelte-on0f2o"),T(x,"class","palettes-layer svelte-on0f2o")},m(e,d){L(e,t,d),_(t,s),_(t,o),_(t,n),Ae(r,n,null),_(n,i),Ae(a,n,null),_(t,l),_(t,c),_(c,u),_(u,p),Ae(h,p,null),_(c,f),_(c,m),S&&S.m(m,null),L(e,g,d),L(e,$,d),Ae(v,$,null),L(e,y,d),L(e,x,d),Ae(w,x,null),b=!0},p(e,t){const s={};1&t[0]|1&t[1]&&(s.$$scope={dirty:t,ctx:e}),a.$set(s);const o={};4&t[0]|1&t[1]&&(o.$$scope={dirty:t,ctx:e}),!d&&2&t[0]&&(d=!0,o.value=e[1],le((()=>d=!1))),h.$set(o),e[3]?S?S.p(e,t):(S=il(e),S.c(),S.m(m,null)):S&&(S.d(1),S=null)},i(e){b||(xe(r.$$.fragment,e),xe(a.$$.fragment,e),xe(h.$$.fragment,e),xe(v.$$.fragment,e),xe(w.$$.fragment,e),b=!0)},o(e){we(r.$$.fragment,e),we(a.$$.fragment,e),we(h.$$.fragment,e),we(v.$$.fragment,e),we(w.$$.fragment,e),b=!1},d(e){e&&k(t),Ce(r),Ce(a),Ce(h),S&&S.d(),e&&k(g),e&&k($),Ce(v),e&&k(y),e&&k(x),Ce(w)}}}function pl(e,t,s){let o,n,r,i;const{current:a,fallback:l}=ms.stores.selectedTile.stores;c(e,a,(e=>s(5,i=e))),ys.stores;const{activeLayer:u,selectedTile:p}=ms.stores;c(e,u,(e=>s(3,n=e)));const{layers:h,activeLayer:d,activeImage:f}=qi.stores;c(e,h,(e=>s(2,o=e))),c(e,f,(e=>s(4,r=e)));let m=2;const g=(e=16)=>new Array(e).fill(null).map(((e,t)=>t)).reverse();let $,v=[...g()],y=[...g()];return[m,$,o,n,r,i,a,u,h,f,e=>{s(0,m=Math.max(1,m+(m-e.detail.deltaY>0?1:-1)))},v,y,e=>{ft.execute("spritesheet_make_layer_active",$)},function(e){$=e,s(1,$)},(e,t,s)=>ft.execute("spritesheet_set_selected_tile",{x:15-e,y:15-t,ref:n})]}class hl extends Te{constructor(e){super(),Pe(this,e,pl,ul,a,{},[-1,-1])}}const dl=So(Ko);dl("/graphics",(e=>io("/graphics/spritesheets"))),dl("/graphics/spritesheets",((e,t)=>{try{gt.enableGroups("*","spritesheets"),t.send(ri)}catch(e){t.error()}}));So(class extends Te{constructor(e){super(),Pe(this,e,Jo,Go,a,{})}})("/graphics/palettes",((e,t)=>{try{gt.enableGroups("*","palettes"),t.send(Ri)}catch(e){t.error()}}));So(Ko)("/graphics/spritesets",((e,t)=>{try{gt.enableGroups("*","spritesheets"),t.send(ia)}catch(e){t.error()}}));So(class extends Te{constructor(e){super(),Pe(this,e,Vo,Uo,a,{})}})("/graphics/tilemaps",((e,t)=>{try{gt.enableGroups("*","tilemaps"),t.send(hl)}catch(e){t.error()}})),Co.get("/",((e,t)=>{})),gt.set(["F11"],{data:{action:ft.action("window_toggle_fullscreen")}}),gt.set(["Altleft","Enter"],{data:{action:ft.action("window_toggle_fullscreen")}}),gt.set(["ControlLeft","KeyS"],{data:{action:ft.action("project_save")}}),gt.set(["F5"],{data:{action:ft.action("project_build_run")}}),gt.set(["F6"],{data:{action:ft.action("project_run")}}),gt.set(["F7"],{data:{action:ft.action("project_build")}}),gt.set(["KeyC"],{data:{action:ft.action("graphics_center_artboard")}});const fl=["palettes"];gt.set(["insert"],{data:{action:ft.action("palette_create")},groups:fl}),gt.set(["ControlLeft","KeyD"],{data:{action:ft.action("palette_clone_active_layer")},groups:fl}),gt.set(["f2"],{data:{action:ft.action("palette_focus_rename_active_layer")},groups:fl});gt.set(["ControlLeft","KeyI"],{data:{action:ft.action("palette_import")},groups:fl}).on((e=>$t(e)));gt.set(["ControlLeft","KeyE"],{data:{action:ft.action("palette_export")},groups:fl}).on((e=>$t(e)));gt.set(["ControlLeft","KeyO"],{data:{action:ft.action("project_open")},groups:["*"]}).on((e=>$t(e)));const ml=["spritesheets"];gt.set(["insert"],{data:{action:ft.action("spritesheet_create")},groups:ml}),gt.set(["ControlLeft","KeyD"],{data:{action:ft.action("spritesheet_clone_active_layer")},groups:ml}),gt.set(["ControlLeft","KeyZ"],{data:{action:ft.action("spritesheet_undo")},groups:ml}),gt.set(["ControlLeft","ShiftLeft","KeyZ"],{data:{action:ft.action("spritesheet_redo")},groups:ml}),gt.set(["ControlLeft","KeyY"],{data:{action:ft.action("spritesheet_redo")},groups:ml}),gt.set(["f2"],{data:{action:ft.action("spritesheet_focus_rename_active_layer")},groups:ml});gt.set(["ControlLeft","KeyI"],{data:{action:ft.action("spritesheet_import")},groups:ml}).on((e=>$t(e)));function gl(e){let t,o,n,r;const i=e[3].default,a=u(i,e,e[2],null);let l=[e[1]],c={};for(let e=0;e<l.length;e+=1)c=s(c,l[e]);return{c(){t=E("button"),a&&a.c(),j(t,c)},m(s,i){L(s,t,i),a&&a.m(t,null),o=!0,n||(r=C(t,"click",P(e[5])),n=!0)},p(e,s){a&&a.p&&4&s&&h(a,i,e,e[2],s,null,null),j(t,c=Ee(l,[2&s&&e[1]]))},i(e){o||(xe(a,e),o=!0)},o(e){we(a,e),o=!1},d(e){e&&k(t),a&&a.d(e),n=!1,r()}}}function $l(e){let t,o,n,r;const i=e[3].default,a=u(i,e,e[2],null);let l=[e[1]],c={};for(let e=0;e<l.length;e+=1)c=s(c,l[e]);return{c(){t=E("button"),a&&a.c(),j(t,c)},m(s,i){L(s,t,i),a&&a.m(t,null),o=!0,n||(r=C(t,"click",e[4]),n=!0)},p(e,s){a&&a.p&&4&s&&h(a,i,e,e[2],s,null,null),j(t,c=Ee(l,[2&s&&e[1]]))},i(e){o||(xe(a,e),o=!0)},o(e){we(a,e),o=!1},d(e){e&&k(t),a&&a.d(e),n=!1,r()}}}function vl(e){let t,s,o,n;const r=[$l,gl],i=[];return t=globalThis.electron?1:0,s=i[t]=r[t](e),{c(){s.c(),o=A()},m(e,s){i[t].m(e,s),L(e,o,s),n=!0},p(e,[t]){s.p(e,t)},i(e){n||(xe(s),n=!0)},o(e){we(s),n=!1},d(e){i[t].d(e),e&&k(o)}}}function yl(e,t,o){let{$$slots:n={},$$scope:r}=t;const{href:i}=t;return e.$$set=e=>{o(1,t=s(s({},t),d(e))),"$$scope"in e&&o(2,r=e.$$scope)},t=d(t),[i,t,r,n,e=>window.open(i),e=>ft.execute("external_link",i)]}gt.set(["ControlLeft","KeyE"],{data:{action:ft.action("spritesheet_export")},groups:ml}).on((e=>$t(e))),gt.set(["Digit1"],{data:{action:ft.action("palette_active_color"),props:0},groups:ml}),gt.set(["Digit2"],{data:{action:ft.action("palette_active_color"),props:1},groups:ml}),gt.set(["Digit3"],{data:{action:ft.action("palette_active_color"),props:2},groups:ml}),gt.set(["Digit4"],{data:{action:ft.action("palette_active_color"),props:3},groups:ml}),gt.set(["NumpadAdd"],{data:{action:ft.action("spritesheet_zoom_in")},groups:ml}),gt.set(["NumpadSubtract"],{data:{action:ft.action("spritesheet_zoom_out")},groups:ml}),gt.set(["Numpad0"],{data:{action:ft.action("spritesheet_zoom_reset")},groups:ml}),gt.set(["KeyV"],{data:{action:ft.action("spritesheet_set_active_tool"),props:ws.get("pointer")},groups:ml}),gt.set(["KeyB"],{data:{action:ft.action("spritesheet_set_active_tool"),props:ws.get("pen")},groups:ml}),gt.set(["KeyG"],{data:{action:ft.action("spritesheet_set_active_tool"),props:ws.get("paintbucket")},groups:ml}),gt.set(["KeyA"],{data:{action:ft.action("spritesheet_set_active_tool"),props:ws.get("colorattribute")},groups:ml}),gt.set(["KeyE"],{data:{action:ft.action("spritesheet_set_active_tool"),props:ws.get("eyedropper")},groups:ml}),gt.set(["KeyP"],{data:{action:ft.action("spritesheet_set_active_tool"),props:ws.get("preview")},groups:ml}),gt.set(["KeyS"],{data:{action:ft.action("spritesheet_set_active_tool"),props:ws.get("colorswap")},groups:ml}),gt.set(["KeyT"],{data:{action:ft.action("spritesheet_set_active_tool"),props:ws.get("tileswap")},groups:ml}),gt.set(["KeyR"],{data:{action:ft.action("spritesheet_set_active_tool"),props:ws.get("transform")},groups:ml}),gt.set(["KeyM"],{data:{action:ft.action("spritesheet_set_active_tool"),props:ws.get("marquee")},groups:ml}),gt.set(["KeyZ"],{data:{action:ft.action("spritesheet_set_active_tool"),props:ws.get("zoom")},groups:ml});class xl extends Te{constructor(e){super(),Pe(this,e,yl,vl,a,{})}}function wl(e){let t;return{c(){t=S("Visit github page")},m(e,s){L(e,t,s)},d(e){e&&k(t)}}}function bl(e){let t;return{c(){t=S("Join discord community")},m(e,s){L(e,t,s)},d(e){e&&k(t)}}}function _l(t){let s,o,n,i,a,l,c,u,p,h,d,f,m,g,$,v,y,x,w,b,z,I,S,A,j,N,D,R,B,H,q,F,K,G,J,U,V,Y,W,Z,X,Q,ee=globalThis.electron&&function(t){let s,o,n,r;return{c(){s=E("li"),o=E("button"),o.innerHTML="<span>quit</span>",T(o,"href","/"),T(s,"class","svelte-wz8iyp")},m(e,i){L(e,s,i),_(s,o),n||(r=C(o,"click",t[4]),n=!0)},p:e,d(e){e&&k(s),n=!1,r()}}}(t);return U=new xl({props:{href:"https://github.com/hjalmar/NESBitStudio-web",$$slots:{default:[wl]},$$scope:{ctx:t}}}),W=new xl({props:{href:"https://discord.gg/7mCVKnkjHc",$$slots:{default:[bl]},$$scope:{ctx:t}}}),{c(){s=E("nav"),o=E("ul"),n=E("li"),i=E("span"),i.textContent="file",a=M(),l=E("ul"),c=E("li"),u=E("button"),u.innerHTML="<span>new project</span>",p=M(),h=E("li"),d=E("button"),d.innerHTML="<span>open</span>",f=M(),m=E("li"),g=E("button"),g.innerHTML="<span>save</span>",$=M(),v=E("li"),y=E("button"),y.innerHTML="<span>save as</span>",x=M(),ee&&ee.c(),w=M(),b=E("li"),b.innerHTML="<span>edit</span>",z=M(),I=E("li"),I.innerHTML="<span>build</span>",S=M(),A=E("li"),j=E("span"),j.textContent="window",N=M(),D=E("ul"),R=E("li"),B=E("button"),B.innerHTML="<span>toggle fullscreen</span>",H=M(),q=E("li"),F=E("span"),F.textContent="help",K=M(),G=E("ul"),J=E("li"),Me(U.$$.fragment),V=M(),Y=E("li"),Me(W.$$.fragment),T(u,"href","/"),T(c,"class","svelte-wz8iyp"),T(d,"href","/"),T(h,"class","svelte-wz8iyp"),T(g,"href","/"),T(m,"class","svelte-wz8iyp"),T(y,"href","/"),T(v,"class","svelte-wz8iyp"),T(l,"class","svelte-wz8iyp"),T(n,"class","svelte-wz8iyp"),O(n,"show",!1),T(b,"class","svelte-wz8iyp"),T(I,"class","svelte-wz8iyp"),T(B,"href","/"),T(R,"class","svelte-wz8iyp"),T(D,"class","svelte-wz8iyp"),T(A,"class","svelte-wz8iyp"),T(J,"class","svelte-wz8iyp"),T(Y,"class","svelte-wz8iyp"),T(G,"class","svelte-wz8iyp"),T(q,"class","svelte-wz8iyp"),T(o,"id","filemenu"),T(o,"class","svelte-wz8iyp"),T(s,"id","main-nav"),T(s,"class","no-drag")},m(e,r){L(e,s,r),_(s,o),_(o,n),_(n,i),_(n,a),_(n,l),_(l,c),_(c,u),_(l,p),_(l,h),_(h,d),_(l,f),_(l,m),_(m,g),_(l,$),_(l,v),_(v,y),_(l,x),ee&&ee.m(l,null),_(o,w),_(o,b),_(o,z),_(o,I),_(o,S),_(o,A),_(A,j),_(A,N),_(A,D),_(D,R),_(R,B),_(o,H),_(o,q),_(q,F),_(q,K),_(q,G),_(G,J),Ae(U,J,null),_(G,V),_(G,Y),Ae(W,Y,null),Z=!0,X||(Q=[C(u,"click",P(t[0])),C(d,"click",P(t[1])),C(g,"click",P(t[2])),C(y,"click",P(t[3])),C(B,"click",P(t[5]))],X=!0)},p(e,[t]){globalThis.electron&&ee.p(e,t);const s={};2048&t&&(s.$$scope={dirty:t,ctx:e}),U.$set(s);const o={};2048&t&&(o.$$scope={dirty:t,ctx:e}),W.$set(o)},i(e){Z||(xe(U.$$.fragment,e),xe(W.$$.fragment,e),Z=!0)},o(e){we(U.$$.fragment,e),we(W.$$.fragment,e),Z=!1},d(e){e&&k(s),ee&&ee.d(),Ce(U),Ce(W),X=!1,r(Q)}}}function Ll(e){let t=!1,s=[];const o=e=>{s.forEach((e=>e.classList.remove("show"))),t=!1};window.addEventListener("click",o);const n=e=>{e.stopPropagation(),t=!t,e.currentTarget.classList.toggle("show")},r=e=>{s.forEach((e=>e.classList.remove("show"))),t&&e.currentTarget.classList.add("show")};Y((()=>{s=document.querySelectorAll("nav > ul > li"),s.forEach((e=>e.addEventListener("click",n))),s.forEach((e=>e.addEventListener("mouseover",r)))})),W((()=>{window.removeEventListener("click",o),s.forEach((e=>e.removeEventListener("click",n))),s.forEach((e=>e.removeEventListener("mouseover",r)))}));return[e=>ft.execute("project_create"),e=>ft.execute("project_open"),e=>ft.execute("project_save"),e=>ft.execute("project_save_as"),e=>ft.execute("window_close"),e=>ft.execute("window_toggle_fullscreen")]}class kl extends Te{constructor(e){super(),Pe(this,e,Ll,_l,a,{})}}function zl(e){let t,s,o,n;const r=e[6].default,i=u(r,e,e[5],null);return{c(){t=E("button"),i&&i.c(),T(t,"class","no-drag svelte-1j6abr5"),O(t,"active",e[1])},m(r,a){L(r,t,a),i&&i.m(t,null),e[7](t),s=!0,o||(n=C(t,"click",e[2]),o=!0)},p(e,[s]){i&&i.p&&32&s&&h(i,r,e,e[5],s,null,null),2&s&&O(t,"active",e[1])},i(e){s||(xe(i,e),s=!0)},o(e){we(i,e),s=!1},d(s){s&&k(t),i&&i.d(s),e[7](null),o=!1,n()}}}function El(e,t,s){let o,n;c(e,fo,(e=>s(4,n=e)));let r,{$$slots:i={},$$scope:a}=t,{area:l=null}=t;return e.$$set=e=>{"area"in e&&s(3,l=e.area),"$$scope"in e&&s(5,a=e.$$scope)},e.$$.update=()=>{24&e.$$.dirty&&s(1,o=n.startsWith(`/${l}`))},[r,o,e=>{l&&io("/"+l)},l,n,a,i,function(e){ee[e?"unshift":"push"]((()=>{r=e,s(0,r)}))}]}class Il extends Te{constructor(e){super(),Pe(this,e,El,zl,a,{area:3})}}function Sl(e){let t,s;return{c(){t=I("svg"),s=I("path"),T(s,"d","M6 2l1.171.203c-.355 2.245.791 2.519 2.699 2.874 1.468.273 3.13.622 3.13 3.284v.639h-1.183v-.639c0-1.556-.48-1.809-2.164-2.122-2.583-.48-4.096-1.391-3.653-4.239zm18 14c0 3.312-2.607 6-5.825 6-1.511 0-2.886-.595-3.921-1.565-1.311-1.229-3.278-1.132-4.55.038-1.03.948-2.389 1.527-3.879 1.527-3.217 0-5.825-2.688-5.825-6s2.608-6 5.825-6l12.563.007c3.118.116 5.612 2.755 5.612 5.993zm-15-1h-2v-2h-2v2h-2v2h2v2h2v-2h2v-2zm4 1h-2v1h2v-1zm4-2c0 .552.447 1 1 1s1-.448 1-1-.447-1-1-1-1 .448-1 1zm0 2c0-.552-.447-1-1-1s-1 .448-1 1 .447 1 1 1 1-.448 1-1zm2 2c0-.552-.447-1-1-1s-1 .448-1 1 .447 1 1 1 1-.448 1-1zm2-2c0-.552-.447-1-1-1s-1 .448-1 1 .447 1 1 1 1-.448 1-1z"),T(t,"xmlns","http://www.w3.org/2000/svg"),T(t,"width","24"),T(t,"height","24"),T(t,"viewBox","0 0 24 24"),T(t,"class","svelte-1bhpuaq")},m(e,o){L(e,t,o),_(t,s)},d(e){e&&k(t)}}}function Ml(e){let t,s;return{c(){t=I("svg"),s=I("path"),T(s,"d","M0 21.398c5.504.456 3.533-5.392 8.626-5.445l2.206 1.841c.549 6.645-7.579 8.127-10.832 3.604zm16.878-8.538c1.713-2.687 7.016-11.698 7.016-11.698.423-.747-.515-1.528-1.17-.976 0 0-7.887 6.857-10.213 9.03-1.838 1.719-1.846 2.504-2.441 5.336l2.016 1.681c2.67-1.098 3.439-1.248 4.792-3.373z"),T(t,"xmlns","http://www.w3.org/2000/svg"),T(t,"width","24"),T(t,"height","24"),T(t,"viewBox","0 0 24 24"),T(t,"class","svelte-1bhpuaq")},m(e,o){L(e,t,o),_(t,s)},d(e){e&&k(t)}}}function Al(e){let t,s;return{c(){t=I("svg"),s=I("path"),T(s,"d","M13 0h-2v15.676c-3.379-.667-7 1.915-7 4.731 0 2.367 1.881 3.593 3.919 3.593 2.423 0 5.077-1.728 5.081-5.24v-12.76c3.009 2.223 5.623 3.243 5.059 7 1.431-1.727 1.941-2.817 1.941-4.051 0-4.446-7-5.915-7-8.949z"),T(t,"xmlns","http://www.w3.org/2000/svg"),T(t,"width","24"),T(t,"height","24"),T(t,"viewBox","0 0 24 24"),T(t,"class","svelte-1bhpuaq")},m(e,o){L(e,t,o),_(t,s)},d(e){e&&k(t)}}}function Cl(e){let t,s;return{c(){t=I("svg"),s=I("path"),T(s,"d","M23 10.826v2.349c-1.562 0-3 1.312-3 2.857 0 2.181 1.281 5.968-6 5.968v-2.002c4.917 0 3.966-1.6 3.966-3.967 0-2.094 1.211-3.5 2.278-4.031-1.067-.531-2.278-1.438-2.278-3.312 0-2.372.94-4.692-3.966-4.686v-2.002c7.285 0 6 4.506 6 6.688 0 1.544 1.438 2.138 3 2.138zm-19-2.138c0-2.182-1.285-6.688 6-6.688v2.002c-4.906-.007-3.966 2.313-3.966 4.686 0 1.875-1.211 2.781-2.278 3.312 1.067.531 2.278 1.938 2.278 4.031 0 2.367-.951 3.967 3.966 3.967v2.002c-7.281 0-6-3.787-6-5.969 0-1.545-1.438-2.857-3-2.857v-2.349c1.562.001 3-.593 3-2.137z"),T(t,"xmlns","http://www.w3.org/2000/svg"),T(t,"width","24"),T(t,"height","24"),T(t,"viewBox","0 0 24 24"),T(t,"class","svelte-1bhpuaq")},m(e,o){L(e,t,o),_(t,s)},d(e){e&&k(t)}}}function Pl(e){let t,s;return{c(){t=I("svg"),s=I("path"),T(s,"d","M24 19h-1v-2.2c-1.853 4.237-6.083 7.2-11 7.2-6.623 0-12-5.377-12-12h1c0 6.071 4.929 11 11 11 4.66 0 8.647-2.904 10.249-7h-2.249v-1h4v4zm-11.036 0h-1.886c-.34-.957-.437-1.571-1.177-1.878h-.001c-.743-.308-1.251.061-2.162.494l-1.333-1.333c.427-.899.804-1.415.494-2.163-.308-.74-.926-.839-1.878-1.177v-1.886c.954-.339 1.57-.437 1.878-1.178.308-.743-.06-1.248-.494-2.162l1.333-1.333c.918.436 1.421.801 2.162.494l.001-.001c.74-.307.838-.924 1.177-1.877h1.886c.34.958.437 1.57 1.177 1.877l.001.001c.743.308 1.252-.062 2.162-.494l1.333 1.333c-.435.917-.801 1.421-.494 2.161v.001c.307.739.915.835 1.878 1.178v1.886c-.953.338-1.571.437-1.878 1.178-.308.743.06 1.249.494 2.162l-1.333 1.333c-.92-.438-1.42-.802-2.157-.496-.746.31-.844.926-1.183 1.88zm-.943-4.667c-1.289 0-2.333-1.044-2.333-2.333 0-1.289 1.044-2.334 2.333-2.334 1.289 0 2.333 1.045 2.333 2.334 0 1.289-1.044 2.333-2.333 2.333zm-8.021-5.333h-4v-4h1v2.2c1.853-4.237 6.083-7.2 11-7.2 6.623 0 12 5.377 12 12h-1c0-6.071-4.929-11-11-11-4.66 0-8.647 2.904-10.249 7h2.249v1z"),T(t,"width","24"),T(t,"height","24"),T(t,"viewBox","0 0 24 24"),T(t,"xmlns","http://www.w3.org/2000/svg"),T(t,"fill-rule","evenodd"),T(t,"clip-rule","evenodd"),T(t,"class","svelte-1bhpuaq")},m(e,o){L(e,t,o),_(t,s)},d(e){e&&k(t)}}}function Tl(e){let t,s,o,n,r,i,a,l,c,u,p,h,d,f;o=new Il({props:{area:"game",$$slots:{default:[Sl]},$$scope:{ctx:e}}}),i=new Il({props:{area:"graphics",$$slots:{default:[Ml]},$$scope:{ctx:e}}}),c=new Il({props:{area:"audio",$$slots:{default:[Al]},$$scope:{ctx:e}}}),h=new Il({props:{area:"code",$$slots:{default:[Cl]},$$scope:{ctx:e}}});let m=globalThis.electron&&function(e){let t,s,o,n,r;return s=new Il({props:{$$slots:{default:[Pl]},$$scope:{ctx:e}}}),{c(){t=E("li"),Me(s.$$.fragment),T(t,"class","last svelte-1bhpuaq")},m(i,a){L(i,t,a),Ae(s,t,null),o=!0,n||(r=C(t,"click",e[0]),n=!0)},p(e,t){const o={};2&t&&(o.$$scope={dirty:t,ctx:e}),s.$set(o)},i(e){o||(xe(s.$$.fragment,e),o=!0)},o(e){we(s.$$.fragment,e),o=!1},d(e){e&&k(t),Ce(s),n=!1,r()}}}(e);return{c(){t=E("ul"),s=E("li"),Me(o.$$.fragment),n=M(),r=E("li"),Me(i.$$.fragment),a=M(),l=E("li"),Me(c.$$.fragment),u=M(),p=E("li"),Me(h.$$.fragment),d=M(),m&&m.c(),T(s,"class","svelte-1bhpuaq"),T(r,"class","svelte-1bhpuaq"),T(l,"class","svelte-1bhpuaq"),T(p,"class","svelte-1bhpuaq"),T(t,"class","area svelte-1bhpuaq")},m(e,g){L(e,t,g),_(t,s),Ae(o,s,null),_(t,n),_(t,r),Ae(i,r,null),_(t,a),_(t,l),Ae(c,l,null),_(t,u),_(t,p),Ae(h,p,null),_(t,d),m&&m.m(t,null),f=!0},p(e,[t]){const s={};2&t&&(s.$$scope={dirty:t,ctx:e}),o.$set(s);const n={};2&t&&(n.$$scope={dirty:t,ctx:e}),i.$set(n);const r={};2&t&&(r.$$scope={dirty:t,ctx:e}),c.$set(r);const a={};2&t&&(a.$$scope={dirty:t,ctx:e}),h.$set(a),globalThis.electron&&m.p(e,t)},i(e){f||(xe(o.$$.fragment,e),xe(i.$$.fragment,e),xe(c.$$.fragment,e),xe(h.$$.fragment,e),xe(m),f=!0)},o(e){we(o.$$.fragment,e),we(i.$$.fragment,e),we(c.$$.fragment,e),we(h.$$.fragment,e),we(m),f=!1},d(e){e&&k(t),Ce(o),Ce(i),Ce(c),Ce(h),m&&m.d()}}}function jl(e){return[e=>ft.execute("project_build_run")]}class Nl extends Te{constructor(e){super(),Pe(this,e,jl,Tl,a,{})}}function Dl(t){let s,o,n,i,a,l,c;return{c(){s=E("button"),o=M(),n=E("button"),i=M(),a=E("button"),T(s,"class","minimize svelte-188xc0"),T(n,"class","maximize svelte-188xc0"),T(a,"class","close svelte-188xc0")},m(e,r){L(e,s,r),L(e,o,r),L(e,n,r),L(e,i,r),L(e,a,r),l||(c=[C(s,"click",t[1]),C(n,"click",t[2]),C(a,"click",t[3])],l=!0)},p:e,i:e,o:e,d(e){e&&k(s),e&&k(o),e&&k(n),e&&k(i),e&&k(a),l=!1,r(c)}}}function Rl(e){const t=e=>ft.execute(`window_${e}`);return[t,e=>t("minimize"),e=>t("maximize"),e=>t("close")]}class Ol extends Te{constructor(e){super(),Pe(this,e,Rl,Dl,a,{})}}function Bl(e){let t,s,o,n,r,i,a,l,c,u,p,h,d,f,m,g,$,v,y=(e[0]||"not saved *")+"";return h=new kl({}),f=new Nl({}),$=new Ol({}),{c(){t=E("header"),s=E("div"),o=M(),n=E("div"),r=E("div"),i=S("["),a=E("span"),l=S(y),c=S("]"),u=M(),p=E("div"),Me(h.$$.fragment),d=M(),Me(f.$$.fragment),m=M(),g=E("div"),Me($.$$.fragment),T(s,"class","drag app-region svelte-2xhiq2"),T(a,"class","no-paint svelte-2xhiq2"),T(r,"class","titlebar svelte-2xhiq2"),T(p,"id","top-navigation"),T(p,"class","svelte-2xhiq2"),T(g,"id","window-buttons"),T(g,"class","svelte-2xhiq2"),T(n,"class","inner svelte-2xhiq2"),T(t,"id","masthead"),T(t,"class","svelte-2xhiq2")},m(e,y){L(e,t,y),_(t,s),_(t,o),_(t,n),_(n,r),_(r,i),_(r,a),_(a,l),_(r,c),_(n,u),_(n,p),Ae(h,p,null),_(p,d),Ae(f,p,null),_(n,m),_(n,g),Ae($,g,null),v=!0},p(e,[t]){(!v||1&t)&&y!==(y=(e[0]||"not saved *")+"")&&N(l,y)},i(e){v||(xe(h.$$.fragment,e),xe(f.$$.fragment,e),xe($.$$.fragment,e),v=!0)},o(e){we(h.$$.fragment,e),we(f.$$.fragment,e),we($.$$.fragment,e),v=!1},d(e){e&&k(t),Ce(h),Ce(f),Ce($)}}}function Hl(e,t,s){let o,n;return c(e,xs,(e=>s(1,n=e))),e.$$.update=()=>{2&e.$$.dirty&&s(0,o=xn(n.path||""))},[o,n]}class ql extends Te{constructor(e){super(),Pe(this,e,Hl,Bl,a,{})}}function Fl(e,t,s){const o=e.slice();return o[4]=t[s].error,o[5]=t[s].date,o}function Kl(e){let t,s,o,n,r,i,a,l,c=e[5]+"",u=e[4].message+"";return{c(){t=E("li"),s=S("["),o=S(c),n=S("] ( "),r=S(u),i=S(" )\r\n        "),a=E("div"),a.textContent="some extra hidden details",l=M(),T(a,"class","details svelte-8fmup"),T(t,"class","svelte-8fmup")},m(e,c){L(e,t,c),_(t,s),_(t,o),_(t,n),_(t,r),_(t,i),_(t,a),_(t,l)},p(e,t){2&t&&c!==(c=e[5]+"")&&N(o,c),2&t&&u!==(u=e[4].message+"")&&N(r,u)},d(e){e&&k(t)}}}function Gl(e){let t,s=e[4]&&Kl(e);return{c(){s&&s.c(),t=A()},m(e,o){s&&s.m(e,o),L(e,t,o)},p(e,o){e[4]?s?s.p(e,o):(s=Kl(e),s.c(),s.m(t.parentNode,t)):s&&(s.d(1),s=null)},d(e){s&&s.d(e),e&&k(t)}}}function Jl(t){let s,o=t[1],n=[];for(let e=0;e<o.length;e+=1)n[e]=Gl(Fl(t,o,e));return{c(){s=E("ul");for(let e=0;e<n.length;e+=1)n[e].c();T(s,"class","svelte-8fmup")},m(e,o){L(e,s,o);for(let e=0;e<n.length;e+=1)n[e].m(s,null);t[2](s)},p(e,[t]){if(2&t){let r;for(o=e[1],r=0;r<o.length;r+=1){const i=Fl(e,o,r);n[r]?n[r].p(i,t):(n[r]=Gl(i),n[r].c(),n[r].m(s,null))}for(;r<n.length;r+=1)n[r].d(1);n.length=o.length}},i:e,o:e,d(e){e&&k(s),z(n,e),t[2](null)}}}function Ul(e,t,s){let o,n=[];const r=Fe.subscribe((async e=>{s(1,n=[...e]),await ie(),o&&o.scrollTo({top:1e9,left:0,behavior:"smooth"})}));return W((()=>{r()})),[o,n,function(e){ee[e?"unshift":"push"]((()=>{o=e,s(0,o)}))}]}class Vl extends Te{constructor(e){super(),Pe(this,e,Ul,Jl,a,{})}}function Yl(t){let s,o,n;return o=new Vl({}),{c(){s=E("footer"),Me(o.$$.fragment),T(s,"class","footer svelte-zj1pup")},m(e,t){L(e,s,t),Ae(o,s,null),n=!0},p:e,i(e){n||(xe(o.$$.fragment,e),n=!0)},o(e){we(o.$$.fragment,e),n=!1},d(e){e&&k(s),Ce(o)}}}class Wl extends Te{constructor(e){super(),Pe(this,e,null,Yl,a,{})}}function Zl(t){let s,o,n=t[0].component,r=Xl(t);return{c(){r.c(),s=A()},m(e,t){r.m(e,t),L(e,s,t),o=!0},p(t,o){1&o&&a(n,n=t[0].component)?(ve(),we(r,1,1,e),ye(),r=Xl(t),r.c(),xe(r),r.m(s.parentNode,s)):r.p(t,o)},i(e){o||(xe(r),o=!0)},o(e){we(r),o=!1},d(e){e&&k(s),r.d(e)}}}function Xl(e){let t,o,n,r,i,a,l,c,u;const p=[e[0].props];var h=e[0].component;function d(e){let t={};for(let e=0;e<p.length;e+=1)t=s(t,p[e]);return{props:t}}return h&&(a=new h(d())),{c(){t=E("section"),o=E("div"),n=E("button"),n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="white" width="24" height="24" viewBox="0 0 24 24"><path d="M23.954 21.03l-9.184-9.095 9.092-9.174-2.832-2.807-9.09 9.179-9.176-9.088-2.81 2.81 9.186 9.105-9.095 9.184 2.81 2.81 9.112-9.192 9.18 9.1z"></path></svg>',r=M(),i=E("div"),a&&Me(a.$$.fragment),T(n,"class","svelte-1fughtn"),T(i,"class","content svelte-1fughtn"),T(o,"class","popup svelte-1fughtn"),T(t,"class","svelte-1fughtn")},m(s,p){L(s,t,p),_(t,o),_(o,n),_(o,r),_(o,i),a&&Ae(a,i,null),l=!0,c||(u=C(n,"click",e[1]),c=!0)},p(e,t){const s=1&t?Ee(p,[Ie(e[0].props)]):{};if(h!==(h=e[0].component)){if(a){ve();const e=a;we(e.$$.fragment,1,0,(()=>{Ce(e,1)})),ye()}h?(a=new h(d()),Me(a.$$.fragment),xe(a.$$.fragment,1),Ae(a,i,null)):a=null}else h&&a.$set(s)},i(e){l||(a&&xe(a.$$.fragment,e),l=!0)},o(e){a&&we(a.$$.fragment,e),l=!1},d(e){e&&k(t),a&&Ce(a),c=!1,u()}}}function Ql(e){let t,s,o=e[0]&&e[0].component&&Zl(e);return{c(){o&&o.c(),t=A()},m(e,n){o&&o.m(e,n),L(e,t,n),s=!0},p(e,[s]){e[0]&&e[0].component?o?(o.p(e,s),1&s&&xe(o,1)):(o=Zl(e),o.c(),xe(o,1),o.m(t.parentNode,t)):o&&(ve(),we(o,1,1,(()=>{o=null})),ye())},i(e){s||(xe(o),s=!0)},o(e){we(o),s=!1},d(e){o&&o.d(e),e&&k(t)}}}const ec=Ne(),tc=(e,t={})=>ec.set({component:e,props:t});function sc(e,t,s){let o;c(e,ec,(e=>s(0,o=e)));return[o,e=>tc(void 0)]}class oc extends Te{constructor(e){super(),Pe(this,e,sc,Ql,a,{})}}function nc(e){let t;return{c(){t=E("form"),t.innerHTML='<input type="hidden" name="hosted_button_id" value="N7CCZ2K5L2GV6"/> \n    <input type="image" src="https://www.paypalobjects.com/en_US/SE/i/btn/btn_donateCC_LG.gif" border="0" name="submit" title="PayPal - The safer, easier way to pay online!" alt="Donate with PayPal button"/> \n    <img alt="" border="0" src="https://www.paypal.com/en_SE/i/scr/pixel.gif" width="1" height="1"/>',T(t,"action","https://www.paypal.com/donate"),T(t,"method","post"),T(t,"target","_top")},m(e,s){L(e,t,s)},d(e){e&&k(t)}}}function rc(e){let t;return{c(){t=S("https://www.paypal.com/donate?hosted_button_id=N7CCZ2K5L2GV6")},m(e,s){L(e,t,s)},d(e){e&&k(t)}}}function ic(e){let t;return{c(){t=S("https://discord.gg/7mCVKnkjHc")},m(e,s){L(e,t,s)},d(e){e&&k(t)}}}function ac(e){let t,s,o,n,r,i,a,l,c,u,p,h,d,f,m,g,$,v,y,x,w,b,z,I,A,C,P,j,N;return d=new xl({props:{href:"https://www.paypal.com/donate?hosted_button_id=N7CCZ2K5L2GV6",$$slots:{default:[nc]},$$scope:{ctx:e}}}),g=new xl({props:{href:"https://www.paypal.com/donate?hosted_button_id=N7CCZ2K5L2GV6",$$slots:{default:[rc]},$$scope:{ctx:e}}}),j=new xl({props:{href:"https://discord.gg/7mCVKnkjHc",$$slots:{default:[ic]},$$scope:{ctx:e}}}),{c(){t=E("h2"),t.textContent="Hey!",s=M(),o=E("p"),o.textContent="Welcome to the online version of NESBit Studio. This application is a toolkit to help the development of homebrew NES games.",n=M(),r=E("p"),r.textContent="A lot of time and effort has already gone in to making this project, however it's still very much in an alpha stage. \r\n  At this time most of the work is being focused on the spritesheet editor. And until the application reaches a stable beta point this \r\n  project will continue to only live online.",i=M(),a=E("h4"),a.textContent="Breaking changes",l=M(),c=E("p"),c.textContent="Sometimes there are major changes which will break imports and project files. At the state it's currently in there is no major benefit to cater \r\n  to backwards compatability, from a developers standpoint. But since all source data is JSON encoded it should be a simple fix if you know what's changed internally. \r\n  If that happends, feel free to get in touch with me over discord and I'll do my best to help you out.",u=M(),p=E("h4"),p.textContent="Support this project",h=M(),Me(d.$$.fragment),f=M(),m=E("p"),Me(g.$$.fragment),$=M(),v=E("p"),y=E("img"),w=M(),b=E("h4"),b.textContent="Join discord",z=M(),I=E("p"),A=S("Join the discord server for project updates, help or show off what you have been working on."),C=E("br"),P=M(),Me(j.$$.fragment),y.src!==(x=Jt+"/assets/images/paypal-qr-code.png")&&T(y,"src",x),T(y,"alt","")},m(e,x){L(e,t,x),L(e,s,x),L(e,o,x),L(e,n,x),L(e,r,x),L(e,i,x),L(e,a,x),L(e,l,x),L(e,c,x),L(e,u,x),L(e,p,x),L(e,h,x),Ae(d,e,x),L(e,f,x),L(e,m,x),Ae(g,m,null),L(e,$,x),L(e,v,x),_(v,y),L(e,w,x),L(e,b,x),L(e,z,x),L(e,I,x),_(I,A),_(I,C),_(I,P),Ae(j,I,null),N=!0},p(e,[t]){const s={};1&t&&(s.$$scope={dirty:t,ctx:e}),d.$set(s);const o={};1&t&&(o.$$scope={dirty:t,ctx:e}),g.$set(o);const n={};1&t&&(n.$$scope={dirty:t,ctx:e}),j.$set(n)},i(e){N||(xe(d.$$.fragment,e),xe(g.$$.fragment,e),xe(j.$$.fragment,e),N=!0)},o(e){we(d.$$.fragment,e),we(g.$$.fragment,e),we(j.$$.fragment,e),N=!1},d(e){e&&k(t),e&&k(s),e&&k(o),e&&k(n),e&&k(r),e&&k(i),e&&k(a),e&&k(l),e&&k(c),e&&k(u),e&&k(p),e&&k(h),Ce(d,e),e&&k(f),e&&k(m),Ce(g),e&&k($),e&&k(v),e&&k(w),e&&k(b),e&&k(z),e&&k(I),Ce(j)}}}class lc extends Te{constructor(e){super(),Pe(this,e,null,ac,a,{})}}function cc(t){let s,o,n,r,i,a,l,c,u,p,h,d,f,m;return o=new ql({}),i=new Eo({}),l=new Wl({}),u=new Kt({}),h=new oc({}),f=new nt({}),{c(){s=E("div"),Me(o.$$.fragment),n=M(),r=E("main"),Me(i.$$.fragment),a=M(),Me(l.$$.fragment),c=M(),Me(u.$$.fragment),p=M(),Me(h.$$.fragment),d=M(),Me(f.$$.fragment),T(r,"class","svelte-4azgf7"),T(s,"id","app")},m(e,t){L(e,s,t),Ae(o,s,null),_(s,n),_(s,r),Ae(i,r,null),_(s,a),Ae(l,s,null),L(e,c,t),Ae(u,e,t),L(e,p,t),Ae(h,e,t),L(e,d,t),Ae(f,e,t),m=!0},p:e,i(e){m||(xe(o.$$.fragment,e),xe(i.$$.fragment,e),xe(l.$$.fragment,e),xe(u.$$.fragment,e),xe(h.$$.fragment,e),xe(f.$$.fragment,e),m=!0)},o(e){we(o.$$.fragment,e),we(i.$$.fragment,e),we(l.$$.fragment,e),we(u.$$.fragment,e),we(h.$$.fragment,e),we(f.$$.fragment,e),m=!1},d(e){e&&k(s),Ce(o),Ce(i),Ce(l),e&&k(c),Ce(u,e),e&&k(p),Ce(h,e),e&&k(d),Ce(f,e)}}}function uc(e){return globalThis.electron||Gt.isDev||tc(lc),[]}class pc extends Te{constructor(e){super(),Pe(this,e,uc,cc,a,{})}}const{document:hc}=_e;function dc(e){let t,o,n,r,i;hc.title=t="["+(e[0]||"not saved *")+"]";const a=[e[1]];let l={};for(let e=0;e<a.length;e+=1)l=s(l,a[e]);return r=new pc({props:l}),{c(){o=E("meta"),n=M(),Me(r.$$.fragment),T(o,"http-equiv","Content-Security-Policy"),T(o,"content","script-src 'self'")},m(e,t){_(hc.head,o),L(e,n,t),Ae(r,e,t),i=!0},p(e,[s]){(!i||1&s)&&t!==(t="["+(e[0]||"not saved *")+"]")&&(hc.title=t);const o=2&s?Ee(a,[Ie(e[1])]):{};r.$set(o)},i(e){i||(xe(r.$$.fragment,e),i=!0)},o(e){we(r.$$.fragment,e),i=!1},d(e){k(o),e&&k(n),Ce(r,e)}}}function fc(e,t,o){let n,r,i;return c(e,fo,(e=>o(3,r=e))),c(e,xs,(e=>o(2,i=e))),globalThis.electron&&(document.body.classList.add("electron"),ao("/")),Y((async()=>{await ie(),Gt.startPage!==r&&ao(Gt.startPage)})),e.$$set=e=>{o(1,t=s(s({},t),d(e)))},e.$$.update=()=>{4&e.$$.dirty&&o(0,n=xn(i.path||""))},t=d(t),[n,t,i]}function mc(t){let s;return{c(){s=E("section"),s.innerHTML='<article class="svelte-weu28o"><h3>This online version of NESBit Studio relies on ad-monetization to be able to continue to operate</h3> \n    <p>We know, we know. Intrusive ads sucks! We do our best to keep it out of your way and experience using this tool.</p></article>',T(s,"class","checkered svelte-weu28o")},m(e,t){L(e,s,t)},p:e,i:e,o:e,d(e){e&&k(s)}}}return new(window.not_adblocked?class extends Te{constructor(e){super(),Pe(this,e,fc,dc,a,{})}}:class extends Te{constructor(e){super(),Pe(this,e,null,mc,a,{})}})({target:document.querySelector("body")})}();
